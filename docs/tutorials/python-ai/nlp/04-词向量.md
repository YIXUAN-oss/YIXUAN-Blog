---
title: 词向量
---

# 词向量

> 掌握词向量表示和应用

## 📚 学习目标

- 理解词向量概念
- 掌握TF-IDF
- 学会Word2Vec
- 了解GloVe和FastText

## 1. 词袋模型

```python
from sklearn.feature_extraction.text import CountVectorizer

corpus = [
    '我 爱 自然语言处理',
    '深度学习 很 有趣',
    '自然语言处理 使用 深度学习'
]

vectorizer = CountVectorizer()
X = vectorizer.fit_transform(corpus)

print("词汇表:", vectorizer.get_feature_names_out())
print("向量:\n", X.toarray())
```

## 2. TF-IDF

```python
from sklearn.feature_extraction.text import TfidfVectorizer

tfidf = TfidfVectorizer()
X = tfidf.fit_transform(corpus)

print("TF-IDF:\n", X.toarray())

# 查看特征权重
feature_names = tfidf.get_feature_names_out()
for doc_idx, doc in enumerate(X.toarray()):
    print(f"\n文档 {doc_idx}:")
    for idx, score in enumerate(doc):
        if score > 0:
            print(f"  {feature_names[idx]}: {score:.4f}")
```

## 3. Word2Vec

```python
from gensim.models import Word2Vec
import jieba

# 准备数据
sentences = [
    list(jieba.cut("我爱自然语言处理")),
    list(jieba.cut("深度学习很有趣")),
    list(jieba.cut("机器学习是人工智能的分支"))
]

# 训练模型
model = Word2Vec(sentences, 
                 vector_size=100,  # 词向量维度
                 window=5,         # 上下文窗口
                 min_count=1,      # 最小词频
                 workers=4)        # 线程数

# 获取词向量
vector = model.wv['自然语言处理']
print("词向量:", vector[:10])

# 相似词
similar = model.wv.most_similar('深度学习', topn=5)
print("相似词:", similar)

# 词语相似度
similarity = model.wv.similarity('深度学习', '机器学习')
print("相似度:", similarity)

# 保存和加载
model.save('word2vec.model')
model = Word2Vec.load('word2vec.model')
```

## 4. 使用预训练词向量

```python
from gensim.models import KeyedVectors

# 加载预训练模型
# 下载: https://github.com/Embedding/Chinese-Word-Vectors
model = KeyedVectors.load_word2vec_format('sgns.wiki.word', binary=False)

# 使用
vector = model['中国']
similar = model.most_similar('中国', topn=10)
```

## 5. FastText

```python
from gensim.models import FastText

# 训练FastText
model = FastText(sentences, 
                 vector_size=100,
                 window=5,
                 min_count=1)

# 获取词向量（包括未登录词）
vector = model.wv['未登录词']
```

---

**下一节：** [文本分类](05-文本分类.md)
