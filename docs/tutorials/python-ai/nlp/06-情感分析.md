---
title: 情感分析
---

# 情感分析

> 掌握情感分析技术和应用

## 📚 学习目标

- 理解情感分析
- 掌握基于词典的方法
- 学会机器学习方法
- 了解深度学习方法

## 1. 基于词典的方法

```python
# 使用SnowNLP
from snownlp import SnowNLP

text = "这部电影真的太好看了！"
s = SnowNLP(text)
print(f"情感得分: {s.sentiments}")  # 0-1之间

# 自定义情感词典
positive_words = {'好', '棒', '优秀', '喜欢'}
negative_words = {'差', '烂', '讨厌', '失望'}

def sentiment_score(text):
    words = jieba.cut(text)
    pos_count = sum(1 for w in words if w in positive_words)
    neg_count = sum(1 for w in words if w in negative_words)
    
    if pos_count > neg_count:
        return 'positive'
    elif neg_count > pos_count:
        return 'negative'
    else:
        return 'neutral'
```

## 2. 机器学习方法

```python
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression

# 训练数据
train_texts = [
    "这个产品质量很好",
    "服务态度太差了",
    "性价比很高",
    "完全不值这个价格"
]
train_labels = [1, 0, 1, 0]  # 1-正面, 0-负面

# 特征提取
vectorizer = TfidfVectorizer()
X_train = vectorizer.fit_transform(train_texts)

# 训练模型
clf = LogisticRegression()
clf.fit(X_train, train_labels)

# 预测
test_text = "这个手机非常好用"
X_test = vectorizer.transform([test_text])
pred = clf.predict(X_test)
prob = clf.predict_proba(X_test)

print(f"预测: {'正面' if pred[0] == 1 else '负面'}")
print(f"概率: 负面={prob[0][0]:.2f}, 正面={prob[0][1]:.2f}")
```

## 3. 使用transformers

```python
from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch

# 加载预训练模型
model_name = "uer/roberta-base-finetuned-chinaNews-chinese"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForSequenceClassification.from_pretrained(model_name)

# 预测
text = "这个产品真的很不错"
inputs = tokenizer(text, return_tensors="pt", padding=True, truncation=True)
outputs = model(**inputs)
predictions = torch.nn.functional.softmax(outputs.logits, dim=-1)

print("情感预测:", predictions)
```

## 4. 实战：电商评论分析

```python
import pandas as pd
import matplotlib.pyplot as plt

# 加载评论数据
reviews = pd.read_csv('reviews.csv')

# 批量情感分析
reviews['sentiment'] = reviews['text'].apply(
    lambda x: SnowNLP(x).sentiments
)

# 分类
reviews['label'] = reviews['sentiment'].apply(
    lambda x: 'positive' if x > 0.6 else ('negative' if x < 0.4 else 'neutral')
)

# 统计
print(reviews['label'].value_counts())

# 可视化
reviews['label'].value_counts().plot(kind='bar')
plt.title('Sentiment Distribution')
plt.show()
```

---

**下一节：** [命名实体识别](07-命名实体识别.md)
