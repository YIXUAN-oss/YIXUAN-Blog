---
title: 数据重塑
---

# 数据重塑

> 掌握数据透视和重塑技巧

## 📚 学习目标

- 掌握pivot透视表
- 学会melt宽转长
- 理解stack和unstack
- 掌握交叉表

## 1. pivot透视

```python
import pandas as pd

df = pd.DataFrame({
    'date': ['2024-01', '2024-01', '2024-02', '2024-02'],
    'product': ['A', 'B', 'A', 'B'],
    'sales': [100, 150, 120, 180]
})

# 透视
pivoted = df.pivot(index='date', columns='product', values='sales')
print(pivoted)
```

## 2. pivot_table

```python
# 透视表with聚合
result = df.pivot_table(
    values='sales',
    index='date',
    columns='product',
    aggfunc='sum'
)
```

## 3. melt宽转长

```python
df = pd.DataFrame({
    'id': [1, 2],
    'A': [10, 20],
    'B': [30, 40]
})

# 宽转长
melted = df.melt(id_vars=['id'], var_name='variable', value_name='value')
print(melted)
```

## 4. stack和unstack

```python
df = pd.DataFrame({
    'A': [1, 2],
    'B': [3, 4]
}, index=['X', 'Y'])

# stack - 列转行
stacked = df.stack()

# unstack - 行转列
unstacked = stacked.unstack()
```

---

**下一节：** [时间序列](08-时间序列.md)
