---
title: 数据合并
---

# 数据合并

> 掌握Pandas的数据合并技巧

## 📚 学习目标

- 掌握concat连接
- 理解merge合并
- 学会使用join
- 掌握数据追加

## 1. concat连接

```python
import pandas as pd

df1 = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
df2 = pd.DataFrame({'A': [5, 6], 'B': [7, 8]})

# 垂直连接
result = pd.concat([df1, df2])

# 水平连接
result = pd.concat([df1, df2], axis=1)

# 忽略索引
result = pd.concat([df1, df2], ignore_index=True)

# 添加分层索引
result = pd.concat([df1, df2], keys=['group1', 'group2'])
```

## 2. merge合并

```python
left = pd.DataFrame({
    'key': ['A', 'B', 'C'],
    'value': [1, 2, 3]
})

right = pd.DataFrame({
    'key': ['A', 'B', 'D'],
    'value': [4, 5, 6]
})

# 内连接
result = pd.merge(left, right, on='key', how='inner')

# 左连接
result = pd.merge(left, right, on='key', how='left')

# 右连接
result = pd.merge(left, right, on='key', how='right')

# 外连接
result = pd.merge(left, right, on='key', how='outer')

# 多键合并
result = pd.merge(left, right, on=['key1', 'key2'])
```

## 3. join连接

```python
df1 = pd.DataFrame({'A': [1, 2]}, index=['a', 'b'])
df2 = pd.DataFrame({'B': [3, 4]}, index=['a', 'b'])

# 基于索引连接
result = df1.join(df2)

# 指定连接方式
result = df1.join(df2, how='outer')
```

## 练习题

1. 合并学生信息和成绩表
2. 连接多个月份的销售数据

---

**下一节：** [数据重塑](07-数据重塑.md)
