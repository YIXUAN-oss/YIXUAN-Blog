---
title: 实战案例
---

# 实战案例

> 通过实战项目掌握Matplotlib

## 📚 学习目标

- 应用Matplotlib解决实际问题
- 掌握完整可视化流程
- 学会综合运用所学知识

## 1. 销售数据分析仪表盘

```python
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

# 生成模拟数据
np.random.seed(42)
dates = pd.date_range('2024-01-01', periods=12, freq='M')
sales = np.random.randint(100, 200, 12)
profit = sales * np.random.uniform(0.15, 0.25, 12)
customers = np.random.randint(500, 1000, 12)

# 创建仪表盘
fig = plt.figure(figsize=(15, 10))
gs = fig.add_gridspec(3, 3, hspace=0.3, wspace=0.3)

# 1. 销售趋势
ax1 = fig.add_subplot(gs[0, :])
ax1.plot(dates, sales, marker='o', linewidth=2, label='Sales')
ax1.fill_between(dates, sales, alpha=0.3)
ax1.set_title('Monthly Sales Trend', fontsize=14, fontweight='bold')
ax1.set_ylabel('Sales (K)')
ax1.grid(True, alpha=0.3)
ax1.legend()

# 2. 利润分析
ax2 = fig.add_subplot(gs[1, :2])
ax2.bar(dates, profit, color='green', alpha=0.7)
ax2.set_title('Monthly Profit', fontsize=14, fontweight='bold')
ax2.set_ylabel('Profit (K)')
ax2.grid(axis='y', alpha=0.3)

# 3. 销售额分布
ax3 = fig.add_subplot(gs[1, 2])
ax3.pie([sales.sum(), profit.sum()], 
        labels=['Revenue', 'Profit'],
        autopct='%1.1f%%',
        colors=['skyblue', 'lightgreen'])
ax3.set_title('Revenue vs Profit')

# 4. 客户增长
ax4 = fig.add_subplot(gs[2, :])
ax4.plot(dates, customers, marker='s', color='orange', linewidth=2)
ax4.set_title('Customer Growth', fontsize=14, fontweight='bold')
ax4.set_ylabel('Customers')
ax4.set_xlabel('Month')
ax4.grid(True, alpha=0.3)

plt.suptitle('Sales Dashboard 2024', fontsize=18, fontweight='bold', y=0.98)
plt.savefig('sales_dashboard.png', dpi=300, bbox_inches='tight')
plt.show()
```

## 2. 科学数据可视化

```python
# 双变量分布分析
x = np.random.randn(1000)
y = 2 * x + np.random.randn(1000)

fig, axes = plt.subplots(2, 2, figsize=(12, 10))

# 散点图
axes[0, 0].scatter(x, y, alpha=0.5)
axes[0, 0].set_title('Scatter Plot')
axes[0, 0].set_xlabel('X')
axes[0, 0].set_ylabel('Y')
axes[0, 0].grid(True, alpha=0.3)

# X分布
axes[0, 1].hist(x, bins=30, color='blue', alpha=0.7, edgecolor='black')
axes[0, 1].set_title('X Distribution')
axes[0, 1].set_xlabel('X')
axes[0, 1].set_ylabel('Frequency')

# Y分布
axes[1, 0].hist(y, bins=30, color='red', alpha=0.7, 
                edgecolor='black', orientation='horizontal')
axes[1, 0].set_title('Y Distribution')
axes[1, 0].set_ylabel('Y')
axes[1, 0].set_xlabel('Frequency')

# 2D密度图
from scipy.stats import gaussian_kde
xy = np.vstack([x, y])
z = gaussian_kde(xy)(xy)
axes[1, 1].scatter(x, y, c=z, s=20, cmap='viridis')
axes[1, 1].set_title('2D Density Plot')
axes[1, 1].set_xlabel('X')
axes[1, 1].set_ylabel('Y')

plt.tight_layout()
plt.show()
```

## 3. 金融K线图

```python
# 模拟股票数据
dates = pd.date_range('2024-01-01', periods=100)
open_price = 100 + np.cumsum(np.random.randn(100) * 2)
close_price = open_price + np.random.randn(100) * 3
high_price = np.maximum(open_price, close_price) + np.abs(np.random.randn(100))
low_price = np.minimum(open_price, close_price) - np.abs(np.random.randn(100))
volume = np.random.randint(1000, 5000, 100)

fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(15, 10), 
                                gridspec_kw={'height_ratios': [3, 1]})

# K线图
colors = ['red' if c < o else 'green' for c, o in zip(close_price, open_price)]
for i in range(len(dates)):
    # 影线
    ax1.plot([i, i], [low_price[i], high_price[i]], color='black', linewidth=1)
    # K线实体
    height = abs(close_price[i] - open_price[i])
    bottom = min(open_price[i], close_price[i])
    ax1.bar(i, height, bottom=bottom, color=colors[i], width=0.6, alpha=0.8)

# 移动平均线
ma5 = pd.Series(close_price).rolling(5).mean()
ma20 = pd.Series(close_price).rolling(20).mean()
ax1.plot(range(len(dates)), ma5, label='MA5', linewidth=2)
ax1.plot(range(len(dates)), ma20, label='MA20', linewidth=2)

ax1.set_title('Stock Price', fontsize=14, fontweight='bold')
ax1.set_ylabel('Price')
ax1.legend()
ax1.grid(True, alpha=0.3)

# 成交量
ax2.bar(range(len(dates)), volume, color=colors, alpha=0.7)
ax2.set_title('Volume', fontsize=12)
ax2.set_ylabel('Volume')
ax2.set_xlabel('Days')
ax2.grid(axis='y', alpha=0.3)

plt.tight_layout()
plt.show()
```

## 4. 多维数据可视化

```python
# 综合分析图表
np.random.seed(42)
n = 200

# 生成数据
categories = np.random.choice(['A', 'B', 'C', 'D'], n)
x = np.random.randn(n)
y = np.random.randn(n)
sizes = np.random.rand(n) * 1000

fig = plt.figure(figsize=(15, 12))

# 1. 散点图矩阵
for i in range(3):
    for j in range(3):
        ax = plt.subplot(3, 3, i*3+j+1)
        if i == j:
            # 对角线画直方图
            data = x if i == 0 else (y if i == 1 else sizes)
            ax.hist(data, bins=20, color='skyblue', edgecolor='black')
        else:
            # 非对角线画散点图
            x_data = x if j == 0 else (y if j == 1 else sizes)
            y_data = x if i == 0 else (y if i == 1 else sizes)
            ax.scatter(x_data, y_data, alpha=0.5)
        
        if i == 2:
            ax.set_xlabel(['X', 'Y', 'Size'][j])
        if j == 0:
            ax.set_ylabel(['X', 'Y', 'Size'][i])

plt.suptitle('Scatter Matrix', fontsize=16, fontweight='bold')
plt.tight_layout()
plt.show()
```

## 5. 时间序列预测可视化

```python
# 生成时间序列数据
dates = pd.date_range('2023-01-01', periods=365)
trend = np.linspace(100, 150, 365)
seasonal = 10 * np.sin(np.linspace(0, 4*np.pi, 365))
noise = np.random.randn(365) * 5
data = trend + seasonal + noise

# 分割训练和测试集
train_size = int(len(data) * 0.8)
train_dates = dates[:train_size]
test_dates = dates[train_size:]
train_data = data[:train_size]
test_data = data[train_size:]

# 简单预测（移动平均）
prediction = pd.Series(train_data).rolling(30).mean().iloc[-1]
predicted_data = np.full(len(test_data), prediction)

# 可视化
fig, axes = plt.subplots(2, 1, figsize=(15, 10))

# 完整数据
axes[0].plot(dates, data, label='Actual', linewidth=2)
axes[0].axvline(dates[train_size], color='red', linestyle='--', 
                linewidth=2, label='Train/Test Split')
axes[0].set_title('Time Series Data', fontsize=14, fontweight='bold')
axes[0].set_ylabel('Value')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# 预测对比
axes[1].plot(train_dates, train_data, label='Training Data', linewidth=2)
axes[1].plot(test_dates, test_data, label='Actual Test Data', linewidth=2)
axes[1].plot(test_dates, predicted_data, 'r--', label='Prediction', linewidth=2)
axes[1].fill_between(test_dates, 
                     predicted_data - 10, 
                     predicted_data + 10, 
                     alpha=0.3, label='Confidence Interval')
axes[1].set_title('Prediction vs Actual', fontsize=14, fontweight='bold')
axes[1].set_xlabel('Date')
axes[1].set_ylabel('Value')
axes[1].legend()
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

## 💡 总结

通过这些实战案例，你应该掌握了：

1. **综合布局** - 使用GridSpec创建复杂布局
2. **多图表组合** - 将不同类型图表组合展示
3. **样式美化** - 使用颜色、字体、网格等美化图表
4. **数据storytelling** - 通过可视化讲述数据故事
5. **专业图表** - 创建接近商业级别的可视化

## 练习项目

1. 创建一个个人财务分析仪表盘
2. 制作一个COVID-19数据追踪图表
3. 设计一个机器学习模型性能对比图
4. 开发一个实时数据监控面板

---

**恭喜完成 Matplotlib 教程！** 🎉

继续学习：[Seaborn 统计可视化](../seaborn/) 或 [Plotly 交互式可视化](../plotly/)
