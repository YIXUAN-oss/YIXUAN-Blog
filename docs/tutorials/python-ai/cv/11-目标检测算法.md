---
title: 目标检测算法
---

# 目标检测算法

> 掌握深度学习目标检测算法

## 📚 学习目标

- 理解YOLO算法
- 学会使用YOLOv5
- 了解其他检测算法
- 掌握模型部署

## 1. YOLOv5 使用

```python
import torch

# 加载模型
model = torch.hub.load('ultralytics/yolov5', 'yolov5s', pretrained=True)

# 推理
img = 'image.jpg'
results = model(img)

# 显示结果
results.show()

# 打印结果
results.print()

# 保存结果
results.save()
```

## 2. 实时检测

```python
import cv2

# 加载模型
model = torch.hub.load('ultralytics/yolov5', 'yolov5s')

# 打开摄像头
cap = cv2.VideoCapture(0)

while True:
    ret, frame = cap.read()
    if not ret:
        break
    
    # 检测
    results = model(frame)
    
    # 渲染结果
    rendered = results.render()[0]
    
    # 显示
    cv2.imshow('YOLOv5', rendered)
    
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
```

## 3. 自定义训练

```python
# 准备数据集（YOLO格式）
# data.yaml 配置文件

# 训练
!python train.py --img 640 --batch 16 --epochs 50 \
                 --data data.yaml --weights yolov5s.pt

# 验证
!python val.py --weights runs/train/exp/weights/best.pt \
               --data data.yaml

# 推理
!python detect.py --weights runs/train/exp/weights/best.pt \
                  --source test.jpg
```

## 4. 其他算法

```python
# Faster R-CNN
import torchvision
model = torchvision.models.detection.fasterrcnn_resnet50_fpn(pretrained=True)

# RetinaNet
model = torchvision.models.detection.retinanet_resnet50_fpn(pretrained=True)

# 使用
model.eval()
with torch.no_grad():
    predictions = model(images)
```

---

**下一节：** [实战案例](12-实战案例.md)
