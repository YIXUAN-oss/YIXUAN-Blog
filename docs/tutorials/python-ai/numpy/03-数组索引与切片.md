---
title: 数组索引与切片
---

# 数组索引与切片

> 掌握NumPy数组的索引和切片操作

## 📚 学习目标

- 掌握一维和多维数组索引
- 理解切片操作
- 掌握布尔索引
- 学会使用花式索引

## 1. 一维数组索引

###1.1 基本索引

```python
import numpy as np

arr = np.array([10, 20, 30, 40, 50])

# 正向索引
print(arr[0])   # 10
print(arr[2])   # 30

# 负向索引
print(arr[-1])  # 50
print(arr[-2])  # 40

# 修改元素
arr[0] = 100
print(arr)  # [100  20  30  40  50]
```

## 2. 一维数组切片

```python
arr = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])

# 基本切片 [start:stop:step]
print(arr[2:7])     # [2 3 4 5 6]
print(arr[:5])      # [0 1 2 3 4]
print(arr[5:])      # [5 6 7 8 9]
print(arr[::2])     # [0 2 4 6 8]
print(arr[::-1])    # [9 8 7 6 5 4 3 2 1 0]

# 切片赋值
arr[2:5] = [20, 30, 40]
print(arr)

# 切片是视图
slice_arr = arr[2:5]
slice_arr[0] = 999
print(arr)  # 原数组也被修改
```

## 3. 多维数组索引

```python
arr_2d = np.array([[1, 2, 3],
                   [4, 5, 6],
                   [7, 8, 9]])

# 索引单个元素
print(arr_2d[0, 0])  # 1
print(arr_2d[1, 2])  # 6
print(arr_2d[-1, -1])  # 9

# 索引一行
print(arr_2d[0])  # [1 2 3]
print(arr_2d[1])  # [4 5 6]

# 索引一列
print(arr_2d[:, 0])  # [1 4 7]
print(arr_2d[:, 1])  # [2 5 8]
```

## 4. 多维数组切片

```python
arr = np.array([[1, 2, 3, 4],
                [5, 6, 7, 8],
                [9, 10, 11, 12]])

# 切片行
print(arr[0:2])  # 前两行

# 切片列
print(arr[:, 1:3])  # 所有行的第2-3列

# 同时切片行和列
print(arr[0:2, 1:3])
# [[2 3]
#  [6 7]]

# 步长切片
print(arr[::2, ::2])  # 隔行隔列取
```

## 5. 布尔索引

```python
arr = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])

# 创建布尔掩码
mask = arr > 5
print(mask)  # [False False False False False  True  True  True  True  True]

# 使用布尔索引
result = arr[mask]
print(result)  # [ 6  7  8  9 10]

# 简化写法
result = arr[arr > 5]
print(result)

# 多条件
result = arr[(arr > 3) & (arr < 8)]
print(result)  # [4 5 6 7]

# 布尔索引赋值
arr[arr > 5] = 0
print(arr)  # [1 2 3 4 5 0 0 0 0 0]
```

## 6. 花式索引

```python
arr = np.array([10, 20, 30, 40, 50, 60])

# 使用整数数组索引
indices = [0, 2, 4]
print(arr[indices])  # [10 30 50]

# 使用整数列表索引
print(arr[[1, 3, 5]])  # [20 40 60]

# 二维数组花式索引
arr_2d = np.array([[1, 2, 3],
                   [4, 5, 6],
                   [7, 8, 9]])

rows = [0, 2]
cols = [1, 2]
print(arr_2d[rows, cols])  # [2 9]

# 花式索引返回副本
fancy_arr = arr[[0, 1, 2]]
fancy_arr[0] = 999
print(arr)  # 原数组不变
```

## 7. 高级索引技巧

### 7.1 ix_函数

```python
arr = np.arange(1, 13).reshape(3, 4)
print(arr)

# 同时索引多行多列
rows = [0, 2]
cols = [1, 3]
result = arr[np.ix_(rows, cols)]
print(result)
```

### 7.2 where函数

```python
arr = np.array([1, 2, 3, 4, 5])

# 返回满足条件的索引
indices = np.where(arr > 3)
print(indices)  # (array([3, 4]),)
print(arr[indices])  # [4 5]

# 条件替换
result = np.where(arr > 3, arr, 0)
print(result)  # [0 0 0 4 5]

# 三元运算
result = np.where(arr > 3, 'big', 'small')
print(result)
```

## 8. 实战示例

### 示例1：数据筛选

```python
# 成绩数据
scores = np.array([85, 92, 78, 95, 88, 76, 90, 82])

# 筛选优秀成绩（>= 90）
excellent = scores[scores >= 90]
print(f'优秀成绩: {excellent}')

# 统计各分数段
print(f'90分以上: {np.sum(scores >= 90)}人')
print(f'80-90分: {np.sum((scores >= 80) & (scores < 90))}人')
print(f'80分以下: {np.sum(scores < 80)}人')
```

### 示例2：图像处理

```python
# 模拟灰度图像
image = np.random.randint(0, 256, (10, 10))

# 二值化处理
binary = image > 128
print(f'亮像素比例: {np.mean(binary):.2%}')

# 裁剪图像
cropped = image[2:8, 2:8]
print(f'裁剪后形状: {cropped.shape}')
```

## 9. 练习题

1. 创建一个数组，提取所有偶数
2. 从二维数组中提取对角线元素
3. 将数组中大于均值的元素替换为均值
4. 使用花式索引重新排列数组元素

---

**下一节：** [数组运算](04-数组运算.md)
