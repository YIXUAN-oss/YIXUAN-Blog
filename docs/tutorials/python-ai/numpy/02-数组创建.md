---
title: 数组创建
---

# 数组创建

> 掌握多种创建NumPy数组的方法

## 📚 学习目标

- 掌握从Python对象创建数组
- 学会使用内置函数创建数组
- 掌握创建特殊数组的方法
- 学会生成随机数组

## 1. 从Python对象创建

### 1.1 从列表创建

```python
import numpy as np

# 一维数组
arr_1d = np.array([1, 2, 3, 4, 5])
print(arr_1d)  # [1 2 3 4 5]

# 二维数组
arr_2d = np.array([[1, 2, 3], [4, 5, 6]])
print(arr_2d)
# [[1 2 3]
#  [4 5 6]]

# 三维数组
arr_3d = np.array([[[1, 2], [3, 4]], [[5, 6], [7, 8]]])
print(arr_3d.shape)  # (2, 2, 2)
```

### 1.2 从元组创建

```python
# 元组也可以创建数组
arr = np.array((1, 2, 3, 4, 5))
print(arr)  # [1 2 3 4 5]

# 嵌套元组
arr_2d = np.array(((1, 2, 3), (4, 5, 6)))
print(arr_2d)
```

### 1.3 指定数据类型

```python
# 创建浮点数数组
arr_float = np.array([1, 2, 3], dtype=float)
print(arr_float)  # [1. 2. 3.]

# 创建复数数组
arr_complex = np.array([1, 2, 3], dtype=complex)
print(arr_complex)  # [1.+0.j 2.+0.j 3.+0.j]

# 创建字符串数组
arr_str = np.array([1, 2, 3], dtype=str)
print(arr_str)  # ['1' '2' '3']
```

## 2. 使用内置函数创建

### 2.1 zeros - 全零数组

```python
# 一维全零数组
zeros_1d = np.zeros(5)
print(zeros_1d)  # [0. 0. 0. 0. 0.]

# 二维全零数组
zeros_2d = np.zeros((3, 4))
print(zeros_2d)

# 指定数据类型
zeros_int = np.zeros((2, 3), dtype=int)
print(zeros_int)
```

### 2.2 ones - 全一数组

```python
# 一维全一数组
ones_1d = np.ones(5)
print(ones_1d)  # [1. 1. 1. 1. 1.]

# 二维全一数组
ones_2d = np.ones((2, 3))
print(ones_2d)

# 指定数据类型
ones_int = np.ones((3, 3), dtype=int)
print(ones_int)
```

### 2.3 full - 指定值数组

```python
# 创建所有元素为指定值的数组
full_arr = np.full((3, 3), 7)
print(full_arr)
# [[7 7 7]
#  [7 7 7]
#  [7 7 7]]

# 使用浮点数
full_float = np.full((2, 4), 3.14)
print(full_float)
```

### 2.4 empty - 空数组

```python
# 创建未初始化的数组（值是随机的）
empty_arr = np.empty((2, 3))
print(empty_arr)  # 随机值

# 注意：empty 不会初始化为0，速度快但值不确定
```

### 2.5 eye / identity - 单位矩阵

```python
# 单位矩阵
identity_3x3 = np.eye(3)
print(identity_3x3)
# [[1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]]

# 指定对角线偏移
eye_offset = np.eye(4, k=1)
print(eye_offset)

# identity 函数
identity_mat = np.identity(3)
print(identity_mat)
```

## 3. 等差数组

### 3.1 arange - 类似 range

```python
# 基本用法
arr = np.arange(10)
print(arr)  # [0 1 2 3 4 5 6 7 8 9]

# 指定起始和结束
arr = np.arange(5, 15)
print(arr)  # [ 5  6  7  8  9 10 11 12 13 14]

# 指定步长
arr = np.arange(0, 10, 2)
print(arr)  # [0 2 4 6 8]

# 浮点数步长
arr = np.arange(0, 1, 0.1)
print(arr)  # [0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9]

# 递减序列
arr = np.arange(10, 0, -1)
print(arr)  # [10  9  8  7  6  5  4  3  2  1]
```

### 3.2 linspace - 线性空间

```python
# 在0到10之间生成5个等间距的数
arr = np.linspace(0, 10, 5)
print(arr)  # [ 0.   2.5  5.   7.5 10. ]

# 在0到1之间生成11个点
arr = np.linspace(0, 1, 11)
print(arr)  # [0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1. ]

# 不包含结束点
arr = np.linspace(0, 10, 5, endpoint=False)
print(arr)  # [0. 2. 4. 6. 8.]

# 返回步长
arr, step = np.linspace(0, 10, 5, retstep=True)
print(f'数组: {arr}')
print(f'步长: {step}')
```

### 3.3 logspace - 对数空间

```python
# 10^0 到 10^3，生成4个数
arr = np.logspace(0, 3, 4)
print(arr)  # [   1.   10.  100. 1000.]

# 10^-1 到 10^1，生成5个数
arr = np.logspace(-1, 1, 5)
print(arr)  # [ 0.1   0.31622777  1.  3.16227766 10. ]

# 以2为底
arr = np.logspace(0, 10, 11, base=2)
print(arr)  # [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024]
```

## 4. 随机数组

### 4.1 基本随机函数

```python
# 0到1之间的随机数
rand_arr = np.random.rand(3, 4)
print(rand_arr)

# 标准正态分布
randn_arr = np.random.randn(3, 3)
print(randn_arr)

# 指定范围的随机整数
randint_arr = np.random.randint(0, 10, size=(3, 3))
print(randint_arr)

# 0到1之间的随机数（另一种方式）
random_arr = np.random.random((2, 3))
print(random_arr)
```

### 4.2 不同分布的随机数

```python
# 均匀分布
uniform_arr = np.random.uniform(0, 10, size=(3, 3))
print('均匀分布:', uniform_arr)

# 正态分布（指定均值和标准差）
normal_arr = np.random.normal(loc=0, scale=1, size=(3, 3))
print('正态分布:', normal_arr)

# 泊松分布
poisson_arr = np.random.poisson(lam=3, size=(3, 3))
print('泊松分布:', poisson_arr)

# 二项分布
binomial_arr = np.random.binomial(n=10, p=0.5, size=(3, 3))
print('二项分布:', binomial_arr)
```

### 4.3 设置随机种子

```python
# 设置随机种子保证结果可重复
np.random.seed(42)
arr1 = np.random.rand(3)
print(arr1)

np.random.seed(42)
arr2 = np.random.rand(3)
print(arr2)

# arr1 和 arr2 完全相同

# 新版本推荐使用 Generator
rng = np.random.default_rng(42)
arr3 = rng.random(3)
print(arr3)
```

### 4.4 随机打乱和采样

```python
# 打乱数组
arr = np.arange(10)
np.random.shuffle(arr)
print('打乱后:', arr)

# 随机选择（不放回）
arr = np.arange(10)
sample = np.random.choice(arr, size=5, replace=False)
print('随机采样:', sample)

# 随机选择（放回）
sample_with_replace = np.random.choice(arr, size=5, replace=True)
print('放回采样:', sample_with_replace)

# 带权重的随机选择
elements = ['A', 'B', 'C', 'D']
probabilities = [0.1, 0.2, 0.3, 0.4]
sample = np.random.choice(elements, size=10, p=probabilities)
print('带权重采样:', sample)
```

## 5. 从已有数组创建

### 5.1 zeros_like / ones_like

```python
# 创建与给定数组相同形状的数组
arr = np.array([[1, 2, 3], [4, 5, 6]])

zeros_like_arr = np.zeros_like(arr)
print(zeros_like_arr)

ones_like_arr = np.ones_like(arr)
print(ones_like_arr)

full_like_arr = np.full_like(arr, 10)
print(full_like_arr)
```

### 5.2 copy - 复制数组

```python
# 创建数组的副本
original = np.array([1, 2, 3, 4, 5])
copied = original.copy()

# 修改副本不影响原数组
copied[0] = 100
print('原数组:', original)  # [1 2 3 4 5]
print('副本:', copied)      # [100 2 3 4 5]
```

## 6. 特殊数组

### 6.1 对角矩阵

```python
# 从一维数组创建对角矩阵
diag_arr = np.diag([1, 2, 3, 4])
print(diag_arr)
# [[1 0 0 0]
#  [0 2 0 0]
#  [0 0 3 0]
#  [0 0 0 4]]

# 从二维数组提取对角线
matrix = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
diagonal = np.diag(matrix)
print(diagonal)  # [1 5 9]
```

### 6.2 meshgrid - 网格数组

```python
# 创建坐标网格
x = np.array([1, 2, 3])
y = np.array([4, 5])

xx, yy = np.meshgrid(x, y)
print('X网格:\n', xx)
print('Y网格:\n', yy)
# X网格:
# [[1 2 3]
#  [1 2 3]]
# Y网格:
# [[4 4 4]
#  [5 5 5]]
```

## 7. 实战示例

### 示例1：生成测试数据

```python
# 生成100个0到1之间的随机数
data = np.random.rand(100)

# 生成符合正态分布的成绩数据
scores = np.random.normal(loc=75, scale=10, size=1000)
scores = np.clip(scores, 0, 100)  # 限制在0-100之间

print(f'平均分: {scores.mean():.2f}')
print(f'标准差: {scores.std():.2f}')
```

### 示例2：创建时间序列

```python
# 创建日期范围（配合pandas使用）
dates = np.arange('2024-01', '2024-12', dtype='datetime64[M]')
print(dates)

# 创建等间距的时间点
time_points = np.linspace(0, 10, 100)  # 0到10秒，100个时间点
values = np.sin(time_points)  # 生成正弦波
```

### 示例3：初始化神经网络权重

```python
# 使用He初始化
def he_initialization(fan_in, fan_out):
    std = np.sqrt(2.0 / fan_in)
    weights = np.random.randn(fan_in, fan_out) * std
    return weights

# 创建神经网络权重
weights = he_initialization(784, 128)
print(f'权重形状: {weights.shape}')
print(f'权重均值: {weights.mean():.6f}')
print(f'权重标准差: {weights.std():.6f}')
```

## 8. 性能对比

```python
import time

# 比较不同创建方法的性能
size = (1000, 1000)

# zeros
start = time.time()
arr = np.zeros(size)
print(f'zeros: {time.time() - start:.6f}秒')

# empty
start = time.time()
arr = np.empty(size)
print(f'empty: {time.time() - start:.6f}秒')

# empty 比 zeros 快（但值不确定）
```

## 9. 练习题

1. 创建一个5x5的单位矩阵
2. 创建一个包含0到100的偶数数组
3. 生成100个均值为50，标准差为10的随机数
4. 创建一个3x3矩阵，对角线为1，2，3，其余为0
5. 生成10个0到1之间的随机数，并将它们排序

## 💡 重点总结

- `np.array()` - 从Python对象创建数组
- `np.zeros()` / `np.ones()` - 创建特殊值数组
- `np.arange()` / `np.linspace()` - 创建等差数组
- `np.random` - 生成随机数组
- 合理选择创建方法可以提高性能

---

**下一节：** [数组索引与切片](03-数组索引与切片.md)
