---
title: 迭代器与生成器
---

# 迭代器与生成器

> 理解Python迭代器和生成器的核心概念，掌握高效的数据处理方式

## 📚 学习目标

- 理解迭代器和可迭代对象的概念
- 掌握生成器的使用
- 学会使用 yield 关键字
- 掌握生成器表达式

## 1. 迭代器基础

### 1.1 可迭代对象与迭代器

```python
# 可迭代对象：可以使用 for 循环遍历
my_list = [1, 2, 3, 4, 5]

# 获取迭代器
iterator = iter(my_list)

# 使用 next() 获取元素
print(next(iterator))  # 1
print(next(iterator))  # 2
```

### 1.2 自定义迭代器

```python
class CountDown:
    """倒计时迭代器"""
    
    def __init__(self, start):
        self.current = start
    
    def __iter__(self):
        return self
    
    def __next__(self):
        if self.current <= 0:
            raise StopIteration
        self.current -= 1
        return self.current + 1

# 使用
countdown = CountDown(5)
for num in countdown:
    print(num)  # 5, 4, 3, 2, 1
```

## 2. 生成器

### 2.1 生成器函数

```python
def fibonacci(n):
    """斐波那契数列生成器"""
    a, b = 0, 1
    count = 0
    while count < n:
        yield b
        a, b = b, a + b
        count += 1

# 使用
for num in fibonacci(10):
    print(num, end=' ')
```

### 2.2 生成器表达式

```python
# 列表推导式
squares_list = [x**2 for x in range(10)]

# 生成器表达式（节省内存）
squares_gen = (x**2 for x in range(10))
print(list(squares_gen))
```

### 2.3 实用示例

```python
# 读取大文件
def read_large_file(file_path):
    with open(file_path, 'r', encoding='utf-8') as f:
        for line in f:
            yield line.strip()

# 过滤数据
def filter_data(data, condition):
    for item in data:
        if condition(item):
            yield item
```

## 3. yield 关键字

### 3.1 基本用法

```python
def simple_generator():
    print('开始')
    yield 1
    print('继续')
    yield 2
    print('结束')
    yield 3

gen = simple_generator()
print(next(gen))  # 开始 \n 1
print(next(gen))  # 继续 \n 2
```

### 3.2 send() 方法

```python
def counter():
    count = 0
    while True:
        val = yield count
        if val is not None:
            count = val
        else:
            count += 1

c = counter()
print(next(c))  # 0
print(c.send(10))  # 10
print(next(c))  # 11
```

## 4. itertools 模块

```python
import itertools

# 无限迭代器
counter = itertools.count(10, 2)  # 10, 12, 14...

# 循环迭代
colors = itertools.cycle(['红', '绿', '蓝'])

# 连接迭代器
result = itertools.chain([1, 2], ['a', 'b'])
print(list(result))  # [1, 2, 'a', 'b']

# 排列组合
print(list(itertools.permutations([1, 2, 3], 2)))
print(list(itertools.combinations([1, 2, 3], 2)))
```

## 📝 练习题

1. 创建一个素数生成器
2. 实现一个批量数据处理生成器
3. 编写文件内容过滤器

---

**下一节：** [装饰器](03-装饰器.md)
