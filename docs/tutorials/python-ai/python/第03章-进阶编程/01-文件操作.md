---
title: æ–‡ä»¶æ“ä½œ
---

# æ–‡ä»¶æ“ä½œ

> æŒæ¡Pythonæ–‡ä»¶çš„è¯»å†™æ“ä½œï¼Œå¤„ç†æ–‡æœ¬å’ŒäºŒè¿›åˆ¶æ–‡ä»¶

## ğŸ“š å­¦ä¹ ç›®æ ‡

- ç†è§£æ–‡ä»¶æ“ä½œçš„åŸºæœ¬æ¦‚å¿µ
- æŒæ¡æ–‡ä»¶çš„æ‰“å¼€ã€è¯»å–å’Œå†™å…¥
- å­¦ä¼šä½¿ç”¨withè¯­å¥ç®¡ç†æ–‡ä»¶
- æŒæ¡æ–‡ä»¶è·¯å¾„æ“ä½œ
- å­¦ä¹ å¤„ç†ä¸åŒæ ¼å¼çš„æ–‡ä»¶

## 1. æ–‡ä»¶çš„åŸºæœ¬æ“ä½œ

### 1.1 æ‰“å¼€æ–‡ä»¶

```python
# åŸºæœ¬è¯­æ³•
file = open('filename', 'mode', encoding='utf-8')

# å¸¸ç”¨æ¨¡å¼
# 'r'  - åªè¯»ï¼ˆé»˜è®¤ï¼‰
# 'w'  - å†™å…¥ï¼ˆä¼šè¦†ç›–åŸæ–‡ä»¶ï¼‰
# 'a'  - è¿½åŠ 
# 'r+' - è¯»å†™
# 'b'  - äºŒè¿›åˆ¶æ¨¡å¼
# 't'  - æ–‡æœ¬æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

# ç¤ºä¾‹
file = open('test.txt', 'r', encoding='utf-8')
print(file.read())
file.close()
```

### 1.2 å…³é—­æ–‡ä»¶

```python
# æ–¹å¼1ï¼šæ‰‹åŠ¨å…³é—­
file = open('test.txt', 'r')
content = file.read()
file.close()  # å¿…é¡»å…³é—­ï¼

# æ–¹å¼2ï¼šä½¿ç”¨ with è¯­å¥ï¼ˆæ¨èï¼‰
with open('test.txt', 'r', encoding='utf-8') as file:
    content = file.read()
    # è‡ªåŠ¨å…³é—­æ–‡ä»¶ï¼Œå³ä½¿å‘ç”Ÿå¼‚å¸¸
```

## 2. æ–‡ä»¶è¯»å–

### 2.1 read() - è¯»å–å…¨éƒ¨å†…å®¹

```python
# è¯»å–æ•´ä¸ªæ–‡ä»¶
with open('test.txt', 'r', encoding='utf-8') as f:
    content = f.read()
    print(content)

# è¯»å–æŒ‡å®šå­—èŠ‚æ•°
with open('test.txt', 'r', encoding='utf-8') as f:
    content = f.read(10)  # è¯»å–å‰10ä¸ªå­—ç¬¦
    print(content)
```

### 2.2 readline() - è¯»å–ä¸€è¡Œ

```python
with open('test.txt', 'r', encoding='utf-8') as f:
    line1 = f.readline()  # è¯»å–ç¬¬ä¸€è¡Œ
    line2 = f.readline()  # è¯»å–ç¬¬äºŒè¡Œ
    print(line1, line2)
```

### 2.3 readlines() - è¯»å–æ‰€æœ‰è¡Œ

```python
with open('test.txt', 'r', encoding='utf-8') as f:
    lines = f.readlines()  # è¿”å›åˆ—è¡¨
    for line in lines:
        print(line.strip())  # strip() å»é™¤æ¢è¡Œç¬¦
```

### 2.4 å¾ªç¯è¯»å–ï¼ˆæ¨èï¼‰

```python
# å†…å­˜å‹å¥½çš„æ–¹å¼
with open('test.txt', 'r', encoding='utf-8') as f:
    for line in f:
        print(line.strip())
```

## 3. æ–‡ä»¶å†™å…¥

### 3.1 write() - å†™å…¥å­—ç¬¦ä¸²

```python
# å†™å…¥æ¨¡å¼ï¼ˆè¦†ç›–ï¼‰
with open('output.txt', 'w', encoding='utf-8') as f:
    f.write('Hello, Python!\n')
    f.write('è¿™æ˜¯ç¬¬äºŒè¡Œ\n')

# è¿½åŠ æ¨¡å¼
with open('output.txt', 'a', encoding='utf-8') as f:
    f.write('è¿½åŠ çš„å†…å®¹\n')
```

### 3.2 writelines() - å†™å…¥å¤šè¡Œ

```python
lines = ['ç¬¬ä¸€è¡Œ\n', 'ç¬¬äºŒè¡Œ\n', 'ç¬¬ä¸‰è¡Œ\n']

with open('output.txt', 'w', encoding='utf-8') as f:
    f.writelines(lines)
```

### 3.3 å®ç”¨ç¤ºä¾‹ï¼šæ–‡ä»¶å¤åˆ¶

```python
# æ–‡æœ¬æ–‡ä»¶å¤åˆ¶
with open('source.txt', 'r', encoding='utf-8') as source:
    with open('target.txt', 'w', encoding='utf-8') as target:
        content = source.read()
        target.write(content)

# é€è¡Œå¤åˆ¶ï¼ˆå¤§æ–‡ä»¶ï¼‰
with open('source.txt', 'r', encoding='utf-8') as source:
    with open('target.txt', 'w', encoding='utf-8') as target:
        for line in source:
            target.write(line)
```

## 4. äºŒè¿›åˆ¶æ–‡ä»¶æ“ä½œ

### 4.1 è¯»å†™äºŒè¿›åˆ¶æ–‡ä»¶

```python
# è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€éŸ³é¢‘ç­‰ï¼‰
with open('image.jpg', 'rb') as f:
    data = f.read()
    print(f'æ–‡ä»¶å¤§å°: {len(data)} å­—èŠ‚')

# å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶
with open('copy_image.jpg', 'wb') as f:
    f.write(data)
```

### 4.2 æ–‡ä»¶å¤åˆ¶ï¼ˆäºŒè¿›åˆ¶ï¼‰

```python
def copy_file(source, target):
    """å¤åˆ¶ä»»æ„ç±»å‹æ–‡ä»¶"""
    with open(source, 'rb') as src:
        with open(target, 'wb') as dst:
            dst.write(src.read())

copy_file('original.jpg', 'backup.jpg')
```

## 5. æ–‡ä»¶è·¯å¾„æ“ä½œ

### 5.1 os æ¨¡å—

```python
import os

# è·å–å½“å‰å·¥ä½œç›®å½•
print(os.getcwd())

# æ”¹å˜å·¥ä½œç›®å½•
os.chdir('/path/to/directory')

# åˆ—å‡ºç›®å½•å†…å®¹
files = os.listdir('.')
print(files)

# åˆ›å»ºç›®å½•
os.mkdir('new_folder')
os.makedirs('parent/child/grandchild')  # åˆ›å»ºå¤šçº§ç›®å½•

# åˆ é™¤ç›®å½•
os.rmdir('empty_folder')  # åªèƒ½åˆ é™¤ç©ºç›®å½•

# é‡å‘½å
os.rename('old_name.txt', 'new_name.txt')

# åˆ é™¤æ–‡ä»¶
os.remove('file.txt')

# æ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨
if os.path.exists('file.txt'):
    print('æ–‡ä»¶å­˜åœ¨')

# åˆ¤æ–­æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•
print(os.path.isfile('test.txt'))
print(os.path.isdir('folder'))

# è·å–æ–‡ä»¶å¤§å°
size = os.path.getsize('test.txt')
print(f'æ–‡ä»¶å¤§å°: {size} å­—èŠ‚')
```

### 5.2 os.path æ¨¡å—

```python
import os.path

path = '/home/user/documents/file.txt'

# è·¯å¾„æ‹¼æ¥
new_path = os.path.join('folder', 'subfolder', 'file.txt')

# åˆ†ç¦»è·¯å¾„å’Œæ–‡ä»¶å
dir_name, file_name = os.path.split(path)
print(f'ç›®å½•: {dir_name}')
print(f'æ–‡ä»¶å: {file_name}')

# åˆ†ç¦»æ–‡ä»¶åå’Œæ‰©å±•å
name, ext = os.path.splitext('document.pdf')
print(f'åç§°: {name}, æ‰©å±•å: {ext}')

# è·å–ç»å¯¹è·¯å¾„
abs_path = os.path.abspath('file.txt')

# è·å–æ–‡ä»¶æ‰€åœ¨ç›®å½•
dir_path = os.path.dirname('/path/to/file.txt')

# è·å–æ–‡ä»¶å
file_name = os.path.basename('/path/to/file.txt')
```

### 5.3 pathlib æ¨¡å—ï¼ˆæ¨èï¼‰

```python
from pathlib import Path

# åˆ›å»ºè·¯å¾„å¯¹è±¡
p = Path('folder/subfolder/file.txt')

# è·¯å¾„æ‹¼æ¥
path = Path('folder') / 'subfolder' / 'file.txt'

# è·å–å½“å‰ç›®å½•
current = Path.cwd()

# è·å–å®¶ç›®å½•
home = Path.home()

# åˆ›å»ºç›®å½•
Path('new_folder').mkdir(exist_ok=True)
Path('parent/child').mkdir(parents=True, exist_ok=True)

# è¯»å†™æ–‡ä»¶
path = Path('test.txt')
path.write_text('Hello, World!', encoding='utf-8')
content = path.read_text(encoding='utf-8')

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if path.exists():
    print('æ–‡ä»¶å­˜åœ¨')

# åˆ¤æ–­æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•
print(path.is_file())
print(path.is_dir())

# è·å–æ–‡ä»¶ä¿¡æ¯
print(f'æ–‡ä»¶å: {path.name}')
print(f'æ‰©å±•å: {path.suffix}')
print(f'ä¸å«æ‰©å±•å: {path.stem}')
print(f'çˆ¶ç›®å½•: {path.parent}')

# éå†ç›®å½•
for item in Path('.').iterdir():
    if item.is_file():
        print(f'æ–‡ä»¶: {item}')

# é€’å½’æŸ¥æ‰¾æ–‡ä»¶
for txt_file in Path('.').rglob('*.txt'):
    print(txt_file)
```

## 6. å¤„ç†ç‰¹æ®Šæ ¼å¼æ–‡ä»¶

### 6.1 CSV æ–‡ä»¶

```python
import csv

# è¯»å– CSV
with open('data.csv', 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)

# å†™å…¥ CSV
data = [
    ['å§“å', 'å¹´é¾„', 'åŸå¸‚'],
    ['å¼ ä¸‰', '25', 'åŒ—äº¬'],
    ['æå››', '30', 'ä¸Šæµ·']
]

with open('output.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerows(data)

# ä½¿ç”¨å­—å…¸è¯»å†™
with open('data.csv', 'r', encoding='utf-8') as f:
    reader = csv.DictReader(f)
    for row in reader:
        print(row['å§“å'], row['å¹´é¾„'])

with open('output.csv', 'w', newline='', encoding='utf-8') as f:
    fieldnames = ['å§“å', 'å¹´é¾„', 'åŸå¸‚']
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerow({'å§“å': 'ç‹äº”', 'å¹´é¾„': '28', 'åŸå¸‚': 'æ·±åœ³'})
```

### 6.2 JSON æ–‡ä»¶

```python
import json

# è¯»å– JSON
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)
    print(data)

# å†™å…¥ JSON
data = {
    'name': 'å¼ ä¸‰',
    'age': 25,
    'skills': ['Python', 'Java', 'Go']
}

with open('output.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

# JSON å­—ç¬¦ä¸²è½¬æ¢
json_str = json.dumps(data, ensure_ascii=False, indent=2)
data_dict = json.loads(json_str)
```

### 6.3 æ–‡æœ¬æ–‡ä»¶ç¼–ç å¤„ç†

```python
# è¯»å–ä¸åŒç¼–ç çš„æ–‡ä»¶
encodings = ['utf-8', 'gbk', 'gb2312']

for encoding in encodings:
    try:
        with open('file.txt', 'r', encoding=encoding) as f:
            content = f.read()
            print(f'æˆåŠŸä½¿ç”¨ {encoding} ç¼–ç è¯»å–')
            break
    except UnicodeDecodeError:
        continue

# è½¬æ¢æ–‡ä»¶ç¼–ç 
def convert_encoding(input_file, output_file, from_enc, to_enc):
    with open(input_file, 'r', encoding=from_enc) as f:
        content = f.read()
    with open(output_file, 'w', encoding=to_enc) as f:
        f.write(content)

convert_encoding('gbk_file.txt', 'utf8_file.txt', 'gbk', 'utf-8')
```

## 7. å®æˆ˜æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šç»Ÿè®¡æ–‡ä»¶è¡Œæ•°å’Œå­—æ•°

```python
def count_file(filename):
    """ç»Ÿè®¡æ–‡ä»¶çš„è¡Œæ•°å’Œå­—æ•°"""
    with open(filename, 'r', encoding='utf-8') as f:
        lines = f.readlines()
        line_count = len(lines)
        word_count = sum(len(line.split()) for line in lines)
        char_count = sum(len(line) for line in lines)
        
    print(f'è¡Œæ•°: {line_count}')
    print(f'å•è¯æ•°: {word_count}')
    print(f'å­—ç¬¦æ•°: {char_count}')

count_file('document.txt')
```

### æ¡ˆä¾‹2ï¼šæ‰¹é‡é‡å‘½åæ–‡ä»¶

```python
from pathlib import Path

def batch_rename(directory, old_ext, new_ext):
    """æ‰¹é‡ä¿®æ”¹æ–‡ä»¶æ‰©å±•å"""
    path = Path(directory)
    count = 0
    
    for file in path.glob(f'*.{old_ext}'):
        new_name = file.stem + f'.{new_ext}'
        file.rename(file.parent / new_name)
        count += 1
        print(f'é‡å‘½å: {file.name} -> {new_name}')
    
    print(f'å…±é‡å‘½å {count} ä¸ªæ–‡ä»¶')

batch_rename('.', 'txt', 'md')
```

### æ¡ˆä¾‹3ï¼šæ–‡ä»¶å†…å®¹æŸ¥æ‰¾

```python
def search_in_file(filename, keyword):
    """åœ¨æ–‡ä»¶ä¸­æœç´¢å…³é”®è¯"""
    with open(filename, 'r', encoding='utf-8') as f:
        for line_num, line in enumerate(f, 1):
            if keyword in line:
                print(f'ç¬¬ {line_num} è¡Œ: {line.strip()}')

search_in_file('log.txt', 'ERROR')
```

### æ¡ˆä¾‹4ï¼šæ—¥å¿—æ–‡ä»¶åˆ†æ

```python
from collections import Counter
from datetime import datetime

def analyze_log(log_file):
    """åˆ†ææ—¥å¿—æ–‡ä»¶"""
    levels = []
    
    with open(log_file, 'r', encoding='utf-8') as f:
        for line in f:
            if 'ERROR' in line:
                levels.append('ERROR')
            elif 'WARNING' in line:
                levels.append('WARNING')
            elif 'INFO' in line:
                levels.append('INFO')
    
    # ç»Ÿè®¡å„çº§åˆ«æ•°é‡
    counter = Counter(levels)
    print('æ—¥å¿—çº§åˆ«ç»Ÿè®¡:')
    for level, count in counter.items():
        print(f'{level}: {count}')

analyze_log('app.log')
```

## 8. å¸¸è§é—®é¢˜

### 8.1 æ–‡ä»¶æœªå…³é—­

```python
# âŒ é”™è¯¯ç¤ºä¾‹
f = open('file.txt', 'r')
content = f.read()
# å¿˜è®°å…³é—­æ–‡ä»¶

# âœ… æ­£ç¡®ç¤ºä¾‹
with open('file.txt', 'r') as f:
    content = f.read()
# è‡ªåŠ¨å…³é—­
```

### 8.2 ç¼–ç é—®é¢˜

```python
# âŒ å¯èƒ½å‡ºé”™
with open('file.txt', 'r') as f:  # ä½¿ç”¨é»˜è®¤ç¼–ç 
    content = f.read()

# âœ… æ˜ç¡®æŒ‡å®šç¼–ç 
with open('file.txt', 'r', encoding='utf-8') as f:
    content = f.read()
```

### 8.3 è·¯å¾„é—®é¢˜

```python
# âŒ ç¡¬ç¼–ç è·¯å¾„
file = open('C:\\Users\\user\\file.txt', 'r')

# âœ… ä½¿ç”¨ pathlib
from pathlib import Path
file_path = Path.home() / 'documents' / 'file.txt'
with open(file_path, 'r', encoding='utf-8') as f:
    content = f.read()
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å§‹ç»ˆä½¿ç”¨ with è¯­å¥** - è‡ªåŠ¨ç®¡ç†æ–‡ä»¶èµ„æº
2. **æ˜ç¡®æŒ‡å®šç¼–ç ** - é¿å…ç¼–ç é—®é¢˜
3. **ä½¿ç”¨ pathlib** - è·¨å¹³å°è·¯å¾„å¤„ç†
4. **å¤§æ–‡ä»¶é€è¡Œè¯»å–** - é¿å…å†…å­˜æº¢å‡º
5. **å¼‚å¸¸å¤„ç†** - å¤„ç†æ–‡ä»¶ä¸å­˜åœ¨ç­‰å¼‚å¸¸æƒ…å†µ

## ğŸ“ ç»ƒä¹ é¢˜

1. ç¼–å†™ç¨‹åºï¼Œè¯»å–ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œç»Ÿè®¡æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°
2. å®ç°ä¸€ä¸ªæ–‡ä»¶å¤‡ä»½å·¥å…·ï¼Œå®šæœŸå¤‡ä»½æŒ‡å®šæ–‡ä»¶å¤¹
3. ç¼–å†™ç¨‹åºï¼Œåˆå¹¶å¤šä¸ªæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹
4. å®ç°ä¸€ä¸ªç®€å•çš„æ—¥å¿—è®°å½•å™¨ï¼Œå°†æ—¥å¿—å†™å…¥æ–‡ä»¶
5. ç¼–å†™ç¨‹åºï¼Œå°† CSV æ–‡ä»¶è½¬æ¢ä¸º JSON æ ¼å¼

---

**ä¸‹ä¸€èŠ‚ï¼š** [è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨](02-è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨.md)
