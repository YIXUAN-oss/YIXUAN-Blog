# 字典与集合

## 一、字典（Dictionary）

### 1. 字典的定义

字典是一种**键值对（key-value）**的数据结构，通过键来访问值。

```python
# 字面量定义
{key1: value1, key2: value2, ...}

# 变量定义
变量名称 = {key1: value1, key2: value2, ...}

# 定义空字典
变量名称 = {}
变量名称 = dict()
```

**特点：**
- 使用 `{}` 定义
- 键值对之间用逗号分隔
- 键（key）必须是不可变类型（字符串、数字、元组）
- 值（value）可以是任意类型
- 键不能重复，值可以重复

```python
# 定义字典
student = {
    "name": "张三",
    "age": 18,
    "gender": "男",
    "score": 95.5
}

print(student)
print(type(student))  # <class 'dict'>
```

---

### 2. 字典的访问

#### 通过键访问值

```python
student = {
    "name": "张三",
    "age": 18,
    "gender": "男"
}

# 方式1：使用[]
print(student["name"])  # 张三
print(student["age"])   # 18

# 如果键不存在，会报错
# print(student["score"])  # KeyError

# 方式2：使用get()方法（推荐）
print(student.get("name"))   # 张三
print(student.get("score"))  # None（键不存在返回None）
print(student.get("score", 0))  # 0（指定默认值）
```

---

### 3. 字典的修改

#### 修改值

```python
student = {"name": "张三", "age": 18}

# 修改已存在的键的值
student["age"] = 19
print(student)  # {'name': '张三', 'age': 19}
```

#### 添加键值对

```python
student = {"name": "张三", "age": 18}

# 添加新的键值对
student["gender"] = "男"
student["score"] = 95.5
print(student)  # {'name': '张三', 'age': 18, 'gender': '男', 'score': 95.5}
```

---

### 4. 字典的删除

```python
student = {
    "name": "张三",
    "age": 18,
    "gender": "男",
    "score": 95.5
}

# pop() - 删除指定键，并返回对应的值
score = student.pop("score")
print(score)    # 95.5
print(student)  # {'name': '张三', 'age': 18, 'gender': '男'}

# del - 删除指定键
del student["gender"]
print(student)  # {'name': '张三', 'age': 18}

# clear() - 清空字典
student.clear()
print(student)  # {}
```

---

### 5. 字典的常用方法

#### keys() - 获取所有键

```python
student = {"name": "张三", "age": 18, "gender": "男"}

keys = student.keys()
print(keys)  # dict_keys(['name', 'age', 'gender'])
print(list(keys))  # ['name', 'age', 'gender']
```

#### values() - 获取所有值

```python
student = {"name": "张三", "age": 18, "gender": "男"}

values = student.values()
print(values)  # dict_values(['张三', 18, '男'])
print(list(values))  # ['张三', 18, '男']
```

#### items() - 获取所有键值对

```python
student = {"name": "张三", "age": 18, "gender": "男"}

items = student.items()
print(items)  # dict_items([('name', '张三'), ('age', 18), ('gender', '男')])
```

#### update() - 更新字典

```python
student = {"name": "张三", "age": 18}

# 更新字典
student.update({"age": 19, "gender": "男"})
print(student)  # {'name': '张三', 'age': 19, 'gender': '男'}
```

---

### 6. 字典的遍历

#### 遍历键

```python
student = {"name": "张三", "age": 18, "gender": "男"}

# 方式1
for key in student:
    print(key, student[key])

# 方式2
for key in student.keys():
    print(key, student[key])
```

#### 遍历值

```python
student = {"name": "张三", "age": 18, "gender": "男"}

for value in student.values():
    print(value)
```

#### 遍历键值对（推荐）

```python
student = {"name": "张三", "age": 18, "gender": "男"}

for key, value in student.items():
    print(f"{key}: {value}")

# 输出：
# name: 张三
# age: 18
# gender: 男
```

---

### 7. 字典推导式

```python
# 基本语法
{key_expression: value_expression for item in iterable}

# 示例1：创建平方字典
squares = {x: x**2 for x in range(1, 6)}
print(squares)  # {1: 1, 2: 4, 3: 9, 4: 16, 5: 25}

# 示例2：字典键值互换
original = {"a": 1, "b": 2, "c": 3}
swapped = {value: key for key, value in original.items()}
print(swapped)  # {1: 'a', 2: 'b', 3: 'c'}

# 示例3：带条件的字典推导式
scores = {"张三": 85, "李四": 92, "王五": 78, "赵六": 95}
high_scores = {name: score for name, score in scores.items() if score >= 90}
print(high_scores)  # {'李四': 92, '赵六': 95}
```

---

### 8. 嵌套字典

```python
# 学生信息字典
students = {
    "001": {"name": "张三", "age": 18, "score": 85},
    "002": {"name": "李四", "age": 19, "score": 92},
    "003": {"name": "王五", "age": 18, "score": 78}
}

# 访问嵌套字典
print(students["001"]["name"])  # 张三
print(students["002"]["score"]) # 92

# 遍历嵌套字典
for student_id, info in students.items():
    print(f"学号：{student_id}")
    print(f"姓名：{info['name']}")
    print(f"年龄：{info['age']}")
    print(f"成绩：{info['score']}")
    print("---")
```

---

## 二、集合（Set）

### 1. 集合的定义

集合是一种**无序、不重复**的数据容器。

```python
# 字面量定义
{元素1, 元素2, 元素3, ...}

# 变量定义
变量名称 = {元素1, 元素2, 元素3, ...}

# 定义空集合（注意：不能用{}，会被识别为字典）
变量名称 = set()
```

**特点：**
- 使用 `{}` 定义
- 元素不能重复（自动去重）
- 元素无序（不支持索引）
- 元素必须是不可变类型

```python
# 定义集合
my_set = {1, 2, 3, 4, 5}
print(my_set)
print(type(my_set))  # <class 'set'>

# 自动去重
my_set = {1, 2, 2, 3, 3, 3}
print(my_set)  # {1, 2, 3}

# 定义空集合
empty_set = set()
print(type(empty_set))  # <class 'set'>
```

---

### 2. 集合的添加

```python
my_set = {1, 2, 3}

# add() - 添加单个元素
my_set.add(4)
print(my_set)  # {1, 2, 3, 4}

# update() - 添加多个元素
my_set.update([5, 6, 7])
print(my_set)  # {1, 2, 3, 4, 5, 6, 7}
```

---

### 3. 集合的删除

```python
my_set = {1, 2, 3, 4, 5}

# remove() - 删除指定元素（元素不存在会报错）
my_set.remove(3)
print(my_set)  # {1, 2, 4, 5}

# discard() - 删除指定元素（元素不存在不会报错）
my_set.discard(10)  # 不会报错
print(my_set)  # {1, 2, 4, 5}

# pop() - 随机删除一个元素
element = my_set.pop()
print(f"删除的元素：{element}")
print(my_set)

# clear() - 清空集合
my_set.clear()
print(my_set)  # set()
```

---

### 4. 集合运算

#### 交集（&）

```python
set1 = {1, 2, 3, 4, 5}
set2 = {4, 5, 6, 7, 8}

# 方式1：使用&
result = set1 & set2
print(result)  # {4, 5}

# 方式2：使用intersection()
result = set1.intersection(set2)
print(result)  # {4, 5}
```

#### 并集（|）

```python
set1 = {1, 2, 3, 4, 5}
set2 = {4, 5, 6, 7, 8}

# 方式1：使用|
result = set1 | set2
print(result)  # {1, 2, 3, 4, 5, 6, 7, 8}

# 方式2：使用union()
result = set1.union(set2)
print(result)  # {1, 2, 3, 4, 5, 6, 7, 8}
```

#### 差集（-）

```python
set1 = {1, 2, 3, 4, 5}
set2 = {4, 5, 6, 7, 8}

# 方式1：使用-
result = set1 - set2
print(result)  # {1, 2, 3}

# 方式2：使用difference()
result = set1.difference(set2)
print(result)  # {1, 2, 3}
```

#### 对称差集（^）

```python
set1 = {1, 2, 3, 4, 5}
set2 = {4, 5, 6, 7, 8}

# 方式1：使用^
result = set1 ^ set2
print(result)  # {1, 2, 3, 6, 7, 8}

# 方式2：使用symmetric_difference()
result = set1.symmetric_difference(set2)
print(result)  # {1, 2, 3, 6, 7, 8}
```

---

### 5. 集合的遍历

```python
my_set = {1, 2, 3, 4, 5}

# for循环遍历
for element in my_set:
    print(element)
```

**注意：** 集合是无序的，遍历顺序可能不固定！

---

### 6. 集合推导式

```python
# 基本语法
{expression for item in iterable if condition}

# 示例1：生成平方集合
squares = {x**2 for x in range(1, 6)}
print(squares)  # {1, 4, 9, 16, 25}

# 示例2：过滤偶数
evens = {x for x in range(1, 11) if x % 2 == 0}
print(evens)  # {2, 4, 6, 8, 10}
```

---

## 三、数据容器对比

| 特性 | 列表 | 元组 | 字典 | 集合 |
|------|------|------|------|------|
| 定义符号 | [] | () | {key:value} | {元素} |
| 有序性 | 有序 | 有序 | 无序（3.7+有序） | 无序 |
| 可变性 | 可变 | 不可变 | 可变 | 可变 |
| 重复元素 | 允许 | 允许 | 键不允许 | 不允许 |
| 索引访问 | 支持 | 支持 | 不支持 | 不支持 |
| 使用场景 | 通用序列 | 不可变序列 | 键值对映射 | 去重、集合运算 |

---

## 四、实战练习

### 练习1：统计字符出现次数

```python
text = "hello world"
char_count = {}

for char in text:
    if char in char_count:
        char_count[char] += 1
    else:
        char_count[char] = 1

print(char_count)
# {'h': 1, 'e': 1, 'l': 3, 'o': 2, ' ': 1, 'w': 1, 'r': 1, 'd': 1}

# 使用get()方法简化
char_count = {}
for char in text:
    char_count[char] = char_count.get(char, 0) + 1
print(char_count)
```

### 练习2：列表去重

```python
my_list = [1, 2, 3, 2, 4, 3, 5, 1]

# 使用集合去重
unique_list = list(set(my_list))
print(unique_list)  # [1, 2, 3, 4, 5]
```

### 练习3：学生成绩管理

```python
# 学生成绩字典
students = {
    "张三": 85,
    "李四": 92,
    "王五": 78,
    "赵六": 95,
    "孙七": 88
}

# 统计信息
print(f"总人数：{len(students)}")
print(f"平均分：{sum(students.values()) / len(students):.2f}")
print(f"最高分：{max(students.values())}")
print(f"最低分：{min(students.values())}")

# 找出最高分的学生
max_score = max(students.values())
for name, score in students.items():
    if score == max_score:
        print(f"最高分学生：{name}，分数：{score}")

# 及格学生
passed = {name: score for name, score in students.items() if score >= 60}
print(f"及格学生：{passed}")
```

---

## 五、知识点总结

### ✅ 核心要点

1. **字典**：键值对结构，通过键访问值
2. **集合**：无序不重复，用于去重和集合运算
3. **字典方法**：get、keys、values、items、update
4. **集合运算**：交集、并集、差集、对称差集
5. **推导式**：字典推导式、集合推导式

### 📝 面试重点

- 字典和列表的区别
- 字典的键必须是不可变类型
- 集合的特点：无序、不重复
- 集合运算的应用
- 如何选择合适的数据容器

---

**上一章：** [列表与元组](06-列表与元组.md)  
**下一章：** [第02章-核心篇](../第02章-核心篇/01-函数基础.md) →
