# Java 数组

> **本章重点：** 一维数组、二维数组、数组操作、数组内存分析
> 
> **面试频率：** ⭐⭐⭐⭐

---

## 目录
- [一、数组的基本概念](#一数组的基本概念)
- [二、一维数组](#二一维数组)
- [三、数组的内存分析](#三数组的内存分析)
- [四、数组的常用操作](#四数组的常用操作)
- [五、二维数组](#五二维数组)
- [六、经典案例](#六经典案例)

---

## 一、数组的基本概念

### 1.1 什么是数组

**数组：** 一组相同类型数据的集合，用于存储多个数据。

**特点：**
1. 数组中的元素类型必须相同
2. 数组长度固定，创建后不能改变
3. 数组是引用类型
4. 数组下标从 0 开始

### 1.2 为什么需要数组

**问题场景：**
```java
// 需要存储100个学生的成绩
int score1 = 85;
int score2 = 90;
int score3 = 88;
// ... 定义100个变量？太麻烦！
```

**使用数组：**
```java
int[] scores = new int[100];  // 一行代码搞定
```

---

## 二、一维数组

### 2.1 数组的声明和创建

**方式一：动态初始化（先声明，再分配空间）**
```java
// 1. 声明数组
int[] arr;           // 推荐写法
// int arr[];        // 也可以，但不推荐

// 2. 创建数组（分配空间）
arr = new int[5];    // 创建长度为5的int数组

// 3. 赋值
arr[0] = 10;
arr[1] = 20;
arr[2] = 30;
arr[3] = 40;
arr[4] = 50;

// 也可以合并为一步
int[] arr2 = new int[5];
```

**方式二：静态初始化（声明并赋值）**
```java
// 方式1：标准写法
int[] arr1 = new int[]{1, 2, 3, 4, 5};

// 方式2：简化写法（推荐）
int[] arr2 = {1, 2, 3, 4, 5};

// 注意：以下写法错误
// int[] arr3;
// arr3 = {1, 2, 3};  // ❌ 错误：必须使用 new int[]{}
```

### 2.2 数组的访问

**通过下标访问：**
```java
int[] arr = {10, 20, 30, 40, 50};

// 访问元素
System.out.println(arr[0]);  // 10
System.out.println(arr[2]);  // 30

// 修改元素
arr[0] = 100;
System.out.println(arr[0]);  // 100

// 获取数组长度
System.out.println(arr.length);  // 5
```

**数组越界异常：**
```java
int[] arr = {1, 2, 3};
System.out.println(arr[3]);  // ❌ ArrayIndexOutOfBoundsException
System.out.println(arr[-1]); // ❌ ArrayIndexOutOfBoundsException
```

### 2.3 数组的遍历

**方式一：普通 for 循环**
```java
int[] arr = {10, 20, 30, 40, 50};

for (int i = 0; i < arr.length; i++) {
    System.out.println(arr[i]);
}
```

**方式二：增强 for 循环（foreach）**
```java
int[] arr = {10, 20, 30, 40, 50};

for (int num : arr) {
    System.out.println(num);
}
```

**两种方式的区别：**
- 普通 for：可以获取索引，可以修改元素
- 增强 for：代码简洁，但不能获取索引，不能修改元素

### 2.4 数组的默认值

**数组创建后，如果没有赋值，会有默认值：**

| 数据类型 | 默认值 |
|----------|--------|
| byte, short, int, long | 0 |
| float, double | 0.0 |
| char | '\u0000'（空字符） |
| boolean | false |
| 引用类型（String等） | null |

**示例：**
```java
int[] intArr = new int[3];
System.out.println(intArr[0]);  // 0

double[] doubleArr = new double[3];
System.out.println(doubleArr[0]);  // 0.0

boolean[] boolArr = new boolean[3];
System.out.println(boolArr[0]);  // false

String[] strArr = new String[3];
System.out.println(strArr[0]);  // null
```

### 2.5 数组使用注意事项

**1. 数组是引用类型**
```java
int[] arr1 = {1, 2, 3};
int[] arr2 = arr1;  // arr2 指向 arr1 的地址

arr2[0] = 100;
System.out.println(arr1[0]);  // 100（arr1 也被修改了）
```

**2. 数组长度不可变**
```java
int[] arr = new int[5];
// arr.length = 10;  // ❌ 错误：length 是 final 的
```

**3. 数组元素类型必须统一**
```java
int[] arr = {1, 2, 3};
// arr[0] = "hello";  // ❌ 错误：类型不匹配
```

---

## 三、数组的内存分析

### 3.1 数组在内存中的存储

```
栈（Stack）                     堆（Heap）
┌──────────┐                 ┌────────────────┐
│ arr ──────┼────────────────>│ [0] → 10       │
└──────────┘                 │ [1] → 20       │
                             │ [2] → 30       │
                             │ [3] → 40       │
                             │ [4] → 50       │
                             └────────────────┘
```

**说明：**
- **栈**：存储数组的引用（地址）
- **堆**：存储数组的实际数据

### 3.2 数组赋值机制

**基本类型数组：**
```java
int[] arr1 = {1, 2, 3};
int[] arr2 = arr1;  // 赋值的是引用（地址）

arr2[0] = 100;
System.out.println(arr1[0]);  // 100（指向同一个数组）
```

**数组复制：**
```java
// 方式一：手动复制
int[] arr1 = {1, 2, 3};
int[] arr2 = new int[arr1.length];
for (int i = 0; i < arr1.length; i++) {
    arr2[i] = arr1[i];
}

// 方式二：使用 Arrays.copyOf()
int[] arr3 = Arrays.copyOf(arr1, arr1.length);

// 方式三：使用 System.arraycopy()
int[] arr4 = new int[arr1.length];
System.arraycopy(arr1, 0, arr4, 0, arr1.length);
```

---

## 四、数组的常用操作

### 4.1 数组的查找

**查找元素：**
```java
int[] arr = {10, 20, 30, 40, 50};
int target = 30;
int index = -1;

for (int i = 0; i < arr.length; i++) {
    if (arr[i] == target) {
        index = i;
        break;
    }
}

if (index != -1) {
    System.out.println("找到了，下标为：" + index);
} else {
    System.out.println("没找到");
}
```

### 4.2 数组的排序

**冒泡排序：**
```java
int[] arr = {5, 2, 8, 1, 9};

// 冒泡排序
for (int i = 0; i < arr.length - 1; i++) {
    for (int j = 0; j < arr.length - 1 - i; j++) {
        if (arr[j] > arr[j + 1]) {
            // 交换
            int temp = arr[j];
            arr[j] = arr[j + 1];
            arr[j + 1] = temp;
        }
    }
}

// 使用 Arrays.sort()（推荐）
Arrays.sort(arr);
```

### 4.3 数组的反转

```java
int[] arr = {1, 2, 3, 4, 5};

// 反转
for (int i = 0; i < arr.length / 2; i++) {
    int temp = arr[i];
    arr[i] = arr[arr.length - 1 - i];
    arr[arr.length - 1 - i] = temp;
}

System.out.println(Arrays.toString(arr));  // [5, 4, 3, 2, 1]
```

### 4.4 数组的扩容

**动态扩容：**
```java
import java.util.Scanner;

public class ArrayExpand {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int[] arr = {1, 2, 3};
        
        while (true) {
            // 1. 创建新数组（长度+1）
            int[] newArr = new int[arr.length + 1];
            
            // 2. 复制旧数组元素
            for (int i = 0; i < arr.length; i++) {
                newArr[i] = arr[i];
            }
            
            // 3. 添加新元素
            System.out.print("请输入要添加的元素：");
            int addNum = sc.nextInt();
            newArr[newArr.length - 1] = addNum;
            
            // 4. 让 arr 指向新数组
            arr = newArr;
            
            // 5. 输出数组
            System.out.println("扩容后的数组：");
            System.out.println(Arrays.toString(arr));
            
            // 6. 询问是否继续
            System.out.print("是否继续添加？(y/n)：");
            char choice = sc.next().charAt(0);
            if (choice == 'n' || choice == 'N') {
                break;
            }
        }
        
        sc.close();
    }
}
```

### 4.5 数组的缩减

```java
int[] arr = {1, 2, 3, 4, 5};

// 缩减（删除最后一个元素）
if (arr.length > 1) {
    int[] newArr = new int[arr.length - 1];
    for (int i = 0; i < newArr.length; i++) {
        newArr[i] = arr[i];
    }
    arr = newArr;
}

System.out.println(Arrays.toString(arr));  // [1, 2, 3, 4]
```

---

## 五、二维数组

### 5.1 二维数组的概念

**二维数组：** 数组的数组，用于存储表格型数据。

```
arr[0]  →  [1, 2, 3]
arr[1]  →  [4, 5, 6]
arr[2]  →  [7, 8, 9]
```

### 5.2 二维数组的声明和创建

**方式一：动态初始化**
```java
// 1. 声明
int[][] arr;

// 2. 创建（3行4列）
arr = new int[3][4];

// 3. 赋值
arr[0][0] = 1;
arr[0][1] = 2;
// ...

// 也可以合并为一步
int[][] arr2 = new int[3][4];
```

**方式二：动态初始化（列数不固定）**
```java
int[][] arr = new int[3][];  // 只指定行数

// 为每一行分配空间
arr[0] = new int[2];  // 第1行有2列
arr[1] = new int[3];  // 第2行有3列
arr[2] = new int[4];  // 第3行有4列
```

**方式三：静态初始化**
```java
// 标准写法
int[][] arr1 = new int[][]{{1, 2}, {3, 4, 5}, {6, 7, 8, 9}};

// 简化写法（推荐）
int[][] arr2 = {{1, 2}, {3, 4, 5}, {6, 7, 8, 9}};
```

### 5.3 二维数组的访问

```java
int[][] arr = {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}};

// 访问元素
System.out.println(arr[0][0]);  // 1
System.out.println(arr[1][2]);  // 6

// 获取行数
System.out.println(arr.length);  // 3

// 获取某一行的列数
System.out.println(arr[0].length);  // 3
System.out.println(arr[1].length);  // 3
```

### 5.4 二维数组的遍历

**方式一：普通 for 循环**
```java
int[][] arr = {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}};

for (int i = 0; i < arr.length; i++) {
    for (int j = 0; j < arr[i].length; j++) {
        System.out.print(arr[i][j] + " ");
    }
    System.out.println();
}
```

**方式二：增强 for 循环**
```java
int[][] arr = {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}};

for (int[] row : arr) {
    for (int num : row) {
        System.out.print(num + " ");
    }
    System.out.println();
}
```

### 5.5 二维数组的内存分析

```
栈（Stack）                     堆（Heap）
┌──────────┐                 ┌────────────────┐
│ arr ──────┼────────────────>│ [0] ───────┐   │
└──────────┘                 │ [1] ───────┼─┐ │
                             │ [2] ───────┼─┼─┤
                             └────────────┼─┼─┘
                                          ↓ ↓ ↓
                             ┌─────────────────┐
                             │ [1, 2, 3]       │
                             ├─────────────────┤
                             │ [4, 5, 6]       │
                             ├─────────────────┤
                             │ [7, 8, 9]       │
                             └─────────────────┘
```

---

## 六、经典案例

### 6.1 杨辉三角

**问题：** 打印10行杨辉三角。

```
1
1 1
1 2 1
1 3 3 1
1 4 6 4 1
...
```

**规律：**
1. 第一列和对角线都是 1
2. 其他位置：`arr[i][j] = arr[i-1][j] + arr[i-1][j-1]`

**代码实现：**
```java
public class YangHuiTriangle {
    public static void main(String[] args) {
        int n = 10;  // 打印10行
        int[][] triangle = new int[n][];
        
        // 1. 为每一行分配空间
        for (int i = 0; i < n; i++) {
            triangle[i] = new int[i + 1];
        }
        
        // 2. 赋值
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < triangle[i].length; j++) {
                // 第一列和对角线都是1
                if (j == 0 || j == triangle[i].length - 1) {
                    triangle[i][j] = 1;
                } else {
                    // 其他位置等于上一行的两个数之和
                    triangle[i][j] = triangle[i-1][j] + triangle[i-1][j-1];
                }
            }
        }
        
        // 3. 打印
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < triangle[i].length; j++) {
                System.out.print(triangle[i][j] + " ");
            }
            System.out.println();
        }
    }
}
```

### 6.2 数组转置

**问题：** 将二维数组转置（行列互换）。

```java
public class ArrayTranspose {
    public static void main(String[] args) {
        int[][] arr = {{1, 2, 3}, {4, 5, 6}};
        
        // 创建转置后的数组
        int[][] transposed = new int[arr[0].length][arr.length];
        
        // 转置
        for (int i = 0; i < arr.length; i++) {
            for (int j = 0; j < arr[i].length; j++) {
                transposed[j][i] = arr[i][j];
            }
        }
        
        // 打印
        for (int[] row : transposed) {
            System.out.println(Arrays.toString(row));
        }
    }
}
```

### 6.3 螺旋矩阵

**问题：** 按螺旋顺序打印二维数组。

```
输入：{{1, 2, 3}, {4, 5, 6}, {7, 8, 9}}
输出：1 2 3 6 9 8 7 4 5
```

**代码实现：**
```java
public class SpiralMatrix {
    public static void main(String[] args) {
        int[][] matrix = {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}};
        
        int top = 0;
        int bottom = matrix.length - 1;
        int left = 0;
        int right = matrix[0].length - 1;
        
        while (top <= bottom && left <= right) {
            // 从左到右
            for (int i = left; i <= right; i++) {
                System.out.print(matrix[top][i] + " ");
            }
            top++;
            
            // 从上到下
            for (int i = top; i <= bottom; i++) {
                System.out.print(matrix[i][right] + " ");
            }
            right--;
            
            // 从右到左
            if (top <= bottom) {
                for (int i = right; i >= left; i--) {
                    System.out.print(matrix[bottom][i] + " ");
                }
                bottom--;
            }
            
            // 从下到上
            if (left <= right) {
                for (int i = bottom; i >= top; i--) {
                    System.out.print(matrix[i][left] + " ");
                }
                left++;
            }
        }
    }
}
```

---

## 📚 快速记忆

**1. 数组的特点：**
- 长度固定
- 类型统一
- 下标从0开始
- 引用类型

**2. 数组的创建：**
- 动态初始化：`int[] arr = new int[5];`
- 静态初始化：`int[] arr = {1, 2, 3};`

**3. 数组的遍历：**
- 普通 for：可获取索引，可修改元素
- 增强 for：代码简洁，只读

**4. 二维数组：**
- 数组的数组
- 可以是不规则数组（列数不同）
- 访问：`arr[行][列]`

**5. 常用操作：**
- 查找、排序、反转
- 扩容、缩减
- Arrays 工具类

---

**上一章：** [运算符](03-运算符（优化版）.md)

**下一章：** [简单类型与引用类型](05-简单类型与引用类型.md) →
