---
title: Maven实战应用
---

# Maven实战应用

## 一、构建Web项目

### 1.1 创建Web项目

**使用 Maven 原型创建：**

```bash
mvn archetype:generate \
  -DgroupId=com.example \
  -DartifactId=web-demo \
  -DarchetypeArtifactId=maven-archetype-webapp \
  -DinteractiveMode=false
```

**生成的项目结构：**

```
web-demo/
├── pom.xml
└── src/
    └── main/
        ├── resources/
        └── webapp/
            ├── WEB-INF/
            │   └── web.xml
            └── index.jsp
```

### 1.2 完善Web项目结构

添加 Java 源代码目录：

```
web-demo/
├── pom.xml
└── src/
    ├── main/
    │   ├── java/              # 手动创建
    │   │   └── com/
    │   │       └── example/
    │   │           └── servlet/
    │   ├── resources/         # 手动创建
    │   └── webapp/
    │       ├── WEB-INF/
    │       │   └── web.xml
    │       └── index.jsp
    └── test/
        └── java/              # 手动创建
```

### 1.3 配置 pom.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.example</groupId>
    <artifactId>web-demo</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>war</packaging>
    
    <properties>
        <maven.compiler.source>1.8</maven.compiler.source>
        <maven.compiler.target>1.8</maven.compiler.target>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>
    
    <dependencies>
        <!-- Servlet API -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>4.0.1</version>
            <scope>provided</scope>
        </dependency>
        
        <!-- JSP API -->
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>javax.servlet.jsp-api</artifactId>
            <version>2.3.3</version>
            <scope>provided</scope>
        </dependency>
        
        <!-- JSTL -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        
        <!-- JUnit -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.13.2</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
    
    <build>
        <finalName>web-demo</finalName>
        <plugins>
            <!-- Tomcat 插件 -->
            <plugin>
                <groupId>org.apache.tomcat.maven</groupId>
                <artifactId>tomcat7-maven-plugin</artifactId>
                <version>2.2</version>
                <configuration>
                    <port>8080</port>
                    <path>/</path>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

### 1.4 编写Servlet

`src/main/java/com/example/servlet/HelloServlet.java`:

```java
package com.example.servlet;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.io.PrintWriter;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        resp.setContentType("text/html;charset=UTF-8");
        PrintWriter out = resp.getWriter();
        
        String name = req.getParameter("name");
        if (name == null || name.isEmpty()) {
            name = "World";
        }
        
        out.println("<html>");
        out.println("<head><title>Hello</title></head>");
        out.println("<body>");
        out.println("<h1>Hello, " + name + "!</h1>");
        out.println("</body>");
        out.println("</html>");
    }
}
```

### 1.5 运行Web项目

```bash
# 方式1：使用 Tomcat 插件运行
mvn tomcat7:run

# 访问：http://localhost:8080/hello?name=Maven

# 方式2：打包部署
mvn clean package
# 将 target/web-demo.war 部署到 Tomcat 的 webapps 目录
```

---

## 二、构建Spring Boot项目

### 2.1 使用Spring Initializr

**在线创建：**
1. 访问：https://start.spring.io/
2. 配置项目信息：
   - Project: Maven
   - Language: Java
   - Spring Boot: 2.7.x
   - Group: com.example
   - Artifact: springboot-demo
   - Packaging: Jar
   - Java: 8
3. 添加依赖：Spring Web
4. 点击 Generate 下载项目

**使用命令行创建：**

```bash
curl https://start.spring.io/starter.zip \
  -d type=maven-project \
  -d language=java \
  -d bootVersion=2.7.12 \
  -d groupId=com.example \
  -d artifactId=springboot-demo \
  -d name=springboot-demo \
  -d packageName=com.example.demo \
  -d packaging=jar \
  -d javaVersion=8 \
  -d dependencies=web \
  -o springboot-demo.zip
  
unzip springboot-demo.zip
```

### 2.2 Spring Boot 项目结构

```
springboot-demo/
├── pom.xml
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/
│   │   │       └── example/
│   │   │           └── demo/
│   │   │               ├── SpringbootDemoApplication.java
│   │   │               ├── controller/
│   │   │               ├── service/
│   │   │               └── entity/
│   │   └── resources/
│   │       ├── application.properties
│   │       ├── static/
│   │       └── templates/
│   └── test/
│       └── java/
└── target/
```

### 2.3 Spring Boot pom.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0">
    <modelVersion>4.0.0</modelVersion>
    
    <!-- 继承 Spring Boot 父项目 -->
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.12</version>
        <relativePath/>
    </parent>
    
    <groupId>com.example</groupId>
    <artifactId>springboot-demo</artifactId>
    <version>1.0.0</version>
    <packaging>jar</packaging>
    
    <properties>
        <java.version>1.8</java.version>
    </properties>
    
    <dependencies>
        <!-- Spring Boot Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        
        <!-- Spring Boot Test -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        
        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
    </dependencies>
    
    <build>
        <plugins>
            <!-- Spring Boot Maven 插件 -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
</project>
```

### 2.4 编写Controller

`src/main/java/com/example/demo/controller/HelloController.java`:

```java
package com.example.demo.controller;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {
    
    @GetMapping("/hello")
    public String hello(@RequestParam(defaultValue = "World") String name) {
        return "Hello, " + name + "!";
    }
}
```

### 2.5 运行Spring Boot项目

```bash
# 方式1：使用 Maven 运行
mvn spring-boot:run

# 方式2：打包后运行
mvn clean package
java -jar target/springboot-demo-1.0.0.jar

# 访问：http://localhost:8080/hello?name=Maven
```

---

## 三、多模块项目开发

### 3.1 多模块项目结构

多模块项目适用于大型项目，可以将项目拆分为多个模块，每个模块负责不同的功能。

**典型的多模块结构：**

```
parent-project/
├── pom.xml                  # 父 POM
├── common-module/           # 公共模块
│   ├── pom.xml
│   └── src/
├── dao-module/              # 数据访问层
│   ├── pom.xml
│   └── src/
├── service-module/          # 业务逻辑层
│   ├── pom.xml
│   └── src/
└── web-module/              # Web 层
    ├── pom.xml
    └── src/
```

### 3.2 创建父项目

**步骤1：创建父项目目录**

```bash
mkdir parent-project
cd parent-project
```

**步骤2：创建父 pom.xml**

`pom.xml`:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0">
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.example</groupId>
    <artifactId>parent-project</artifactId>
    <version>1.0.0</version>
    <packaging>pom</packaging>
    
    <name>parent-project</name>
    <description>多模块父项目</description>
    
    <!-- 声明子模块 -->
    <modules>
        <module>common-module</module>
        <module>dao-module</module>
        <module>service-module</module>
        <module>web-module</module>
    </modules>
    
    <!-- 统一管理属性 -->
    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <maven.compiler.source>1.8</maven.compiler.source>
        <maven.compiler.target>1.8</maven.compiler.target>
        <spring.version>5.3.20</spring.version>
        <mysql.version>8.0.28</mysql.version>
        <lombok.version>1.18.24</lombok.version>
    </properties>
    
    <!-- 统一管理依赖版本 -->
    <dependencyManagement>
        <dependencies>
            <!-- Spring Framework -->
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-context</artifactId>
                <version>${spring.version}</version>
            </dependency>
            
            <!-- MySQL -->
            <dependency>
                <groupId>mysql</groupId>
                <artifactId>mysql-connector-java</artifactId>
                <version>${mysql.version}</version>
            </dependency>
            
            <!-- Lombok -->
            <dependency>
                <groupId>org.projectlombok</groupId>
                <artifactId>lombok</artifactId>
                <version>${lombok.version}</version>
                <scope>provided</scope>
            </dependency>
            
            <!-- JUnit -->
            <dependency>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
                <version>4.13.2</version>
                <scope>test</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>
    
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>3.8.1</version>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
</project>
```

### 3.3 创建子模块

**创建 common-module：**

```bash
cd parent-project
mvn archetype:generate \
  -DgroupId=com.example \
  -DartifactId=common-module \
  -DarchetypeArtifactId=maven-archetype-quickstart \
  -DinteractiveMode=false
```

`common-module/pom.xml`:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0">
    <modelVersion>4.0.0</modelVersion>
    
    <!-- 继承父项目 -->
    <parent>
        <groupId>com.example</groupId>
        <artifactId>parent-project</artifactId>
        <version>1.0.0</version>
    </parent>
    
    <artifactId>common-module</artifactId>
    <packaging>jar</packaging>
    
    <name>common-module</name>
    <description>公共模块</description>
    
    <dependencies>
        <!-- 继承父项目的版本管理，无需指定版本 -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
        </dependency>
        
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
        </dependency>
    </dependencies>
</project>
```

**创建其他模块：**

同样的方式创建 `dao-module`、`service-module`、`web-module`。

### 3.4 模块间依赖

**dao-module 依赖 common-module：**

`dao-module/pom.xml`:

```xml
<dependencies>
    <!-- 依赖同一项目中的其他模块 -->
    <dependency>
        <groupId>com.example</groupId>
        <artifactId>common-module</artifactId>
        <version>${project.parent.version}</version>
    </dependency>
    
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
    </dependency>
</dependencies>
```

**service-module 依赖 dao-module：**

`service-module/pom.xml`:

```xml
<dependencies>
    <dependency>
        <groupId>com.example</groupId>
        <artifactId>dao-module</artifactId>
        <version>${project.parent.version}</version>
    </dependency>
    
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
    </dependency>
</dependencies>
```

**web-module 依赖 service-module：**

`web-module/pom.xml`:

```xml
<dependencies>
    <dependency>
        <groupId>com.example</groupId>
        <artifactId>service-module</artifactId>
        <version>${project.parent.version}</version>
    </dependency>
    
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>4.0.1</version>
        <scope>provided</scope>
    </dependency>
</dependencies>
```

### 3.5 构建多模块项目

**在父项目根目录执行：**

```bash
# 清理所有模块
mvn clean

# 编译所有模块
mvn compile

# 打包所有模块
mvn package

# 安装所有模块到本地仓库
mvn install

# 只构建某个模块
mvn install -pl web-module

# 构建某个模块及其依赖
mvn install -pl web-module -am
```

**Maven 多模块命令参数：**

| 参数 | 说明 |
|-----|------|
| `-pl` | 指定要构建的模块 |
| `-am` | 同时构建依赖的模块 |
| `-amd` | 同时构建依赖于当前模块的模块 |
| `-rf` | 从指定模块开始构建 |

---

## 四、继承与聚合

### 4.1 继承

**继承的作用：**
- 统一管理依赖版本
- 统一配置插件
- 共享配置信息

**父项目配置：**

```xml
<project>
    <groupId>com.example</groupId>
    <artifactId>parent</artifactId>
    <version>1.0.0</version>
    <packaging>pom</packaging>
    
    <dependencyManagement>
        <dependencies>
            <!-- 管理依赖版本 -->
        </dependencies>
    </dependencyManagement>
</project>
```

**子项目继承：**

```xml
<project>
    <parent>
        <groupId>com.example</groupId>
        <artifactId>parent</artifactId>
        <version>1.0.0</version>
    </parent>
    
    <artifactId>child</artifactId>
    
    <!-- 无需指定 groupId 和 version，继承自父项目 -->
</project>
```

### 4.2 聚合

**聚合的作用：**
- 一次构建多个项目
- 统一管理多个模块

**聚合项目配置：**

```xml
<project>
    <groupId>com.example</groupId>
    <artifactId>aggregator</artifactId>
    <version>1.0.0</version>
    <packaging>pom</packaging>
    
    <modules>
        <module>module-a</module>
        <module>module-b</module>
        <module>module-c</module>
    </modules>
</project>
```

### 4.3 继承与聚合的结合

通常，父项目同时作为聚合项目：

```xml
<project>
    <groupId>com.example</groupId>
    <artifactId>parent-aggregator</artifactId>
    <version>1.0.0</version>
    <packaging>pom</packaging>
    
    <!-- 聚合 -->
    <modules>
        <module>module-a</module>
        <module>module-b</module>
    </modules>
    
    <!-- 继承 -->
    <dependencyManagement>
        <dependencies>
            <!-- 依赖管理 -->
        </dependencies>
    </dependencyManagement>
</project>
```

---

## 五、版本管理最佳实践

### 5.1 版本号规范

**语义化版本：** `主版本.次版本.修订号`

```
1.0.0 - 初始版本
1.1.0 - 新增功能（向下兼容）
1.1.1 - Bug 修复（向下兼容）
2.0.0 - 重大更新（不兼容旧版本）
```

**版本类型：**

```xml
<!-- 开发版本 -->
<version>1.0.0-SNAPSHOT</version>

<!-- 正式版本 -->
<version>1.0.0</version>

<!-- 候选版本 -->
<version>1.0.0-RC1</version>

<!-- 里程碑版本 -->
<version>1.0.0-M1</version>
```

### 5.2 SNAPSHOT 版本

**SNAPSHOT 版本特点：**
- 每次构建都可能不同
- Maven 会自动检查更新
- 仅用于开发环境

**示例：**

```xml
<dependency>
    <groupId>com.example</groupId>
    <artifactId>my-lib</artifactId>
    <version>1.0.0-SNAPSHOT</version>
</dependency>
```

### 5.3 版本管理插件

**versions-maven-plugin：**

```bash
# 更新父项目版本
mvn versions:set -DnewVersion=2.0.0

# 更新依赖版本
mvn versions:use-latest-versions

# 显示可更新的依赖
mvn versions:display-dependency-updates

# 显示可更新的插件
mvn versions:display-plugin-updates
```

---

## 六、实战案例：用户管理系统

### 6.1 项目结构

```
user-management-system/
├── pom.xml (父项目)
├── user-common/              # 公共模块
│   ├── pom.xml
│   └── src/main/java/
│       └── com/example/common/
│           ├── entity/User.java
│           └── vo/Result.java
├── user-dao/                 # 数据访问层
│   ├── pom.xml
│   └── src/main/java/
│       └── com/example/dao/
│           └── UserDao.java
├── user-service/             # 业务逻辑层
│   ├── pom.xml
│   └── src/main/java/
│       └── com/example/service/
│           └── UserService.java
└── user-web/                 # Web 层
    ├── pom.xml
    └── src/main/java/
        └── com/example/web/
            └── controller/
                └── UserController.java
```

### 6.2 实体类（user-common）

`User.java`:

```java
package com.example.common.entity;

import lombok.Data;

@Data
public class User {
    private Long id;
    private String username;
    private String email;
    private Integer age;
}
```

`Result.java`:

```java
package com.example.common.vo;

import lombok.Data;

@Data
public class Result<T> {
    private Integer code;
    private String message;
    private T data;
    
    public static <T> Result<T> success(T data) {
        Result<T> result = new Result<>();
        result.setCode(200);
        result.setMessage("success");
        result.setData(data);
        return result;
    }
}
```

### 6.3 构建运行

```bash
# 在父项目目录执行
mvn clean install

# 运行 Web 模块
cd user-web
mvn spring-boot:run
```

---

## 七、常见问题与解决

### 7.1 循环依赖

**问题：** 模块 A 依赖模块 B，模块 B 又依赖模块 A。

**解决：**
1. 重新设计模块结构
2. 提取公共部分到新模块
3. 使用接口解耦

### 7.2 依赖冲突

**解决步骤：**

```bash
# 1. 查看依赖树
mvn dependency:tree

# 2. 分析冲突
mvn dependency:tree -Dverbose

# 3. 排除冲突依赖
```

```xml
<dependency>
    <groupId>xxx</groupId>
    <artifactId>xxx</artifactId>
    <exclusions>
        <exclusion>
            <groupId>conflict-group</groupId>
            <artifactId>conflict-artifact</artifactId>
        </exclusion>
    </exclusions>
</dependency>
```

### 7.3 打包时排除文件

```xml
<build>
    <resources>
        <resource>
            <directory>src/main/resources</directory>
            <excludes>
                <exclude>**/*.properties</exclude>
            </excludes>
        </resource>
    </resources>
</build>
```

---

## 八、总结

✅ **本章学习内容：**
- 构建 Web 项目
- 构建 Spring Boot 项目
- 多模块项目开发
- 继承与聚合
- 版本管理最佳实践
- 实战案例

✅ **核心技能：**
- 能够使用 Maven 构建各种类型的项目
- 掌握多模块项目的组织和管理
- 理解继承和聚合的应用场景
- 掌握版本管理的最佳实践

**下一章预告：** 我们将学习 Maven 进阶技巧，包括插件开发、私服搭建等。
