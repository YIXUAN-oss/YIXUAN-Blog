# 数据库概念与介绍

> 本章将介绍数据库的基本概念、分类以及数据库设计的理论基础，为后续学习打下坚实的基础。

## 📋 本章目录

- [一、数据库基础概念](#一数据库基础概念)
- [二、关系型数据库 vs 非关系型数据库](#二关系型数据库-vs-非关系型数据库)
- [三、MySQL简介](#三mysql简介)
- [四、数据库核心术语](#四数据库核心术语)
- [五、数据库设计规范](#五数据库设计规范)
- [六、函数依赖理论](#六函数依赖理论)
- [七、关系连接](#七关系连接)
- [八、本章总结](#八本章总结)

---

## 一、数据库基础概念

### 1.1 什么是数据库？

**数据库（Database）** 是组织、存储、管理和访问数据的系统。它提供了一种结构化的方式来保存和检索信息，确保数据的安全性、一致性和完整性。

**数据库管理系统（DBMS）** 是用于创建和管理数据库的软件系统，如MySQL、Oracle、PostgreSQL等。

### 1.2 为什么需要数据库？

在没有数据库之前，数据通常存储在文件中，存在以下问题：

- ❌ **数据冗余**：同一数据在多个文件中重复存储
- ❌ **数据不一致**：多处存储的同一数据可能不同步
- ❌ **访问困难**：查询数据需要编写复杂的程序
- ❌ **并发控制难**：多用户同时访问容易出错
- ❌ **安全性差**：难以控制数据访问权限

数据库系统很好地解决了这些问题：

- ✅ **数据集中管理**：统一存储，减少冗余
- ✅ **数据一致性**：通过约束和事务保证数据准确
- ✅ **方便查询**：使用SQL语言简化数据操作
- ✅ **并发控制**：通过锁机制处理多用户访问
- ✅ **安全可靠**：提供权限控制和备份恢复机制

---

## 二、关系型数据库 vs 非关系型数据库

数据库主要分为两大类：**关系型数据库**和**非关系型数据库**。

### 2.1 关系型数据库（RDBMS）

**特点：**

- 📊 **表格存储**：使用表格形式存储数据，每个表由行和列组成
  - 行（Row）：代表一条数据记录
  - 列（Column）：代表数据的属性

- 🔗 **关系模型**：表与表之间通过外键建立关系

- 🛡️ **ACID特性**：支持事务，确保数据的一致性和完整性
  - **A**tomicity（原子性）
  - **C**onsistency（一致性）
  - **I**solation（隔离性）
  - **D**urability（持久性）

- 📝 **SQL标准**：使用结构化查询语言（SQL）进行数据操作

**代表产品：**
- MySQL
- PostgreSQL
- Oracle Database
- Microsoft SQL Server
- SQLite

**适用场景：**
- ✅ 需要复杂查询和事务管理
- ✅ 数据结构相对固定
- ✅ 需要强一致性保证
- ✅ 财务系统、订单系统、用户管理系统

### 2.2 非关系型数据库（NoSQL）

**特点：**

- 🗂️ **灵活存储**：采用键值对、文档、列族、图等多种存储方式

- 📈 **高扩展性**：易于水平扩展，适合分布式部署

- ⚡ **高性能**：针对大规模数据和高并发优化

- 🔄 **最终一致性**：通常采用最终一致性模型

**主要类型：**

1. **键值存储**：Redis、Memcached
2. **文档数据库**：MongoDB、CouchDB
3. **列族数据库**：Cassandra、HBase
4. **图数据库**：Neo4j、JanusGraph

**适用场景：**
- ✅ 大规模数据存储
- ✅ 高并发读写
- ✅ 数据结构灵活多变
- ✅ 缓存系统、日志系统、实时分析

### 2.3 如何选择？

| 对比项 | 关系型数据库 | 非关系型数据库 |
|--------|------------|--------------|
| **数据结构** | 结构化，固定schema | 灵活，动态schema |
| **扩展方式** | 垂直扩展（升级硬件） | 水平扩展（增加服务器） |
| **事务支持** | 完整的ACID支持 | 通常不支持或部分支持 |
| **查询能力** | 强大的SQL查询 | 查询能力相对较弱 |
| **一致性** | 强一致性 | 最终一致性 |
| **适用场景** | 传统业务系统 | 大数据、高并发场景 |

---

## 三、MySQL简介

### 3.1 什么是MySQL？

**MySQL** 是目前最流行的开源关系型数据库管理系统之一，由瑞典MySQL AB公司开发，现属于Oracle公司。

### 3.2 MySQL的特点

- 🆓 **开源免费**：社区版完全免费
- ⚡ **性能优秀**：查询速度快，适合高并发场景
- 🔧 **易于使用**：安装配置简单，学习曲线平缓
- 🌐 **跨平台**：支持Windows、Linux、macOS等多种操作系统
- 🔌 **丰富支持**：支持多种编程语言（PHP、Java、Python、C++等）
- 📦 **多种存储引擎**：InnoDB、MyISAM等，满足不同需求

### 3.3 MySQL版本

- **MySQL 5.7**：经典稳定版本，广泛应用
- **MySQL 8.0**：最新版本，性能提升，新增功能
  - 支持窗口函数
  - 支持通用表表达式（CTE）
  - JSON功能增强
  - 更好的性能和安全性

### 3.4 MySQL应用场景

- 🌐 Web应用程序（博客、电商、社交网络）
- 📱 移动应用后端
- 🎮 游戏服务器
- 📊 数据分析和报表系统
- 💼 企业管理系统（ERP、CRM）

---

## 四、数据库核心术语

理解这些核心术语是学习数据库的基础：

### 4.1 表（Table）

表是数据库中存储数据的基本单位，由行和列组成。

```
员工表（employees）示例：
+----+--------+-----+------------+
| id | name   | age | department |
+----+--------+-----+------------+
|  1 | 张三   |  28 | 技术部     |
|  2 | 李四   |  32 | 销售部     |
|  3 | 王五   |  25 | 技术部     |
+----+--------+-----+------------+
```

### 4.2 字段/列（Field/Column）

字段是表中的一列，代表一种属性。例如：`id`、`name`、`age`都是字段。

### 4.3 记录/行（Record/Row）

记录是表中的一行，包含一个实体的完整信息。例如：`1, 张三, 28, 技术部` 是一条记录。

### 4.4 主键（Primary Key）

主键用来唯一标识表中的每条记录，具有以下特点：

- ✅ 唯一性：每条记录的主键值必须唯一
- ✅ 非空性：主键值不能为NULL
- ✅ 不可变性：主键值一旦设定，通常不应修改

```sql
-- 定义主键
CREATE TABLE students (
    student_id INT PRIMARY KEY,  -- 主键
    name VARCHAR(50),
    age INT
);
```

### 4.5 外键（Foreign Key）

外键是一个表中的字段，它引用另一个表的主键，用于建立表之间的关系。

```sql
-- 订单表引用客户表
CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    order_date DATE,
    FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);
```

### 4.6 索引（Index）

索引是一种特殊的数据结构，用于加快数据检索速度，就像书籍的目录。

- 📈 提高查询效率
- 📉 增加写入开销
- 💾 占用额外存储空间

### 4.7 视图（View）

视图是从一个或多个表中导出的虚拟表，不存储实际数据，只保存查询逻辑。

```sql
-- 创建视图
CREATE VIEW employee_summary AS
SELECT name, age, department 
FROM employees 
WHERE age > 25;
```

### 4.8 触发器（Trigger）

触发器是在特定事件（INSERT、UPDATE、DELETE）发生时自动执行的SQL语句集合。

### 4.9 事务（Transaction）

事务是一组作为整体执行的数据库操作，要么全部成功，要么全部失败。

```sql
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;  -- 提交事务
```

### 4.10 存储过程（Stored Procedure）

存储过程是预编译的SQL语句集合，可以接受参数，执行复杂的业务逻辑。

---

## 五、数据库设计规范

### 5.1 数据库范式

数据库范式是设计关系型数据库时应遵循的规则，目的是减少数据冗余，提高数据一致性。

#### 第一范式（1NF）

**定义**：每个字段都不可再分，是原子性的。

❌ **不符合1NF的表**：
```
| 学号 | 姓名 | 联系方式              |
|------|------|-----------------------|
| 001  | 张三 | 13800138000, 北京市   |
```

✅ **符合1NF的表**：
```
| 学号 | 姓名 | 电话        | 地址   |
|------|------|-------------|--------|
| 001  | 张三 | 13800138000 | 北京市 |
```

#### 第二范式（2NF）

**定义**：在1NF基础上，非主属性完全依赖于主键（消除部分依赖）。

❌ **不符合2NF的表**（学号和课程号是联合主键）：
```
| 学号 | 课程号 | 姓名 | 课程名 | 成绩 |
|------|--------|------|--------|------|
```
问题：姓名只依赖于学号，课程名只依赖于课程号

✅ **符合2NF的设计**：
```
学生表：| 学号 | 姓名 |
课程表：| 课程号 | 课程名 |
成绩表：| 学号 | 课程号 | 成绩 |
```

#### 第三范式（3NF）

**定义**：在2NF基础上，非主属性不依赖于其他非主属性（消除传递依赖）。

❌ **不符合3NF的表**：
```
| 学号 | 姓名 | 系号 | 系名   |
|------|------|------|--------|
| 001  | 张三 | 01   | 计算机 |
```
问题：系名依赖于系号，而系号不是主键

✅ **符合3NF的设计**：
```
学生表：| 学号 | 姓名 | 系号 |
院系表：| 系号 | 系名 |
```

#### BCNF（Boyce-Codd范式）

**定义**：在3NF基础上，每个函数依赖的决定因素都包含键。

### 5.2 关系模式术语

- **关系模式**：对关系的逻辑结构和特征的描述
- **关系代数**：以关系作为运算对象的代数系统
- **元组**：关系中的一行（一条记录）
- **属性**：关系中的一列（一个字段）
- **主属性**：能唯一标识元组的属性
- **数据冗余**：同一数据在多处重复存储

---

## 六、函数依赖理论

### 6.1 什么是函数依赖？

在关系模式R中，如果属性X的值能唯一确定属性Y的值，则称Y函数依赖于X，记作：**X → Y**

**举例**：
- `学号 → 姓名`（学号确定，姓名就确定）
- `学号 → 专业`（学号确定，专业就确定）
- `(学号, 课程号) → 成绩`（学号和课程号共同确定成绩）

### 6.2 函数依赖的类型

#### 完全函数依赖

如果 X → Y，且不存在X的真子集X'使得X' → Y，则Y完全函数依赖于X。

**示例**：
```
(学号, 课程号) → 成绩  ✅ 完全依赖
不能通过单独的学号或课程号确定成绩
```

#### 部分函数依赖

如果 X → Y，但存在X的真子集X'使得X' → Y，则Y部分函数依赖于X。

**示例**：
```
(学号, 课程号) → 姓名  ❌ 部分依赖
因为：学号 → 姓名（只需学号就能确定姓名）
```

#### 传递函数依赖

如果 X → Y，Y → Z，则Z传递函数依赖于X。

**示例**：
```
学号 → 系号
系号 → 系主任
因此：学号 → 系主任（传递依赖）
```

### 6.3 函数依赖的性质（Armstrong公理）

1. **自反律**：如果 Y ⊆ X，则 X → Y
2. **增广律**：如果 X → Y，则 XZ → YZ
3. **传递律**：如果 X → Y 且 Y → Z，则 X → Z

---

## 七、关系连接

### 7.1 自然连接（Natural Join）

自然连接会自动根据两个表中的同名列进行匹配。

**示例**：

员工表（employees）：
```
| emp_id | name | dept_id |
|--------|------|---------|
| 1      | 张三 | 101     |
| 2      | 李四 | 102     |
```

部门表（departments）：
```
| dept_id | dept_name |
|---------|-----------|
| 101     | 技术部    |
| 102     | 销售部    |
```

自然连接结果：
```sql
SELECT * FROM employees NATURAL JOIN departments;
```

结果：
```
| emp_id | name | dept_id | dept_name |
|--------|------|---------|-----------|
| 1      | 张三 | 101     | 技术部    |
| 2      | 李四 | 102     | 销售部    |
```

**特点**：
- ✅ 自动匹配同名列
- ✅ 简化查询语句
- ⚠️ 需确保同名列含义相同

### 7.2 引用完整性

引用完整性通过外键约束实现，确保表之间关系的一致性。

**示例**：
```sql
CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    order_date DATE,
    FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
        ON DELETE CASCADE      -- 删除客户时，级联删除订单
        ON UPDATE CASCADE      -- 更新客户ID时，级联更新订单
);
```

**约束选项**：
- `CASCADE`：级联操作
- `SET NULL`：设置为NULL
- `RESTRICT`：限制删除/更新
- `NO ACTION`：不执行操作

---

## 八、本章总结

### 核心要点

1. **数据库分类**
   - 关系型数据库：结构化，ACID，适合传统业务
   - 非关系型数据库：灵活，高性能，适合大数据

2. **MySQL特点**
   - 开源免费、性能优秀、易于使用
   - 广泛应用于Web开发和企业系统

3. **核心术语**
   - 表、字段、记录
   - 主键、外键、索引
   - 视图、触发器、事务

4. **设计规范**
   - 遵循范式理论（1NF、2NF、3NF）
   - 理解函数依赖关系
   - 合理使用外键约束

### 学习建议

1. ✅ 理解数据库的基本概念和作用
2. ✅ 掌握关系型数据库的特点
3. ✅ 熟悉数据库核心术语
4. ✅ 学习数据库设计规范

### 下一步

在掌握了数据库的基础概念后，我们将在 **[第02章 - SQL基础语法](02-SQL基础语法.md)** 中学习如何使用SQL语句来操作数据库。

---

## 练习题

### 选择题

1. 以下哪个不是关系型数据库？
   - A. MySQL
   - B. MongoDB ✅
   - C. PostgreSQL
   - D. Oracle

2. ACID中的A代表什么？
   - A. Atomicity（原子性）✅
   - B. Availability（可用性）
   - C. Authentication（认证）
   - D. Authorization（授权）

### 思考题

1. 请解释为什么需要数据库范式？数据库范式的目的是什么？

2. 设计一个简单的图书管理系统，需要包含：图书、读者、借阅记录。请画出ER图并说明表之间的关系。

3. 什么情况下应该使用关系型数据库？什么情况下应该使用非关系型数据库？

---

**继续学习：[第02章 - SQL基础语法](02-SQL基础语法.md)** →
