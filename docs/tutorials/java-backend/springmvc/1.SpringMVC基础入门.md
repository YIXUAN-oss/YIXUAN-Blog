---
title: SpringMVC基础入门
---

# SpringMVC基础入门

## 一、Spring MVC是什么？

### 1.1 Spring MVC简介

**Spring MVC** 是 Spring 框架提供的一个基于 MVC 设计模式的 Web 框架，用于开发 Web 应用程序。

**核心特点：**
- 基于 MVC 设计模式
- 与 Spring 无缝集成
- 灵活的请求映射
- 强大的数据绑定
- 丰富的视图技术支持

### 1.2 为什么使用Spring MVC？

**对比 Servlet：**

**Servlet 开发：**
```java
@WebServlet("/user")
public class UserServlet extends HttpServlet {
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) {
        // 获取参数
        String name = req.getParameter("name");
        String age = req.getParameter("age");
        
        // 调用业务逻辑
        UserService service = new UserService();
        User user = service.getUser(name, Integer.parseInt(age));
        
        // 输出响应
        resp.setContentType("application/json;charset=UTF-8");
        resp.getWriter().write("{\"name\":\"" + user.getName() + "\"}");
    }
}
```

**Spring MVC 开发：**
```java
@RestController
@RequestMapping("/user")
public class UserController {
    
    @Autowired
    private UserService service;
    
    @GetMapping
    public User getUser(@RequestParam String name, @RequestParam Integer age) {
        return service.getUser(name, age);
    }
}
```

**优势：**
- ✅ 代码简洁，无需手动处理请求响应
- ✅ 自动参数绑定和类型转换
- ✅ 自动 JSON 转换
- ✅ 依赖注入
- ✅ 统一异常处理

---

## 二、MVC设计模式

### 2.1 MVC概念

**MVC（Model-View-Controller）** 是一种软件设计模式。

```
Model（模型）- 数据和业务逻辑
  ↓
View（视图）- 页面展示
  ↓
Controller（控制器）- 处理请求，协调 Model 和 View
```

### 2.2 传统MVC架构

```
浏览器
  ↓ 发送请求
Controller（接收请求）
  ↓ 调用
Service（业务逻辑）
  ↓ 调用
Dao（数据访问）
  ↓
数据库
  ↑ 返回数据
Controller
  ↓ 传递数据
View（JSP）
  ↓ 渲染页面
浏览器
```

### 2.3 前后端分离架构

```
前端（Vue/React）
  ↓ HTTP 请求
Controller（RESTful API）
  ↓ 返回 JSON
前端
  ↓ 渲染页面
```

---

## 三、Spring MVC执行流程

### 3.1 核心组件

| 组件 | 说明 |
|------|------|
| **DispatcherServlet** | 前端控制器，统一处理请求 |
| **HandlerMapping** | 处理器映射器，找到对应的 Handler |
| **HandlerAdapter** | 处理器适配器，执行 Handler |
| **Handler** | 处理器（Controller） |
| **ViewResolver** | 视图解析器 |
| **View** | 视图 |

### 3.2 执行流程图

```
1. 用户发送请求
   ↓
2. DispatcherServlet 接收请求
   ↓
3. HandlerMapping 查找处理器
   ↓ 返回 HandlerExecutionChain
4. DispatcherServlet 调用 HandlerAdapter
   ↓
5. HandlerAdapter 执行 Handler
   ↓ 返回 ModelAndView
6. DispatcherServlet 调用 ViewResolver
   ↓ 返回 View
7. View 渲染响应
   ↓
8. 返回给用户
```

### 3.3 详细流程

**步骤1-2：** 用户发送请求，DispatcherServlet 接收
```java
// DispatcherServlet 是前端控制器
// 所有请求都经过它统一处理
```

**步骤3：** HandlerMapping 查找处理器
```java
// 根据请求 URL 找到对应的 Controller 方法
// 例如：/user/list → UserController.list()
```

**步骤4-5：** HandlerAdapter 执行处理器
```java
@Controller
public class UserController {
    @RequestMapping("/user/list")
    public ModelAndView list() {
        ModelAndView mav = new ModelAndView();
        mav.addObject("users", userList);
        mav.setViewName("userList");
        return mav;
    }
}
```

**步骤6-7：** ViewResolver 解析视图并渲染
```xml
<!-- 视图解析器配置 -->
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/"/>
    <property name="suffix" value=".jsp"/>
</bean>

<!-- userList → /WEB-INF/views/userList.jsp -->
```

---

## 四、创建第一个Spring MVC项目

### 4.1 项目结构

```
springmvc-demo/
├── pom.xml
└── src/
    └── main/
        ├── java/
        │   └── com/example/
        │       └── controller/
        │           └── HelloController.java
        ├── resources/
        │   └── spring-mvc.xml
        └── webapp/
            ├── WEB-INF/
            │   ├── web.xml
            │   └── views/
            │       └── hello.jsp
            └── index.jsp
```

### 4.2 添加依赖

**pom.xml：**
```xml
<properties>
    <spring.version>5.3.30</spring.version>
</properties>

<dependencies>
    <!-- Spring MVC -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${spring.version}</version>
    </dependency>
    
    <!-- Servlet API -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>4.0.1</version>
        <scope>provided</scope>
    </dependency>
    
    <!-- JSP API -->
    <dependency>
        <groupId>javax.servlet.jsp</groupId>
        <artifactId>javax.servlet.jsp-api</artifactId>
        <version>2.3.3</version>
        <scope>provided</scope>
    </dependency>
    
    <!-- JSTL -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>
</dependencies>
```

### 4.3 配置DispatcherServlet

**web.xml：**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
         http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">
    
    <!-- 配置 DispatcherServlet -->
    <servlet>
        <servlet-name>dispatcherServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>classpath:spring-mvc.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    
    <servlet-mapping>
        <servlet-name>dispatcherServlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    
    <!-- 字符编码过滤器 -->
    <filter>
        <filter-name>encodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>encodingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
</web-app>
```

### 4.4 Spring MVC配置

**spring-mvc.xml：**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context.xsd
           http://www.springframework.org/schema/mvc
           http://www.springframework.org/schema/mvc/spring-mvc.xsd">
    
    <!-- 组件扫描 -->
    <context:component-scan base-package="com.example.controller"/>
    
    <!-- 注解驱动 -->
    <mvc:annotation-driven/>
    
    <!-- 视图解析器 -->
    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/WEB-INF/views/"/>
        <property name="suffix" value=".jsp"/>
    </bean>
    
    <!-- 静态资源处理 -->
    <mvc:default-servlet-handler/>
</beans>
```

### 4.5 创建Controller

**HelloController.java：**
```java
package com.example.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class HelloController {
    
    @RequestMapping("/hello")
    public ModelAndView hello() {
        ModelAndView mav = new ModelAndView();
        mav.addObject("message", "Hello, Spring MVC!");
        mav.setViewName("hello");
        return mav;
    }
}
```

### 4.6 创建视图

**hello.jsp：**
```jsp
<%@ page contentType="text/html;charset=UTF-8" %>
<!DOCTYPE html>
<html>
<head>
    <title>Hello Spring MVC</title>
</head>
<body>
    <h1>${message}</h1>
</body>
</html>
```

### 4.7 运行项目

```bash
mvn tomcat7:run

# 访问：http://localhost:8080/hello
```

---

## 五、@RequestMapping详解

### 5.1 基本用法

```java
@Controller
public class UserController {
    
    // 精确匹配
    @RequestMapping("/user")
    public String user() {
        return "user";
    }
    
    // 路径变量
    @RequestMapping("/user/{id}")
    public String getUser(@PathVariable Long id) {
        return "user";
    }
}
```

### 5.2 请求方法限定

```java
// 方式1：method 属性
@RequestMapping(value = "/user", method = RequestMethod.GET)
public String getUser() {
    return "user";
}

// 方式2：组合注解（推荐）
@GetMapping("/user")
public String getUser() {
    return "user";
}

@PostMapping("/user")
public String addUser() {
    return "success";
}

@PutMapping("/user")
public String updateUser() {
    return "success";
}

@DeleteMapping("/user/{id}")
public String deleteUser(@PathVariable Long id) {
    return "success";
}
```

### 5.3 类级别和方法级别

```java
@Controller
@RequestMapping("/user") // 类级别
public class UserController {
    
    @GetMapping("/list") // /user/list
    public String list() {
        return "userList";
    }
    
    @GetMapping("/{id}") // /user/{id}
    public String detail(@PathVariable Long id) {
        return "userDetail";
    }
}
```

### 5.4 请求参数限定

```java
// 必须包含 name 参数
@RequestMapping(value = "/user", params = "name")

// name 必须等于 admin
@RequestMapping(value = "/user", params = "name=admin")

// 必须包含 User-Agent 请求头
@RequestMapping(value = "/user", headers = "User-Agent")

// 只接受 JSON
@RequestMapping(value = "/user", consumes = "application/json")

// 只返回 JSON
@RequestMapping(value = "/user", produces = "application/json")
```

---

## 六、返回值类型

### 6.1 返回String（视图名称）

```java
@RequestMapping("/user/list")
public String list(Model model) {
    List<User> users = userService.findAll();
    model.addAttribute("users", users);
    return "userList"; // 返回视图名称
}
```

### 6.2 返回ModelAndView

```java
@RequestMapping("/user/list")
public ModelAndView list() {
    ModelAndView mav = new ModelAndView();
    mav.addObject("users", userService.findAll());
    mav.setViewName("userList");
    return mav;
}
```

### 6.3 返回void

```java
@RequestMapping("/user/add")
public void add(HttpServletResponse response) throws IOException {
    response.getWriter().write("success");
}
```

### 6.4 返回对象（JSON）

```java
@RequestMapping("/user/{id}")
@ResponseBody // 返回 JSON
public User getUser(@PathVariable Long id) {
    return userService.findById(id);
}

// 或使用 @RestController
@RestController
public class UserController {
    @GetMapping("/user/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
}
```

---

## 七、实战练习

### 7.1 用户CRUD

**UserController.java：**
```java
@Controller
@RequestMapping("/user")
public class UserController {
    
    @Autowired
    private UserService userService;
    
    // 列表
    @GetMapping("/list")
    public String list(Model model) {
        model.addAttribute("users", userService.findAll());
        return "userList";
    }
    
    // 详情
    @GetMapping("/{id}")
    public String detail(@PathVariable Long id, Model model) {
        model.addAttribute("user", userService.findById(id));
        return "userDetail";
    }
    
    // 添加页面
    @GetMapping("/add")
    public String addPage() {
        return "userAdd";
    }
    
    // 保存
    @PostMapping("/add")
    public String add(User user) {
        userService.save(user);
        return "redirect:/user/list";
    }
    
    // 删除
    @GetMapping("/delete/{id}")
    public String delete(@PathVariable Long id) {
        userService.deleteById(id);
        return "redirect:/user/list";
    }
}
```

---

## 八、总结

✅ **本章学习内容：**
- Spring MVC 的概念和优势
- MVC 设计模式
- Spring MVC 执行流程
- 创建第一个项目
- @RequestMapping 详解
- 返回值类型

✅ **核心要点：**
- 理解 MVC 设计模式
- 掌握 Spring MVC 执行流程
- 熟练使用 @RequestMapping
- 理解 DispatcherServlet 的作用

**下一章预告：** 我们将学习 Spring MVC 的核心技术。
