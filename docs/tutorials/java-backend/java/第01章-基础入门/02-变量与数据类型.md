# Java 变量与数据类型

> **本章重点：** 八大基本数据类型、类型转换、String类型转换
> 
> **面试频率：** ⭐⭐⭐⭐

---

## 目录
- [一、变量的基本概念](#一变量的基本概念)
- [二、Java数据类型](#二java数据类型)
- [三、简单类型与引用类型](#三简单类型与引用类型)
- [四、基本数据类型详解](#四基本数据类型详解)
- [五、类型转换](#五类型转换)
- [六、String类型转换](#六string类型转换)
- [七、运算符中的类型转换](#七运算符中的类型转换)

---

## 一、变量的基本概念

### 1.1 什么是变量

**变量：** 程序中可以变化的量，用于存储数据。

**变量三要素：**
1. **变量类型**：数据类型
2. **变量名**：标识符
3. **变量值**：存储的数据

### 1.2 变量的声明和使用

**语法：**
```java
数据类型 变量名 = 初始值;
```

**示例：**
```java
int age = 18;           // 整型变量
double salary = 8888.88; // 浮点型变量
String name = "张三";    // 字符串变量
boolean isStudent = true; // 布尔型变量
```

### 1.3 变量命名规范

**命名规则：**
1. 由字母、数字、下划线、$ 组成
2. 不能以数字开头
3. 不能使用关键字
4. 区分大小写

**命名建议：**
- 使用驼峰命名法：`userName`、`studentAge`
- 见名知义：`age` 而不是 `a`
- 常量使用大写：`MAX_VALUE`

---

## 二、Java数据类型

### 2.1 数据类型分类

```
Java数据类型
├── 基本数据类型（8种）
│   ├── 整型（4种）
│   │   ├── byte (1字节)
│   │   ├── short (2字节)
│   │   ├── int (4字节)
│   │   └── long (8字节)
│   ├── 浮点型（2种）
│   │   ├── float (4字节)
│   │   └── double (8字节)
│   ├── 字符型（1种）
│   │   └── char (2字节)
│   └── 布尔型（1种）
│       └── boolean (1字节)
└── 引用数据类型
    ├── 类（class）
    ├── 接口（interface）
    ├── 数组（array）
    └── 枚举（enum）
```

### 2.2 基本数据类型一览表

| 类型 | 字节数 | 位数 | 取值范围 | 默认值 | 包装类 |
|------|--------|------|----------|--------|--------|
| `byte` | 1 | 8 | -128 ~ 127 | 0 | Byte |
| `short` | 2 | 16 | -32768 ~ 32767 | 0 | Short |
| `int` | 4 | 32 | -2^31 ~ 2^31-1 | 0 | Integer |
| `long` | 8 | 64 | -2^63 ~ 2^63-1 | 0L | Long |
| `float` | 4 | 32 | ±3.4E+38 | 0.0f | Float |
| `double` | 8 | 64 | ±1.7E+308 | 0.0d | Double |
| `char` | 2 | 16 | 0 ~ 65535 | '\u0000' | Character |
| `boolean` | - | - | true/false | false | Boolean |

---

## 三、简单类型与引用类型

### 3.1 两种类型的区别

在Java中，数据类型分为两大类：**简单类型（基本类型）**和**引用类型**。理解这两种类型的区别对于掌握Java内存管理至关重要。

#### 简单类型（Primitive Types）

简单类型是直接包含值的数据类型，它们存储的是实际的数据而不是指向数据的引用。

**8种简单类型：**
- **整数类型**: `byte`, `short`, `int`, `long`
- **浮点类型**: `float`, `double`
- **字符类型**: `char`
- **布尔类型**: `boolean`

#### 引用类型（Reference Types）

引用类型存储的是对象的引用（地址），而不是对象本身。

**引用类型包括：**
- 类（Class）
- 接口（Interface）
- 数组（Array）
- 枚举（Enum）

### 3.2 核心区别对比

| 特性 | 简单类型 | 引用类型 |
|------|---------|----------|
| **存储内容** | 直接存储值 | 存储对象的引用（地址） |
| **存储位置** | 栈内存 | 对象在堆内存，引用在栈内存 |
| **内存大小** | 固定大小 | 动态大小 |
| **默认值** | 0、false、'\u0000' | null |
| **比较方式** | 使用 `==` 比较值 | `==` 比较引用，`equals()` 比较内容 |
| **传递方式** | 值传递（副本） | 值传递（引用的副本） |

### 3.3 代码示例

```java
// 简单类型示例
int a = 10;
int b = a;      // b获得a的值的一个副本
b = 20;         // 修改b不会影响a
System.out.println("a = " + a);  // 10
System.out.println("b = " + b);  // 20

// 引用类型示例
StringBuilder sb1 = new StringBuilder("Hello");
StringBuilder sb2 = sb1;  // sb2获得sb1引用的对象
sb2.append(" World");     // 修改sb2也会影响sb1
System.out.println("sb1 = " + sb1);  // Hello World
System.out.println("sb2 = " + sb2);  // Hello World
```

### 3.4 值传递机制

**重要：Java中只有值传递，没有引用传递！**

- **简单类型**：传递的是值的副本
- **引用类型**：传递的是引用的副本（地址值的副本）

```java
public class PassByValueDemo {
    public static void main(String[] args) {
        // 简单类型
        int num = 10;
        changeValue(num);
        System.out.println("num = " + num);  // 10（未改变）
        
        // 引用类型
        StringBuilder sb = new StringBuilder("Hello");
        changeReference(sb);
        System.out.println("sb = " + sb);    // Hello World（已改变）
        
        // 引用类型 - 改变引用本身
        StringBuilder sb2 = new StringBuilder("Hello");
        reassignReference(sb2);
        System.out.println("sb2 = " + sb2);  // Hello（未改变）
    }
    
    // 简单类型：传递值的副本
    static void changeValue(int n) {
        n = 20;  // 只改变副本，不影响原变量
    }
    
    // 引用类型：传递引用的副本，可以修改对象内容
    static void changeReference(StringBuilder s) {
        s.append(" World");  // 通过引用修改对象
    }
    
    // 引用类型：重新赋值不影响原引用
    static void reassignReference(StringBuilder s) {
        s = new StringBuilder("New");  // 只改变副本引用
    }
}
```

### 3.5 常见误区

**❌ 错误理解：**
- Java有引用传递
- 引用类型传递的是对象本身

**✅ 正确理解：**
- Java只有值传递
- 引用类型传递的是引用的副本（地址值的副本）
- 通过引用的副本可以修改对象内容，但不能改变原引用指向

---

## 四、基本数据类型详解

### 4.1 整数类型

#### 四种整型对比

| 类型 | 字节 | 取值范围 | 说明 |
|------|------|----------|------|
| `byte` | 1 | -128 ~ 127 | 节省空间，用于大量数据 |
| `short` | 2 | -32768 ~ 32767 | 较少使用 |
| `int` | 4 | -2147483648 ~ 2147483647 | **最常用** |
| `long` | 8 | -9223372036854775808 ~ 9223372036854775807 | 超大整数 |

#### 整型使用细节

**1. Java 整型常量默认为 int 型**
```java
int n1 = 1;        // ✅ 正确
long n2 = 1;       // ✅ 正确（自动转换）
long n3 = 1L;      // ✅ 正确（推荐）
```

**2. 声明 long 型常量需要加 L 或 l**
```java
long n1 = 9999999999;   // ❌ 错误：超出 int 范围
long n2 = 9999999999L;  // ✅ 正确
```

**3. 不同进制表示**
```java
int n1 = 100;      // 十进制
int n2 = 0b1100100;// 二进制（0b开头）
int n3 = 0144;     // 八进制（0开头）
int n4 = 0x64;     // 十六进制（0x开头）
```

---

### 4.2 浮点类型

#### 两种浮点型对比

| 类型 | 字节 | 精度 | 取值范围 | 说明 |
|------|------|------|----------|------|
| `float` | 4 | 7位 | ±3.4E+38 | 单精度 |
| `double` | 8 | 15位 | ±1.7E+308 | **双精度（推荐）** |

#### 浮点型使用细节

**1. Java 浮点型常量默认为 double 型**
```java
float f1 = 1.1;     // ❌ 错误：不能将 double 赋给 float
float f2 = 1.1f;    // ✅ 正确（加 f 或 F）
double d1 = 1.1;    // ✅ 正确
```

**2. 浮点数表示形式**
```java
double d1 = 5.12;           // 十进制
double d2 = 5.12e2;         // 科学计数法（512.0）
double d3 = 5.12E-2;        // 科学计数法（0.0512）
```

**3. 浮点数使用陷阱**
```java
double d1 = 8.1 / 3;
System.out.println(d1);     // 2.6999999999999997（精度问题）

// 比较浮点数是否相等
double d2 = 8.1 / 3;
double d3 = 2.7;
if (Math.abs(d2 - d3) < 0.000001) {  // 使用差值比较
    System.out.println("相等");
}
```

**重要提示：** 如果需要精确计算（如金额），使用 `BigDecimal` 类！

---

### 4.3 字符类型（char）

#### 字符类型特点

- 用单引号 `''` 表示
- 只能存放单个字符
- 占 2 个字节（可以存储中文字符）
- 本质是整数（Unicode 编码）

#### 字符表示方式

**1. 普通字符**
```java
char c1 = 'a';      // 英文字符
char c2 = '中';     // 中文字符
char c3 = '9';      // 数字字符
```

**2. 转义字符**
```java
char c1 = '\n';     // 换行
char c2 = '\t';     // 制表符
char c3 = '\\';     // 反斜杠
char c4 = '\'';     // 单引号
char c5 = '\"';     // 双引号
```

**3. Unicode 编码**
```java
char c1 = '\u0061'; // 'a' 的 Unicode 编码
char c2 = '\u4e2d'; // '中' 的 Unicode 编码
System.out.println(c1);  // a
System.out.println(c2);  // 中
```

**4. ASCII 码表示**
```java
char c1 = 97;       // ASCII 码 97 对应 'a'
System.out.println(c1);  // a
```

#### 字符运算

```java
char c1 = 'a';
int n1 = c1;                // 字符可以自动转为 int
System.out.println(n1);     // 97

char c2 = 'a' + 1;          // 98 -> 'b'
System.out.println(c2);     // b
```

---

### 4.4 布尔类型（boolean）

**特点：**
- 只有两个值：`true` 和 `false`
- 不能用 0 或非 0 表示（不同于 C 语言）
- 常用于条件判断和循环控制

**示例：**
```java
boolean b1 = true;
boolean b2 = false;

if (b1) {
    System.out.println("b1 是 true");
}

boolean isPass = 85 >= 60;  // 条件表达式的结果
System.out.println(isPass);  // true
```

**❌ 错误用法：**
```java
boolean b1 = 1;     // ❌ 错误：不能用整数
boolean b2 = 0;     // ❌ 错误：不能用整数
if (1) { }          // ❌ 错误：条件必须是 boolean
```

---

## 五、类型转换

### 5.1 自动类型转换（隐式转换）

**定义：** 将容量小的类型自动转换为容量大的类型。

**转换路径：**
```
byte → short → int → long → float → double
       char  →
```

**示例：**
```java
int n1 = 100;
double d1 = n1;     // 自动转换：int → double
System.out.println(d1);  // 100.0

char c1 = 'a';
int n2 = c1;        // 自动转换：char → int
System.out.println(n2);  // 97

byte b1 = 10;
int n3 = b1;        // 自动转换：byte → int
```

### 5.2 自动类型转换的细节

**1. 多种类型混合运算，自动转换为容量最大的类型**
```java
int n1 = 10;
double d1 = 1.1;
double d2 = n1 + d1;    // int → double，结果为 double
System.out.println(d2);  // 11.1
```

**2. byte、short、char 之间不能相互自动转换**
```java
byte b1 = 10;
short s1 = b1;      // ❌ 错误：不能自动转换
short s2 = (short) b1;  // ✅ 正确：需要强制转换
```

**3. byte、short、char 三者在计算时首先转换为 int**
```java
byte b1 = 10;
byte b2 = 20;
byte b3 = b1 + b2;  // ❌ 错误：b1 + b2 的结果是 int
int n1 = b1 + b2;   // ✅ 正确
```

**4. boolean 不参与类型转换**
```java
boolean b1 = true;
int n1 = b1;        // ❌ 错误：boolean 不能转换为其他类型
```

---

### 5.3 强制类型转换（显式转换）

**定义：** 将容量大的类型转换为容量小的类型（可能损失精度）。

**语法：**
```java
目标类型 变量名 = (目标类型) 原值;
```

**示例：**
```java
// 1. double → int（丢失小数部分）
int n1 = (int) 1.9;
System.out.println(n1);  // 1

// 2. int → byte（可能溢出）
int n2 = 300;
byte b1 = (byte) n2;
System.out.println(b1);  // 44（发生溢出）

// 3. 字符运算
int n3 = 100;
char c1 = (char) n3;
System.out.println(c1);  // d
```

### 5.4 强制类型转换的细节

**1. 精度降低**
```java
double d1 = 3.14;
int n1 = (int) d1;
System.out.println(n1);  // 3（小数部分丢失）
```

**2. 溢出**
```java
int n1 = 128;
byte b1 = (byte) n1;
System.out.println(b1);  // -128（溢出）
```

**3. 强制转换只对最近的操作数有效**
```java
int n1 = (int) 10 * 3.5 + 6 * 1.5;  // ❌ 错误：编译错误
int n2 = (int) (10 * 3.5 + 6 * 1.5);  // ✅ 正确：结果为 44
```

---

## 六、String类型转换

### 6.1 基本类型转 String

**方式一：使用 + 号（推荐）**
```java
int n1 = 100;
String s1 = n1 + "";
System.out.println(s1);  // "100"

double d1 = 3.14;
String s2 = d1 + "";
System.out.println(s2);  // "3.14"

boolean b1 = true;
String s3 = b1 + "";
System.out.println(s3);  // "true"
```

**方式二：使用 String.valueOf()**
```java
int n1 = 100;
String s1 = String.valueOf(n1);

double d1 = 3.14;
String s2 = String.valueOf(d1);

boolean b1 = true;
String s3 = String.valueOf(b1);
```

### 6.2 String 转基本类型

**使用包装类的 parseXxx() 方法：**
```java
// String → int
String s1 = "123";
int n1 = Integer.parseInt(s1);
System.out.println(n1);  // 123

// String → double
String s2 = "3.14";
double d1 = Double.parseDouble(s2);
System.out.println(d1);  // 3.14

// String → boolean
String s3 = "true";
boolean b1 = Boolean.parseBoolean(s3);
System.out.println(b1);  // true

// String → long
String s4 = "9999999999";
long l1 = Long.parseLong(s4);
System.out.println(l1);  // 9999999999
```

### 6.3 String 转 char

**使用 charAt() 方法：**
```java
String s = "hello";
char c1 = s.charAt(0);  // 获取第一个字符
System.out.println(c1);  // h

char c2 = s.charAt(4);  // 获取第五个字符
System.out.println(c2);  // o
```

### 6.4 注意事项

**1. 字符串必须能转换为有效数据**
```java
String s1 = "123";
int n1 = Integer.parseInt(s1);  // ✅ 正确

String s2 = "hello";
int n2 = Integer.parseInt(s2);  // ❌ 运行时错误：NumberFormatException
```

**2. 空字符串和null的处理**
```java
String s1 = "";
int n1 = Integer.parseInt(s1);  // ❌ NumberFormatException

String s2 = null;
int n2 = Integer.parseInt(s2);  // ❌ NullPointerException
```

---

## 七、运算符中的类型转换

### 7.1 + 号的作用

**1. 数值相加**
```java
System.out.println(100 + 98);  // 198
```

**2. 字符串连接**
```java
System.out.println("100" + 98);  // "10098"
```

**3. 混合运算（从左到右）**
```java
System.out.println(100 + 3 + "hello");  // "103hello"
System.out.println("hello" + 100 + 3);  // "hello1003"
```

### 7.2 运算中的自动转换

**示例：**
```java
byte b1 = 10;
byte b2 = 20;
// byte b3 = b1 + b2;  // ❌ 错误：结果是 int
int n1 = b1 + b2;      // ✅ 正确

short s1 = 100;
int n2 = 200;
// short s2 = s1 + n2; // ❌ 错误：结果是 int
int n3 = s1 + n2;      // ✅ 正确
```

---

## 📚 快速记忆

**1. 八大基本类型：**
- 整型：byte、short、int、long
- 浮点：float、double
- 字符：char
- 布尔：boolean

**2. 类型转换规则：**
- 小→大：自动转换
- 大→小：强制转换（可能损失精度）

**3. String 转换：**
- 基本类型 → String：`值 + ""`
- String → 基本类型：`包装类.parseXxx()`

**4. 运算中的注意：**
- byte、short、char 运算结果都是 int
- 有 double 参与运算，结果是 double

---

**上一章：** [开发环境与工具](01-开发环境与工具.md)

**下一章：** [运算符](03-运算符.md) →
