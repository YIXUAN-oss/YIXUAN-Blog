---
title: Nacos注册配置中心
---

# Nacos注册配置中心

## 一、Nacos简介

### 1.1 什么是Nacos？

**Nacos**（Dynamic Naming and Configuration Service）是阿里巴巴开源的服务注册与配置中心。

**功能：**
- 服务注册与发现
- 配置管理
- 服务健康检查

**官网：** https://nacos.io/

### 1.2 Nacos vs Eureka

| 特性 | Eureka | Nacos |
|------|--------|-------|
| **功能** | 注册中心 | 注册 + 配置 |
| **CAP** | AP | AP + CP |
| **维护** | 停更 | 活跃 |
| **推荐** | ★★★ | ★★★★★ |

---

## 二、安装Nacos

### 2.1 下载

访问：https://github.com/alibaba/nacos/releases

### 2.2 启动

```bash
# Windows
startup.cmd -m standalone

# Linux/Mac
sh startup.sh -m standalone
```

### 2.3 访问控制台

```
URL: http://localhost:8848/nacos
用户名: nacos
密码: nacos
```

---

## 三、服务注册

### 3.1 添加依赖

```xml
<dependency>
    <groupId>com.alibaba.cloud</groupId>
    <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
    <version>2021.0.5.0</version>
</dependency>
```

### 3.2 配置文件

**application.yml：**
```yaml
server:
  port: 8001

spring:
  application:
    name: user-service
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
        namespace: public  # 命名空间
        group: DEFAULT_GROUP  # 分组
```

### 3.3 启动类

```java
@SpringBootApplication
@EnableDiscoveryClient  // 启用服务发现
public class UserServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(UserServiceApplication.class, args);
    }
}
```

---

## 四、配置管理

### 4.1 添加依赖

```xml
<dependency>
    <groupId>com.alibaba.cloud</groupId>
    <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
    <version>2021.0.5.0</version>
</dependency>
```

### 4.2 配置文件

**bootstrap.yml：**
```yaml
spring:
  application:
    name: user-service
  cloud:
    nacos:
      config:
        server-addr: localhost:8848
        file-extension: yaml
        namespace: public
        group: DEFAULT_GROUP
```

### 4.3 Nacos控制台配置

**Data ID：** user-service.yaml

**配置内容：**
```yaml
config:
  info: "Hello Nacos Config"
```

### 4.4 使用配置

```java
@RestController
@RefreshScope  // 动态刷新
public class ConfigController {
    
    @Value("${config.info}")
    private String configInfo;
    
    @GetMapping("/config")
    public String getConfig() {
        return configInfo;
    }
}
```

---

## 五、命名空间

### 5.1 创建命名空间

在 Nacos 控制台创建命名空间：
- 开发环境（dev）
- 测试环境（test）
- 生产环境（prod）

### 5.2 配置使用

```yaml
spring:
  cloud:
    nacos:
      discovery:
        namespace: dev  # 使用dev命名空间
      config:
        namespace: dev
```

---

## 六、配置共享

### 6.1 shared-configs

```yaml
spring:
  cloud:
    nacos:
      config:
        shared-configs:
          - data-id: common.yaml
            group: DEFAULT_GROUP
            refresh: true
```

### 6.2 extension-configs

```yaml
spring:
  cloud:
    nacos:
      config:
        extension-configs:
          - data-id: redis.yaml
            group: DEFAULT_GROUP
            refresh: true
```

---

## 七、总结

✅ **本章学习内容：**
- Nacos 简介
- 安装启动
- 服务注册发现
- 配置管理
- 命名空间
- 配置共享

✅ **核心要点：**
- Nacos 功能更强大
- 支持注册和配置
- 推荐使用 Nacos

**下一章预告：** 我们将学习 Sentinel 熔断限流。
