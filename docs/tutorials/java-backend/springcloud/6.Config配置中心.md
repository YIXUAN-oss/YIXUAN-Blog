---
title: Config配置中心
---

# Config配置中心

## 一、配置中心概述

### 1.1 为什么需要配置中心？

**传统方式：**
- 配置写在 application.yml
- 修改配置需要重启
- 多环境配置管理困难

**配置中心：**
- 集中管理配置
- 动态刷新配置
- 多环境配置

### 1.2 Config简介

**Spring Cloud Config** 提供分布式配置管理功能。

**组件：**
- **Config Server**：配置服务端
- **Config Client**：配置客户端

---

## 二、搭建Config Server

### 2.1 创建模块

**pom.xml：**
```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-config-server</artifactId>
    </dependency>
</dependencies>
```

### 2.2 配置文件

**application.yml：**
```yaml
server:
  port: 8888

spring:
  application:
    name: config-server
  cloud:
    config:
      server:
        git:
          uri: https://github.com/xxx/config-repo
          search-paths: config
          default-label: main
```

### 2.3 启动类

```java
@SpringBootApplication
@EnableConfigServer  // 启用 Config Server
public class ConfigServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(ConfigServerApplication.class, args);
    }
}
```

---

## 三、配置Config Client

### 3.1 添加依赖

```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-config</artifactId>
</dependency>
```

### 3.2 配置文件

**bootstrap.yml：**
```yaml
spring:
  application:
    name: user-service
  cloud:
    config:
      uri: http://localhost:8888
      profile: dev
      label: main
```

---

## 四、动态刷新

### 4.1 添加依赖

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

### 4.2 配置

```yaml
management:
  endpoints:
    web:
      exposure:
        include: refresh
```

### 4.3 使用@RefreshScope

```java
@RestController
@RefreshScope  // 支持动态刷新
public class ConfigController {
    
    @Value("${config.info}")
    private String configInfo;
    
    @GetMapping("/config")
    public String getConfig() {
        return configInfo;
    }
}
```

### 4.4 手动刷新

```bash
POST http://localhost:8001/actuator/refresh
```

---

## 五、总结

✅ **本章学习内容：**
- 配置中心概述
- Config Server 搭建
- Config Client 配置
- 动态刷新

✅ **核心要点：**
- 集中管理配置
- 支持动态刷新
- 支持多环境

**下一章预告：** 我们将学习 Nacos 注册配置中心。
