---
title: 条件构造器
---

# 条件构造器

## 一、Wrapper概述

### 1.1 Wrapper继承关系

```
AbstractWrapper
├── QueryWrapper        // 普通查询
├── UpdateWrapper       // 普通更新
├── LambdaQueryWrapper  // Lambda查询
└── LambdaUpdateWrapper // Lambda更新
```

### 1.2 Wrapper类型

| 类型 | 说明 | 推荐 |
|------|------|------|
| QueryWrapper | 普通查询 | ★★★ |
| UpdateWrapper | 普通更新 | ★★★ |
| LambdaQueryWrapper | Lambda查询 | ★★★★★ |
| LambdaUpdateWrapper | Lambda更新 | ★★★★★ |

**推荐使用 Lambda 方式，避免字段名写错。**

---

## 二、QueryWrapper

### 2.1 基本查询

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();
wrapper.eq("username", "张三");
List<User> users = userMapper.selectList(wrapper);
// SQL: SELECT * FROM user WHERE username = '张三'
```

### 2.2 比较操作

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();

// 等于
wrapper.eq("age", 20);
// SQL: age = 20

// 不等于
wrapper.ne("age", 20);
// SQL: age != 20

// 大于
wrapper.gt("age", 20);
// SQL: age > 20

// 大于等于
wrapper.ge("age", 20);
// SQL: age >= 20

// 小于
wrapper.lt("age", 20);
// SQL: age < 20

// 小于等于
wrapper.le("age", 20);
// SQL: age <= 20

// BETWEEN
wrapper.between("age", 20, 30);
// SQL: age BETWEEN 20 AND 30

// NOT BETWEEN
wrapper.notBetween("age", 20, 30);
// SQL: age NOT BETWEEN 20 AND 30
```

### 2.3 模糊查询

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();

// LIKE '%值%'
wrapper.like("username", "张");
// SQL: username LIKE '%张%'

// NOT LIKE '%值%'
wrapper.notLike("username", "张");
// SQL: username NOT LIKE '%张%'

// LIKE '值%'
wrapper.likeLeft("username", "张");
// SQL: username LIKE '%张'

// LIKE '%值'
wrapper.likeRight("username", "张");
// SQL: username LIKE '张%'
```

### 2.4 NULL值查询

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();

// IS NULL
wrapper.isNull("email");
// SQL: email IS NULL

// IS NOT NULL
wrapper.isNotNull("email");
// SQL: email IS NOT NULL
```

### 2.5 IN查询

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();

// IN
wrapper.in("id", Arrays.asList(1, 2, 3));
// SQL: id IN (1, 2, 3)

// NOT IN
wrapper.notIn("id", Arrays.asList(1, 2, 3));
// SQL: id NOT IN (1, 2, 3)
```

### 2.6 分组和排序

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();

// GROUP BY
wrapper.groupBy("age");
// SQL: GROUP BY age

// HAVING
wrapper.groupBy("age").having("count(*) > 1");
// SQL: GROUP BY age HAVING count(*) > 1

// ORDER BY ASC
wrapper.orderByAsc("age");
// SQL: ORDER BY age ASC

// ORDER BY DESC
wrapper.orderByDesc("create_time");
// SQL: ORDER BY create_time DESC

// 多字段排序
wrapper.orderByAsc("age").orderByDesc("create_time");
// SQL: ORDER BY age ASC, create_time DESC
```

### 2.7 OR连接

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();

// AND连接（默认）
wrapper.eq("age", 20).eq("username", "张三");
// SQL: age = 20 AND username = '张三'

// OR连接
wrapper.eq("age", 20).or().eq("age", 30);
// SQL: age = 20 OR age = 30

// 嵌套OR
wrapper.eq("username", "张三")
       .or(w -> w.eq("age", 20).eq("email", "test@example.com"));
// SQL: username = '张三' OR (age = 20 AND email = 'test@example.com')
```

### 2.8 SELECT指定字段

```java
QueryWrapper<User> wrapper = new QueryWrapper<>();
wrapper.select("id", "username", "age");
List<User> users = userMapper.selectList(wrapper);
// SQL: SELECT id, username, age FROM user
```

---

## 三、LambdaQueryWrapper（推荐）

### 3.1 基本使用

```java
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getUsername, "张三");
List<User> users = userMapper.selectList(wrapper);
```

**优点：**
- 类型安全
- 编译期检查
- 支持IDE提示
- 重构友好

### 3.2 常用方法

```java
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();

// 等于
wrapper.eq(User::getAge, 20);

// 不等于
wrapper.ne(User::getAge, 20);

// 大于
wrapper.gt(User::getAge, 20);

// LIKE
wrapper.like(User::getUsername, "张");

// IN
wrapper.in(User::getId, Arrays.asList(1, 2, 3));

// IS NULL
wrapper.isNull(User::getEmail);

// 排序
wrapper.orderByAsc(User::getAge);

// SELECT指定字段
wrapper.select(User::getId, User::getUsername);
```

### 3.3 复杂查询

```java
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.like(User::getUsername, "张")
       .gt(User::getAge, 20)
       .isNotNull(User::getEmail)
       .orderByDesc(User::getCreateTime);

List<User> users = userMapper.selectList(wrapper);
```

---

## 四、UpdateWrapper

### 4.1 基本更新

```java
UpdateWrapper<User> wrapper = new UpdateWrapper<>();
wrapper.set("age", 30)
       .eq("username", "张三");
userMapper.update(null, wrapper);
// SQL: UPDATE user SET age = 30 WHERE username = '张三'
```

### 4.2 批量更新

```java
UpdateWrapper<User> wrapper = new UpdateWrapper<>();
wrapper.set("age", 30)
       .in("id", Arrays.asList(1, 2, 3));
userMapper.update(null, wrapper);
// SQL: UPDATE user SET age = 30 WHERE id IN (1, 2, 3)
```

---

## 五、LambdaUpdateWrapper（推荐）

### 5.1 基本使用

```java
LambdaUpdateWrapper<User> wrapper = new LambdaUpdateWrapper<>();
wrapper.set(User::getAge, 30)
       .eq(User::getUsername, "张三");
userMapper.update(null, wrapper);
```

### 5.2 复杂更新

```java
LambdaUpdateWrapper<User> wrapper = new LambdaUpdateWrapper<>();
wrapper.set(User::getAge, 30)
       .set(User::getEmail, "new@example.com")
       .eq(User::getUsername, "张三")
       .gt(User::getAge, 18);
userMapper.update(null, wrapper);
```

---

## 六、动态条件

### 6.1 condition参数

```java
String username = "张三";
Integer minAge = 20;
Integer maxAge = null;

LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(username != null, User::getUsername, username)
       .ge(minAge != null, User::getAge, minAge)
       .le(maxAge != null, User::getAge, maxAge);

// 只会添加非null的条件
```

### 6.2 实战案例

```java
public List<User> search(String username, Integer minAge, Integer maxAge) {
    LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
    wrapper.like(StringUtils.isNotBlank(username), User::getUsername, username)
           .ge(minAge != null, User::getAge, minAge)
           .le(maxAge != null, User::getAge, maxAge)
           .orderByDesc(User::getCreateTime);
    
    return userMapper.selectList(wrapper);
}
```

---

## 七、总结

✅ **本章学习内容：**
- QueryWrapper 普通查询
- UpdateWrapper 普通更新
- LambdaQueryWrapper Lambda查询
- LambdaUpdateWrapper Lambda更新
- 动态条件构造

✅ **核心要点：**
- 推荐使用 Lambda 方式
- condition 参数实现动态条件
- 链式调用更简洁

**下一章预告：** 我们将学习代码生成器。
