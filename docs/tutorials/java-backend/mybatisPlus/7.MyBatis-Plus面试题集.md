---
title: MyBatis-Plusé¢è¯•é¢˜é›†
---

# MyBatis-Plusé¢è¯•é¢˜é›†

## ä¸€ã€åŸºç¡€æ¦‚å¿µ

### 1. ä»€ä¹ˆæ˜¯MyBatis-Plusï¼Ÿ

**ç­”ï¼š**

MyBatis-Plusï¼ˆç®€ç§° MPï¼‰æ˜¯ä¸€ä¸ª MyBatis çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- æ— ä¾µå…¥ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜
- æŸè€—å°ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CRUD
- å¼ºå¤§çš„ CRUD æ“ä½œ
- æ”¯æŒ Lambda å½¢å¼è°ƒç”¨
- å†…ç½®ä»£ç ç”Ÿæˆå™¨
- å†…ç½®åˆ†é¡µæ’ä»¶
- æ”¯æŒå¤šç§æ•°æ®åº“

**å®˜ç½‘ï¼š** https://baomidou.com/

---

### 2. MyBatis-Pluså’ŒMyBatisçš„åŒºåˆ«ï¼Ÿ

**ç­”ï¼š**

| ç‰¹æ€§ | MyBatis | MyBatis-Plus |
|------|---------|--------------|
| **XMLæ–‡ä»¶** | å¿…éœ€ | å¯é€‰ |
| **CRUDæ–¹æ³•** | éœ€æ‰‹å†™ | è‡ªåŠ¨æä¾› |
| **ä»£ç é‡** | å¤š | å°‘ |
| **å¼€å‘æ•ˆç‡** | ä¸­ | é«˜ |
| **åˆ†é¡µ** | éœ€æ’ä»¶ | å†…ç½®æ’ä»¶ |
| **ä»£ç ç”Ÿæˆ** | éœ€é…ç½® | ä¸€é”®ç”Ÿæˆ |

**æ ¸å¿ƒä¼˜åŠ¿ï¼š**
- å‡å°‘ 80% çš„ä»£ç é‡
- ä¿ç•™ MyBatis çš„çµæ´»æ€§
- æä¾›å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨

---

### 3. MyBatis-Plusä¼šä¾µå…¥MyBatiså—ï¼Ÿ

**ç­”ï¼š**

**ä¸ä¼šã€‚** MyBatis-Plus åªæ˜¯å¢å¼ºå·¥å…·ï¼Œä¸ä¿®æ”¹ MyBatis æ ¸å¿ƒåŠŸèƒ½ã€‚

**åŸå› ï¼š**
- é€šè¿‡ BaseMapper æä¾›é€šç”¨æ–¹æ³•
- é€šè¿‡ SQL æ³¨å…¥å™¨æ³¨å…¥æ–¹æ³•
- ä¸å½±å“åŸæœ‰ MyBatis åŠŸèƒ½
- å¯ä»¥å’Œ MyBatis æ··ç”¨

---

## äºŒã€CRUDæ¥å£

### 4. BaseMapperæä¾›äº†å“ªäº›æ–¹æ³•ï¼Ÿ

**ç­”ï¼š**

**Insertï¼š**
- `int insert(T entity)`

**Deleteï¼š**
- `int deleteById(Serializable id)`
- `int deleteBatchIds(Collection<? extends Serializable> idList)`
- `int delete(Wrapper<T> wrapper)`
- `int deleteByMap(Map<String, Object> columnMap)`

**Updateï¼š**
- `int updateById(T entity)`
- `int update(T entity, Wrapper<T> updateWrapper)`

**Selectï¼š**
- `T selectById(Serializable id)`
- `List<T> selectBatchIds(Collection<? extends Serializable> idList)`
- `List<T> selectList(Wrapper<T> queryWrapper)`
- `Long selectCount(Wrapper<T> queryWrapper)`
- `IPage<T> selectPage(IPage<T> page, Wrapper<T> queryWrapper)`

---

### 5. Serviceå±‚å’ŒMapperå±‚æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**ç­”ï¼š**

**Mapperå±‚ï¼ˆBaseMapperï¼‰ï¼š**
- åŸºç¡€ CRUD æ–¹æ³•
- å•è¡¨æ“ä½œ
- æ–¹æ³•å°‘

**Serviceå±‚ï¼ˆIServiceï¼‰ï¼š**
- æ›´å¤š CRUD æ–¹æ³•
- æ‰¹é‡æ“ä½œ
- é“¾å¼è°ƒç”¨
- æ›´é«˜çº§çš„åŠŸèƒ½

**ç¤ºä¾‹ï¼š**
```java
// Mapperå±‚
userMapper.insert(user);

// Serviceå±‚
userService.save(user);              // ä¿å­˜
userService.saveBatch(users);        // æ‰¹é‡ä¿å­˜
userService.saveOrUpdate(user);      // ä¿å­˜æˆ–æ›´æ–°
```

---

## ä¸‰ã€æ¡ä»¶æ„é€ å™¨

### 6. Wrapperæœ‰å“ªå‡ ç§ï¼Ÿ

**ç­”ï¼š**

| ç±»å‹ | è¯´æ˜ | æ¨èåº¦ |
|------|------|--------|
| QueryWrapper | æ™®é€šæŸ¥è¯¢ | â˜…â˜…â˜… |
| UpdateWrapper | æ™®é€šæ›´æ–° | â˜…â˜…â˜… |
| LambdaQueryWrapper | LambdaæŸ¥è¯¢ | â˜…â˜…â˜…â˜…â˜… |
| LambdaUpdateWrapper | Lambdaæ›´æ–° | â˜…â˜…â˜…â˜…â˜… |

**æ¨èä½¿ç”¨ Lambda æ–¹å¼ï¼š**
```java
// æ™®é€šæ–¹å¼
QueryWrapper<User> wrapper = new QueryWrapper<>();
wrapper.eq("username", "å¼ ä¸‰");

// Lambdaæ–¹å¼ï¼ˆæ¨èï¼‰
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getUsername, "å¼ ä¸‰");
```

**Lambda ä¼˜ç‚¹ï¼š**
- ç±»å‹å®‰å…¨
- ç¼–è¯‘æœŸæ£€æŸ¥
- é‡æ„å‹å¥½

---

### 7. å¦‚ä½•å®ç°åŠ¨æ€æ¡ä»¶æŸ¥è¯¢ï¼Ÿ

**ç­”ï¼š**

**ä½¿ç”¨ condition å‚æ•°ï¼š**
```java
String username = "å¼ ä¸‰";
Integer minAge = 20;
Integer maxAge = null;

LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(username != null, User::getUsername, username)
       .ge(minAge != null, User::getAge, minAge)
       .le(maxAge != null, User::getAge, maxAge);

// åªä¼šæ·»åŠ énullçš„æ¡ä»¶
```

**å®æˆ˜æ¡ˆä¾‹ï¼š**
```java
public List<User> search(String username, Integer minAge, Integer maxAge) {
    LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
    wrapper.like(StringUtils.isNotBlank(username), User::getUsername, username)
           .ge(minAge != null, User::getAge, minAge)
           .le(maxAge != null, User::getAge, maxAge)
           .orderByDesc(User::getCreateTime);
    
    return userMapper.selectList(wrapper);
}
```

---

## å››ã€åˆ†é¡µæ’ä»¶

### 8. å¦‚ä½•ä½¿ç”¨åˆ†é¡µæ’ä»¶ï¼Ÿ

**ç­”ï¼š**

**1. é…ç½®æ’ä»¶**
```java
@Bean
public MybatisPlusInterceptor mybatisPlusInterceptor() {
    MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
    interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));
    return interceptor;
}
```

**2. ä½¿ç”¨åˆ†é¡µ**
```java
Page<User> page = new Page<>(1, 10);  // ç¬¬1é¡µï¼Œæ¯é¡µ10æ¡
userMapper.selectPage(page, null);

List<User> records = page.getRecords();  // å½“å‰é¡µæ•°æ®
long total = page.getTotal();            // æ€»è®°å½•æ•°
```

---

### 9. å¦‚ä½•ä¼˜åŒ–åˆ†é¡µæ€§èƒ½ï¼Ÿ

**ç­”ï¼š**

**1. ä¼˜åŒ– COUNT æŸ¥è¯¢**
```java
Page<User> page = new Page<>(1, 10);
page.setOptimizeCountSql(true);  // ç§»é™¤ ORDER BY
```

**2. ä¸æŸ¥è¯¢æ€»æ•°**
```java
Page<User> page = new Page<>(1, 10);
page.setSearchCount(false);  // ä¸æŸ¥è¯¢æ€»æ•°
```

**3. æ‰‹åŠ¨è®¾ç½®æ€»æ•°**
```java
// ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ€»æ•°
Page<User> page = new Page<>(1, 10);
userMapper.selectPage(page, null);
long total = page.getTotal();

// åç»­ç¿»é¡µä¸å†æŸ¥è¯¢æ€»æ•°
Page<User> page2 = new Page<>(2, 10);
page2.setSearchCount(false);
page2.setTotal(total);
```

---

## äº”ã€é«˜çº§åŠŸèƒ½

### 10. ä»€ä¹ˆæ˜¯é€»è¾‘åˆ é™¤ï¼Ÿå¦‚ä½•é…ç½®ï¼Ÿ

**ç­”ï¼š**

**é€»è¾‘åˆ é™¤ï¼š** åˆ é™¤æ•°æ®æ—¶ä¸çœŸæ­£åˆ é™¤ï¼Œè€Œæ˜¯æ ‡è®°ä¸ºå·²åˆ é™¤ã€‚

**é…ç½®ï¼š**
```yaml
mybatis-plus:
  global-config:
    db-config:
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
```

**å®ä½“ç±»ï¼š**
```java
@TableLogic
private Integer deleted;
```

**æ‰§è¡Œåˆ é™¤ï¼š**
```java
userMapper.deleteById(1L);
// å®é™…SQLï¼šUPDATE user SET deleted=1 WHERE id=1
```

---

### 11. ä»€ä¹ˆæ˜¯ä¹è§‚é”ï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ

**ç­”ï¼š**

**ä¹è§‚é”ï¼š** é€šè¿‡ç‰ˆæœ¬å·æœºåˆ¶ï¼Œè§£å†³å¹¶å‘æ›´æ–°é—®é¢˜ã€‚

**é…ç½®æ’ä»¶ï¼š**
```java
@Bean
public MybatisPlusInterceptor mybatisPlusInterceptor() {
    MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
    interceptor.addInnerInterceptor(new OptimisticLockerInnerInterceptor());
    return interceptor;
}
```

**å®ä½“ç±»ï¼š**
```java
@Version
private Integer version;
```

**ä½¿ç”¨ï¼š**
```java
// æŸ¥è¯¢
User user = userMapper.selectById(1L);  // version=1

// æ›´æ–°
user.setStock(90);
userMapper.updateById(user);
// SQL: UPDATE user SET stock=90, version=2 WHERE id=1 AND version=1
```

---

### 12. å¦‚ä½•å®ç°è‡ªåŠ¨å¡«å……ï¼Ÿ

**ç­”ï¼š**

**1. å®ä½“ç±»é…ç½®**
```java
@TableField(fill = FieldFill.INSERT)
private Date createTime;

@TableField(fill = FieldFill.INSERT_UPDATE)
private Date updateTime;
```

**2. åˆ›å»ºå¤„ç†å™¨**
```java
@Component
public class MyMetaObjectHandler implements MetaObjectHandler {
    
    @Override
    public void insertFill(MetaObject metaObject) {
        this.strictInsertFill(metaObject, "createTime", Date.class, new Date());
        this.strictInsertFill(metaObject, "updateTime", Date.class, new Date());
    }
    
    @Override
    public void updateFill(MetaObject metaObject) {
        this.strictUpdateFill(metaObject, "updateTime", Date.class, new Date());
    }
}
```

---

## å…­ã€ä»£ç ç”Ÿæˆå™¨

### 13. å¦‚ä½•ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ï¼Ÿ

**ç­”ï¼š**

**æ·»åŠ ä¾èµ–ï¼š**
```xml
<dependency>
    <groupId>com.baomidou</groupId>
    <artifactId>mybatis-plus-generator</artifactId>
    <version>3.5.4.1</version>
</dependency>
```

**é…ç½®å’Œæ‰§è¡Œï¼š**
```java
DataSourceConfig dataSourceConfig = new DataSourceConfig.Builder(
    "jdbc:mysql://localhost:3306/mybatis_plus",
    "root",
    "123456"
).build();

GlobalConfig globalConfig = new GlobalConfig.Builder()
    .outputDir(System.getProperty("user.dir") + "/src/main/java")
    .author("ä½œè€…")
    .enableSwagger()
    .build();

AutoGenerator generator = new AutoGenerator(dataSourceConfig);
generator.global(globalConfig);
generator.execute();
```

---

## ä¸ƒã€å®æˆ˜ç»éªŒ

### 14. MyBatis-Pluså¦‚ä½•é˜²æ­¢SQLæ³¨å…¥ï¼Ÿ

**ç­”ï¼š**

**MyBatis-Plus ä½¿ç”¨é¢„ç¼–è¯‘ï¼š**
```java
// Wrapper è‡ªåŠ¨ä½¿ç”¨é¢„ç¼–è¯‘
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getUsername, userInput);  // è‡ªåŠ¨é¢„ç¼–è¯‘
```

**æ³¨æ„äº‹é¡¹ï¼š**
- Wrapper é»˜è®¤å®‰å…¨
- é¿å…ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥
- åŠ¨æ€åˆ—åéœ€è¦ç™½åå•æ ¡éªŒ

---

### 15. MyBatis-Pluså’ŒJPAçš„åŒºåˆ«ï¼Ÿ

**ç­”ï¼š**

| ç‰¹æ€§ | MyBatis-Plus | JPA |
|------|--------------|-----|
| **ç±»å‹** | åŠè‡ªåŠ¨ORM | å…¨è‡ªåŠ¨ORM |
| **SQLæ§åˆ¶** | å®Œå…¨æ§åˆ¶ | è‡ªåŠ¨ç”Ÿæˆ |
| **å­¦ä¹ æ›²çº¿** | å¹³ç¼“ | é™¡å³­ |
| **æ€§èƒ½ä¼˜åŒ–** | å®¹æ˜“ | å›°éš¾ |
| **å¤æ‚æŸ¥è¯¢** | æ“…é•¿ | è¾ƒå¼± |

**é€‰æ‹©å»ºè®®ï¼š**
- éœ€è¦ SQL ä¼˜åŒ– â†’ MyBatis-Plus
- ç®€å• CRUD â†’ JPA

---

## å…«ã€æ€»ç»“

### é«˜é¢‘è€ƒç‚¹

âœ… **å¿…é¡»æŒæ¡ï¼š**
- MyBatis-Plus æ ¸å¿ƒç‰¹æ€§
- BaseMapper å’Œ IService
- æ¡ä»¶æ„é€ å™¨ï¼ˆLambda æ–¹å¼ï¼‰
- åˆ†é¡µæ’ä»¶ä½¿ç”¨
- é€»è¾‘åˆ é™¤
- ä¹è§‚é”

âœ… **åŠ åˆ†é¡¹ï¼š**
- ä»£ç ç”Ÿæˆå™¨
- æ€§èƒ½ä¼˜åŒ–
- è‡ªå®šä¹‰é€šç”¨æ–¹æ³•
- å¤šç§Ÿæˆ·

### é¢è¯•æŠ€å·§

1. **å¯¹æ¯”è¯´æ˜** - MyBatis-Plus vs MyBatis
2. **ä¸¾ä¾‹è¯´æ˜** - ä»£ç ç¤ºä¾‹
3. **æ€§èƒ½ä¼˜åŒ–** - åˆ†é¡µä¼˜åŒ–
4. **é¡¹ç›®ç»éªŒ** - å®é™…ä½¿ç”¨åœºæ™¯

---

**æ­å–œä½ å®Œæˆ MyBatis-Plus å­¦ä¹ ï¼ğŸ‰**
