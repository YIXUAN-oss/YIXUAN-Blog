---
title: MyBatis-Plus基础入门
---

# MyBatis-Plus基础入门

## 一、MyBatis-Plus是什么？

### 1.1 MyBatis-Plus简介

**MyBatis-Plus（简称 MP）**是一个 MyBatis 的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。

**官网：** https://baomidou.com/

**核心特性：**
- 无侵入：只做增强不做改变
- 损耗小：启动即会自动注入基本 CRUD
- 强大的 CRUD 操作
- 支持 Lambda 形式调用
- 支持主键自动生成
- 支持 ActiveRecord 模式
- 支持自定义全局通用操作
- 内置代码生成器
- 内置分页插件
- 内置性能分析插件

### 1.2 MyBatis-Plus vs MyBatis

| 特性 | MyBatis | MyBatis-Plus |
|------|---------|--------------|
| **XML文件** | 必需 | 可选 |
| **CRUD方法** | 需手写 | 自动提供 |
| **代码量** | 多 | 少 |
| **开发效率** | 中 | 高 |
| **学习曲线** | 平缓 | 平缓 |
| **复杂SQL** | 擅长 | 擅长 |

**优势：**
- ✅ 减少 80% 的代码量
- ✅ 提高开发效率
- ✅ 保留 MyBatis 的灵活性
- ✅ 内置常用功能

---

## 二、快速开始

### 2.1 创建数据库

```sql
CREATE DATABASE mybatis_plus;

USE mybatis_plus;

CREATE TABLE user (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100),
    age INT,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted INT DEFAULT 0 COMMENT '0-未删除 1-已删除'
);

INSERT INTO user (username, email, age) VALUES
('张三', 'zhangsan@example.com', 20),
('李四', 'lisi@example.com', 25),
('王五', 'wangwu@example.com', 30);
```

### 2.2 创建Spring Boot项目

**pom.xml：**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project>
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.18</version>
    </parent>
    
    <dependencies>
        <!-- Spring Boot -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter</artifactId>
        </dependency>
        
        <!-- MyBatis-Plus -->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-boot-starter</artifactId>
            <version>3.5.4.1</version>
        </dependency>
        
        <!-- MySQL Driver -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>8.0.33</version>
        </dependency>
        
        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
        </dependency>
        
        <!-- Test -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>
</project>
```

### 2.3 配置文件

**application.yml：**
```yaml
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/mybatis_plus?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: 123456

mybatis-plus:
  configuration:
    # 日志输出
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    # 驼峰命名
    map-underscore-to-camel-case: true
  global-config:
    db-config:
      # 主键策略
      id-type: auto
      # 逻辑删除字段
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
```

### 2.4 创建实体类

```java
package com.example.entity;

import com.baomidou.mybatisplus.annotation.*;
import lombok.Data;
import java.util.Date;

@Data
@TableName("user")
public class User {
    
    @TableId(type = IdType.AUTO)
    private Long id;
    
    private String username;
    private String email;
    private Integer age;
    
    @TableField(fill = FieldFill.INSERT)
    private Date createTime;
    
    @TableField(fill = FieldFill.INSERT_UPDATE)
    private Date updateTime;
    
    @TableLogic
    private Integer deleted;
}
```

### 2.5 创建Mapper接口

```java
package com.example.mapper;

import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import com.example.entity.User;
import org.apache.ibatis.annotations.Mapper;

@Mapper
public interface UserMapper extends BaseMapper<User> {
    // 继承 BaseMapper，自动拥有基础 CRUD 方法
    // 无需编写任何 SQL
}
```

### 2.6 启动类

```java
package com.example;

import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
@MapperScan("com.example.mapper")
public class Application {
    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
```

### 2.7 测试

```java
@SpringBootTest
public class UserMapperTest {
    
    @Autowired
    private UserMapper userMapper;
    
    @Test
    public void testSelectList() {
        // 查询所有用户
        List<User> users = userMapper.selectList(null);
        users.forEach(System.out::println);
    }
    
    @Test
    public void testInsert() {
        User user = new User();
        user.setUsername("赵六");
        user.setEmail("zhaoliu@example.com");
        user.setAge(28);
        
        int rows = userMapper.insert(user);
        System.out.println("影响行数：" + rows);
        System.out.println("生成的ID：" + user.getId());
    }
    
    @Test
    public void testUpdate() {
        User user = new User();
        user.setId(1L);
        user.setAge(21);
        
        userMapper.updateById(user);
    }
    
    @Test
    public void testDelete() {
        userMapper.deleteById(4L);
    }
}
```

---

## 三、常用注解

### 3.1 @TableName

**指定表名：**
```java
@TableName("user")  // 如果类名和表名一致，可省略
public class User {
}
```

### 3.2 @TableId

**指定主键：**
```java
@TableId(type = IdType.AUTO)
private Long id;
```

**主键策略：**
| 类型 | 说明 |
|------|------|
| AUTO | 数据库自增 |
| NONE | 无状态 |
| INPUT | 手动输入 |
| ASSIGN_ID | 雪花算法（默认） |
| ASSIGN_UUID | UUID |

### 3.3 @TableField

**指定字段：**
```java
// 字段名映射
@TableField("user_name")
private String username;

// 不存在的字段
@TableField(exist = false)
private String remark;

// 自动填充
@TableField(fill = FieldFill.INSERT)
private Date createTime;

@TableField(fill = FieldFill.INSERT_UPDATE)
private Date updateTime;
```

**填充策略：**
| 策略 | 说明 |
|------|------|
| DEFAULT | 默认不填充 |
| INSERT | 插入时填充 |
| UPDATE | 更新时填充 |
| INSERT_UPDATE | 插入和更新都填充 |

### 3.4 @TableLogic

**逻辑删除：**
```java
@TableLogic
private Integer deleted;  // 0-未删除 1-已删除
```

**执行删除：**
```java
userMapper.deleteById(1L);
// 实际执行：UPDATE user SET deleted=1 WHERE id=1
```

### 3.5 @Version

**乐观锁：**
```java
@Version
private Integer version;
```

---

## 四、自动填充

### 4.1 创建处理器

```java
@Component
public class MyMetaObjectHandler implements MetaObjectHandler {
    
    @Override
    public void insertFill(MetaObject metaObject) {
        // 插入时填充
        this.strictInsertFill(metaObject, "createTime", Date.class, new Date());
        this.strictInsertFill(metaObject, "updateTime", Date.class, new Date());
    }
    
    @Override
    public void updateFill(MetaObject metaObject) {
        // 更新时填充
        this.strictUpdateFill(metaObject, "updateTime", Date.class, new Date());
    }
}
```

### 4.2 实体类配置

```java
@TableField(fill = FieldFill.INSERT)
private Date createTime;

@TableField(fill = FieldFill.INSERT_UPDATE)
private Date updateTime;
```

---

## 五、总结

✅ **本章学习内容：**
- MyBatis-Plus 是什么？
- MyBatis-Plus vs MyBatis
- 快速开始
- 常用注解
- 自动填充

✅ **核心要点：**
- MyBatis-Plus 只做增强不做改变
- 继承 BaseMapper 自动拥有 CRUD 方法
- 使用注解简化配置
- 支持自动填充

**下一章预告：** 我们将学习 MyBatis-Plus CRUD 接口。
