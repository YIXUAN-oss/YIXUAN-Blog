---
title: CRUD接口
---

# CRUD接口

## 一、Mapper CRUD接口

### 1.1 BaseMapper接口

**继承 BaseMapper 自动拥有以下方法：**
```java
public interface UserMapper extends BaseMapper<User> {
}
```

### 1.2 Insert（插入）

```java
// 插入一条记录
int insert(T entity);
```

**示例：**
```java
User user = new User();
user.setUsername("张三");
user.setEmail("zhangsan@example.com");
user.setAge(20);

int rows = userMapper.insert(user);
System.out.println("插入成功，ID：" + user.getId());
```

### 1.3 Delete（删除）

```java
// 根据ID删除
int deleteById(Serializable id);

// 根据条件删除
int delete(@Param(Constants.WRAPPER) Wrapper<T> wrapper);

// 根据ID批量删除
int deleteBatchIds(@Param(Constants.COLLECTION) Collection<? extends Serializable> idList);

// 根据Map删除
int deleteByMap(@Param(Constants.COLUMN_MAP) Map<String, Object> columnMap);
```

**示例：**
```java
// 根据ID删除
userMapper.deleteById(1L);

// 批量删除
userMapper.deleteBatchIds(Arrays.asList(1L, 2L, 3L));

// 根据条件删除
Map<String, Object> map = new HashMap<>();
map.put("age", 20);
userMapper.deleteByMap(map);
```

### 1.4 Update（更新）

```java
// 根据ID更新
int updateById(@Param(Constants.ENTITY) T entity);

// 根据条件更新
int update(@Param(Constants.ENTITY) T entity, @Param(Constants.WRAPPER) Wrapper<T> updateWrapper);
```

**示例：**
```java
// 根据ID更新
User user = new User();
user.setId(1L);
user.setAge(21);
userMapper.updateById(user);

// 根据条件更新
User user = new User();
user.setAge(30);
UpdateWrapper<User> wrapper = new UpdateWrapper<>();
wrapper.eq("username", "张三");
userMapper.update(user, wrapper);
```

### 1.5 Select（查询）

```java
// 根据ID查询
T selectById(Serializable id);

// 根据ID批量查询
List<T> selectBatchIds(@Param(Constants.COLLECTION) Collection<? extends Serializable> idList);

// 根据Map查询
List<T> selectByMap(@Param(Constants.COLUMN_MAP) Map<String, Object> columnMap);

// 根据条件查询一条
T selectOne(@Param(Constants.WRAPPER) Wrapper<T> queryWrapper);

// 根据条件查询数量
Long selectCount(@Param(Constants.WRAPPER) Wrapper<T> queryWrapper);

// 根据条件查询列表
List<T> selectList(@Param(Constants.WRAPPER) Wrapper<T> queryWrapper);

// 根据条件查询Map列表
List<Map<String, Object>> selectMaps(@Param(Constants.WRAPPER) Wrapper<T> queryWrapper);

// 分页查询
IPage<T> selectPage(IPage<T> page, @Param(Constants.WRAPPER) Wrapper<T> queryWrapper);
```

**示例：**
```java
// 根据ID查询
User user = userMapper.selectById(1L);

// 批量查询
List<User> users = userMapper.selectBatchIds(Arrays.asList(1L, 2L, 3L));

// 查询所有
List<User> users = userMapper.selectList(null);

// 查询数量
Long count = userMapper.selectCount(null);
```

---

## 二、Service CRUD接口

### 2.1 创建Service

**接口：**
```java
public interface UserService extends IService<User> {
}
```

**实现类：**
```java
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> implements UserService {
}
```

### 2.2 Save（保存）

```java
// 插入一条记录
boolean save(T entity);

// 批量插入
boolean saveBatch(Collection<T> entityList);

// 批量插入（指定批次大小）
boolean saveBatch(Collection<T> entityList, int batchSize);

// 保存或更新
boolean saveOrUpdate(T entity);

// 批量保存或更新
boolean saveOrUpdateBatch(Collection<T> entityList);
```

**示例：**
```java
// 插入
User user = new User();
user.setUsername("张三");
userService.save(user);

// 批量插入
List<User> users = new ArrayList<>();
users.add(new User("张三", 20));
users.add(new User("李四", 25));
userService.saveBatch(users);

// 保存或更新
User user = new User();
user.setId(1L);  // 有ID更新，无ID插入
user.setUsername("张三");
userService.saveOrUpdate(user);
```

### 2.3 Remove（删除）

```java
// 根据ID删除
boolean removeById(Serializable id);

// 根据条件删除
boolean remove(Wrapper<T> queryWrapper);

// 根据ID批量删除
boolean removeByIds(Collection<? extends Serializable> idList);

// 根据Map删除
boolean removeByMap(Map<String, Object> columnMap);
```

**示例：**
```java
// 根据ID删除
userService.removeById(1L);

// 批量删除
userService.removeByIds(Arrays.asList(1L, 2L, 3L));
```

### 2.4 Update（更新）

```java
// 根据ID更新
boolean updateById(T entity);

// 根据条件更新
boolean update(Wrapper<T> updateWrapper);
boolean update(T entity, Wrapper<T> updateWrapper);

// 批量更新
boolean updateBatchById(Collection<T> entityList);
```

**示例：**
```java
// 根据ID更新
User user = new User();
user.setId(1L);
user.setAge(21);
userService.updateById(user);
```

### 2.5 Get/List（查询）

```java
// 根据ID查询
T getById(Serializable id);

// 根据条件查询一条
T getOne(Wrapper<T> queryWrapper);

// 查询总数
long count(Wrapper<T> queryWrapper);

// 查询列表
List<T> list();
List<T> list(Wrapper<T> queryWrapper);

// 查询Map列表
List<Map<String, Object>> listMaps(Wrapper<T> queryWrapper);

// 分页查询
IPage<T> page(IPage<T> page);
IPage<T> page(IPage<T> page, Wrapper<T> queryWrapper);
```

**示例：**
```java
// 查询所有
List<User> users = userService.list();

// 查询数量
long count = userService.count();

// 分页查询
Page<User> page = new Page<>(1, 10);
userService.page(page);
```

---

## 三、链式调用

### 3.1 查询链式

```java
// query()
List<User> users = userService.query()
    .eq("age", 20)
    .like("username", "张")
    .list();

// lambdaQuery()
List<User> users = userService.lambdaQuery()
    .eq(User::getAge, 20)
    .like(User::getUsername, "张")
    .list();
```

### 3.2 更新链式

```java
// update()
userService.update()
    .set("age", 30)
    .eq("username", "张三")
    .update();

// lambdaUpdate()
userService.lambdaUpdate()
    .set(User::getAge, 30)
    .eq(User::getUsername, "张三")
    .update();
```

### 3.3 删除链式

```java
// remove()
userService.remove()
    .eq("age", 20)
    .remove();

// lambdaQuery().remove()
userService.lambdaQuery()
    .eq(User::getAge, 20)
    .remove();
```

---

## 四、总结

✅ **本章学习内容：**
- Mapper CRUD 接口
- Service CRUD 接口
- 批量操作
- 链式调用

✅ **核心要点：**
- Mapper 层：BaseMapper
- Service 层：IService + ServiceImpl
- Service 层功能更强大
- 链式调用更简洁

**下一章预告：** 我们将学习条件构造器。
