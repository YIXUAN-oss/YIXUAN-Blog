---
title: 响应式布局增强
date: 2025-01-22
---

# 响应式布局增强

> 适配不同屏幕尺寸的布局方案

## 📐 布局系统

### 布局类型

```typescript
布局容器
├─ 线性布局
│   ├─ Column（垂直）
│   └─ Row（水平）
├─ 弹性布局
│   └─ Flex
├─ 层叠布局
│   └─ Stack
├─ 网格布局
│   └─ Grid
└─ 相对布局
    └─ RelativeContainer
```

## 🎯 响应式单位

### 1. 百分比布局

```typescript
@Entry
@Component
struct PercentageLayout {
  build() {
    Column() {
      // 宽度占父容器的 80%
      Text('80% 宽度')
        .width('80%')
        .height(60)
        .backgroundColor(Color.Blue)
      
      Row() {
        Text('33.33%')
          .width('33.33%')
          .height(60)
          .backgroundColor(Color.Red)
        
        Text('66.67%')
          .width('66.67%')
          .height(60)
          .backgroundColor(Color.Green)
      }
      .width('100%')
    }
    .width('100%')
    .height('100%')
  }
}
```

### 2. fr 弹性单位

```typescript
@Entry
@Component
struct FrLayout {
  build() {
    Row() {
      Text('1fr')
        .layoutWeight(1)
        .height(60)
        .backgroundColor(Color.Red)
      
      Text('2fr')
        .layoutWeight(2)
        .height(60)
        .backgroundColor(Color.Blue)
      
      Text('1fr')
        .layoutWeight(1)
        .height(60)
        .backgroundColor(Color.Green)
    }
    .width('100%')
  }
}
```

### 3. vp/fp 虚拟像素

```typescript
@Entry
@Component
struct VpLayout {
  build() {
    Column({ space: 10 }) {
      // vp - 虚拟像素（推荐）
      Text('使用 vp')
        .fontSize(16)  // 默认单位是 vp
        .width(200)    // 200vp
        .height(60)
      
      // fp - 字体像素（字体专用）
      Text('使用 fp')
        .fontSize('16fp')
        .fontColor(Color.Blue)
    }
  }
}
```

## 📱 断点系统

### 断点定义

```typescript
// 断点配置
const breakpoints = {
  sm: 320,   // 小屏幕（手机竖屏）
  md: 600,   // 中等屏幕（手机横屏/小平板）
  lg: 840,   // 大屏幕（平板）
  xl: 1024   // 超大屏幕（桌面）
}

@Entry
@Component
struct BreakpointExample {
  @State currentBreakpoint: string = 'sm'
  
  aboutToAppear() {
    this.updateBreakpoint()
  }
  
  updateBreakpoint() {
    const width = display.getDefaultDisplaySync().width
    
    if (width < 600) {
      this.currentBreakpoint = 'sm'
    } else if (width < 840) {
      this.currentBreakpoint = 'md'
    } else if (width < 1024) {
      this.currentBreakpoint = 'lg'
    } else {
      this.currentBreakpoint = 'xl'
    }
  }
  
  build() {
    Column() {
      Text(`当前断点: ${this.currentBreakpoint}`)
      
      if (this.currentBreakpoint === 'sm') {
        // 手机布局
        PhoneLayout()
      } else if (this.currentBreakpoint === 'md') {
        // 平板布局
        TabletLayout()
      } else {
        // 桌面布局
        DesktopLayout()
      }
    }
  }
}
```

### GridRow 栅格布局

```typescript
@Entry
@Component
struct GridRowExample {
  build() {
    GridRow({
      columns: { sm: 4, md: 8, lg: 12 },  // 不同断点的列数
      gutter: { x: 10, y: 10 }            // 间距
    }) {
      GridCol({ span: { sm: 4, md: 4, lg: 3 } }) {
        Text('列 1')
          .backgroundColor(Color.Red)
          .height(100)
      }
      
      GridCol({ span: { sm: 4, md: 4, lg: 3 } }) {
        Text('列 2')
          .backgroundColor(Color.Blue)
          .height(100)
      }
      
      GridCol({ span: { sm: 4, md: 8, lg: 6 } }) {
        Text('列 3')
          .backgroundColor(Color.Green)
          .height(100)
      }
    }
    .width('100%')
  }
}
```

## 🎨 Flex 弹性布局

### 基础用法

```typescript
@Entry
@Component
struct FlexExample {
  build() {
    Flex({
      direction: FlexDirection.Row,       // 主轴方向
      wrap: FlexWrap.Wrap,               // 换行
      justifyContent: FlexAlign.SpaceBetween,  // 主轴对齐
      alignItems: ItemAlign.Center       // 交叉轴对齐
    }) {
      Text('Item 1')
        .width(100)
        .height(60)
        .backgroundColor(Color.Red)
      
      Text('Item 2')
        .flexGrow(1)  // 占据剩余空间
        .height(60)
        .backgroundColor(Color.Blue)
      
      Text('Item 3')
        .width(100)
        .height(60)
        .backgroundColor(Color.Green)
    }
    .width('100%')
    .height(200)
  }
}
```

### 响应式卡片布局

```typescript
@Entry
@Component
struct ResponsiveCards {
  @State cards: number[] = Array.from({ length: 12 }, (_, i) => i + 1)
  
  build() {
    Flex({ wrap: FlexWrap.Wrap }) {
      ForEach(this.cards, (card: number) => {
        Column() {
          Text(`Card ${card}`)
            .fontSize(20)
        }
        .width('30%')       // 每行3个
        .aspectRatio(1)     // 正方形
        .backgroundColor(Color.Blue)
        .margin(5)
        .borderRadius(8)
        .justifyContent(FlexAlign.Center)
      })
    }
    .width('100%')
    .padding(10)
  }
}
```

## 📏 相对布局

### RelativeContainer

```typescript
@Entry
@Component
struct RelativeLayoutExample {
  build() {
    RelativeContainer() {
      // 锚点在顶部
      Text('Top')
        .id('top')
        .fontSize(16)
        .alignRules({
          top: { anchor: '__container__', align: VerticalAlign.Top },
          middle: { anchor: '__container__', align: HorizontalAlign.Center }
        })
      
      // 锚点在中间
      Text('Center')
        .id('center')
        .fontSize(20)
        .alignRules({
          middle: { anchor: '__container__', align: HorizontalAlign.Center },
          center: { anchor: '__container__', align: VerticalAlign.Center }
        })
      
      // 锚点在底部
      Text('Bottom')
        .id('bottom')
        .fontSize(16)
        .alignRules({
          bottom: { anchor: '__container__', align: VerticalAlign.Bottom },
          middle: { anchor: '__container__', align: HorizontalAlign.Center }
        })
    }
    .width('100%')
    .height('100%')
  }
}
```

## 🎯 实战案例

### 响应式商品列表

```typescript
@Entry
@Component
struct ResponsiveProductList {
  @State products: Product[] = []
  @State columns: number = 2
  
  build() {
    GridRow({
      columns: { sm: 2, md: 3, lg: 4, xl: 6 }
    }) {
      ForEach(this.products, (product: Product) => {
        GridCol({ span: 1 }) {
          Column({ space: 8 }) {
            Image(product.image)
              .width('100%')
              .aspectRatio(1)
              .objectFit(ImageFit.Cover)
              .borderRadius(8)
            
            Text(product.name)
              .fontSize(14)
              .maxLines(2)
              .textOverflow({ overflow: TextOverflow.Ellipsis })
            
            Text(`¥${product.price}`)
              .fontSize(16)
              .fontColor(Color.Red)
              .fontWeight(FontWeight.Bold)
          }
          .width('100%')
          .padding(10)
          .backgroundColor(Color.White)
          .borderRadius(8)
        }
      })
    }
    .width('100%')
  }
}
```

## 💡 最佳实践

### 1. 使用相对单位

```typescript
// ✅ 推荐 - 使用百分比和 vp
Text('标题')
  .width('80%')
  .fontSize(16)  // 16vp

// ❌ 避免 - 使用固定像素
Text('标题')
  .width(300)    // 在不同设备上可能不适配
  .fontSize('16px')
```

### 2. 合理设置断点

```typescript
// ✅ 根据设备特性设置
const breakpoints = {
  phone: 600,
  tablet: 840,
  desktop: 1024
}
```

### 3. 使用 layoutWeight

```typescript
// ✅ 弹性布局
Row() {
  Text('固定').width(100)
  Text('弹性').layoutWeight(1)
  Text('固定').width(100)
}
```

## 📚 参考资源

- [响应式布局](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-layout-development-responsive-grid-0000001454605318-V3)
- [栅格布局](https://developer.harmonyos.com/cn/docs/documentation/doc-references-V3/ts-container-gridrow-0000001478181385-V3)

---

**下一节** → [自适应UI设计](05-自适应UI设计.md)
