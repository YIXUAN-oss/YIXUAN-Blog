---
title: 跨设备组件适配
date: 2025-01-22
---

# 跨设备组件适配

> 一套代码，多端运行

## 🎯 设备类型识别

### 获取设备类型

```typescript
import deviceInfo from '@ohos.deviceInfo'

@Entry
@Component
struct DeviceDetection {
  @State deviceType: string = ''
  
  aboutToAppear() {
    this.deviceType = deviceInfo.deviceType
    // 'phone' | 'tablet' | 'wearable' | 'tv' | '2in1'
  }
  
  build() {
    Column() {
      if (this.deviceType === 'phone') {
        PhoneLayout()
      } else if (this.deviceType === 'tablet') {
        TabletLayout()
      } else if (this.deviceType === 'wearable') {
        WearableLayout()
      }
    }
  }
}
```

## 📱 手机端适配

### 手机布局

```typescript
@Component
struct PhoneLayout {
  build() {
    Column() {
      // 顶部导航栏
      Row() {
        Image($r('app.media.icon_back'))
          .width(24).height(24)
        Text('标题').layoutWeight(1)
        Image($r('app.media.icon_menu'))
          .width(24).height(24)
      }
      .width('100%')
      .height(56)
      .padding({ left: 16, right: 16 })
      
      // 内容区域
      List() {
        ForEach([1, 2, 3], (item: number) => {
          ListItem() {
            Text(`Item ${item}`)
              .width('100%')
              .height(60)
          }
        })
      }
      .layoutWeight(1)
      
      // 底部导航栏
      Row() {
        ForEach(['首页', '消息', '我的'], (tab: string) => {
          Column() {
            Image($r('app.media.icon_home'))
              .width(24).height(24)
            Text(tab).fontSize(12)
          }
          .layoutWeight(1)
        })
      }
      .width('100%')
      .height(56)
    }
  }
}
```

## 📟 平板端适配

### 平板布局

```typescript
@Component
struct TabletLayout {
  build() {
    Row() {
      // 左侧导航栏
      Column() {
        ForEach(['首页', '消息', '我的'], (tab: string) => {
          Row() {
            Image($r('app.media.icon'))
              .width(24).height(24)
            Text(tab).fontSize(16)
          }
          .width('100%')
          .height(50)
          .padding({ left: 20 })
        })
      }
      .width(200)
      .backgroundColor(0xF5F5F5)
      
      // 主内容区域
      Column() {
        // 顶部标题栏
        Text('内容区域')
          .fontSize(24)
          .width('100%')
          .height(60)
          .padding({ left: 20 })
        
        // 内容列表
        List() {
          ForEach([1, 2, 3, 4, 5], (item: number) => {
            ListItem() {
              Row() {
                Text(`Item ${item}`)
                  .fontSize(18)
              }
              .width('100%')
              .height(80)
              .padding(20)
            }
          })
        }
        .layoutWeight(1)
      }
      .layoutWeight(1)
    }
    .width('100%')
    .height('100%')
  }
}
```

## ⌚ 智能穿戴适配

### 手表布局

```typescript
@Component
struct WearableLayout {
  build() {
    Column() {
      // 圆形表盘适配
      Circle()
        .width(200)
        .height(200)
        .fill(Color.Blue)
      
      // 紧凑的列表
      List() {
        ForEach([1, 2, 3], (item: number) => {
          ListItem() {
            Text(`Item ${item}`)
              .fontSize(14)
              .height(40)
          }
        })
      }
    }
    .width('100%')
    .justifyContent(FlexAlign.Center)
  }
}
```

## 📱 折叠屏适配

### 折叠屏状态检测

```typescript
import window from '@ohos.window'

@Entry
@Component
struct FoldableExample {
  @State isFolded: boolean = false
  @State displayMode: string = 'normal'
  
  async aboutToAppear() {
    const windowClass = await window.getLastWindow(getContext())
    
    windowClass.on('windowSizeChange', (size) => {
      // 监听折叠状态变化
      this.checkFoldState(size.width, size.height)
    })
  }
  
  checkFoldState(width: number, height: number) {
    if (width < 600) {
      this.displayMode = 'folded'  // 折叠状态
    } else {
      this.displayMode = 'expanded'  // 展开状态
    }
  }
  
  build() {
    Column() {
      if (this.displayMode === 'folded') {
        // 折叠状态 - 单屏布局
        PhoneLayout()
      } else {
        // 展开状态 - 双屏布局
        Row() {
          List().width('50%')  // 左屏
          Detail().width('50%')  // 右屏
        }
      }
    }
  }
}
```

## 🎨 通用适配组件

### 自适应卡片

```typescript
@Component
export struct AdaptiveCard {
  @Prop title: string
  @Prop content: string
  @State cardWidth: string = '100%'
  
  aboutToAppear() {
    const deviceType = deviceInfo.deviceType
    
    if (deviceType === 'phone') {
      this.cardWidth = '100%'
    } else if (deviceType === 'tablet') {
      this.cardWidth = '48%'
    } else {
      this.cardWidth = '30%'
    }
  }
  
  build() {
    Column({ space: 10 }) {
      Text(this.title)
        .fontSize(18)
        .fontWeight(FontWeight.Bold)
      
      Text(this.content)
        .fontSize(14)
        .fontColor(Color.Gray)
    }
    .width(this.cardWidth)
    .padding(15)
    .backgroundColor(Color.White)
    .borderRadius(8)
  }
}
```

## 💡 最佳实践

### 1. 使用设备能力查询

```typescript
import deviceInfo from '@ohos.deviceInfo'

const isTablet = deviceInfo.deviceType === 'tablet'
const isPhone = deviceInfo.deviceType === 'phone'
```

### 2. 响应式布局优先

```typescript
// ✅ 使用 GridRow 自动适配
GridRow({
  columns: { sm: 4, md: 8, lg: 12 }
}) {
  GridCol({ span: { sm: 4, md: 4, lg: 3 } }) {
    Text('内容')
  }
}
```

### 3. 条件渲染

```typescript
if (deviceType === 'phone') {
  PhoneLayout()
} else {
  TabletLayout()
}
```

## 📚 参考资源

- [一次开发多端部署](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/start-with-ets-stage-0000001477980905-V3)

---

**下一节** → [自定义组件最佳实践](07-自定义组件最佳实践.md)
