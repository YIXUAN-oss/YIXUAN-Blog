---
title: 自然语言处理
date: 2025-01-22
---

# 自然语言处理

> 实现智能文本分析

## 📝 文本分类

### 基础文本分类

```typescript
import { textClassifier } from '@ohos.ai.nlp'

// 创建分类器
const classifier = textClassifier.create({
  language: 'zh-CN',
  categories: ['科技', '体育', '娱乐', '财经', '政治']
})

// 分类文本
const text = '华为发布最新旗舰手机，搭载麒麟芯片'
const result = await classifier.classify(text)

console.log('分类:', result.category)        // 科技
console.log('置信度:', result.confidence)    // 0.95
```

### 多标签分类

```typescript
const classifier = textClassifier.create({
  multiLabel: true,
  topK: 3
})

const text = '这部电影的特效很棒，剧情也很精彩'
const results = await classifier.classify(text)

results.forEach(result => {
  console.log(`${result.label}: ${result.confidence}`)
})
// 输出：
// 电影: 0.98
// 娱乐: 0.85
// 评论: 0.76
```

## 😊 情感分析

### 情感识别

```typescript
import { sentimentAnalyzer } from '@ohos.ai.nlp'

const analyzer = sentimentAnalyzer.create({
  language: 'zh-CN'
})

// 分析情感
const text = '这个产品真的很棒，我非常喜欢！'
const sentiment = await analyzer.analyze(text)

console.log('情感:', sentiment.type)          // positive
console.log('得分:', sentiment.score)         // 0.92
console.log('置信度:', sentiment.confidence)  // 0.88
```

### 情感趋势分析

```typescript
@Entry
@Component
struct ReviewAnalysis {
  @State reviews: Review[] = []
  @State sentiment: SentimentStats = null
  private analyzer: SentimentAnalyzer
  
  async aboutToAppear() {
    this.analyzer = sentimentAnalyzer.create()
    await this.analyzeReviews()
  }
  
  async analyzeReviews() {
    const results = []
    
    for (const review of this.reviews) {
      const sentiment = await this.analyzer.analyze(review.text)
      results.push(sentiment)
    }
    
    // 统计
    this.sentiment = {
      positive: results.filter(r => r.type === 'positive').length,
      neutral: results.filter(r => r.type === 'neutral').length,
      negative: results.filter(r => r.type === 'negative').length,
      avgScore: results.reduce((sum, r) => sum + r.score, 0) / results.length
    }
  }
  
  build() {
    Column({ space: 20 }) {
      Text('评论分析')
        .fontSize(24)
        .fontWeight(FontWeight.Bold)
      
      if (this.sentiment) {
        Row({ space: 20 }) {
          Column() {
            Text(`${this.sentiment.positive}`)
              .fontSize(32)
              .fontColor(Color.Green)
            Text('正面')
          }
          
          Column() {
            Text(`${this.sentiment.neutral}`)
              .fontSize(32)
              .fontColor(Color.Gray)
            Text('中性')
          }
          
          Column() {
            Text(`${this.sentiment.negative}`)
              .fontSize(32)
              .fontColor(Color.Red)
            Text('负面')
          }
        }
        
        Text(`平均得分: ${this.sentiment.avgScore.toFixed(2)}`)
          .fontSize(18)
      }
    }
    .padding(20)
  }
}
```

## 🏷️ 命名实体识别

### 实体提取

```typescript
import { entityRecognizer } from '@ohos.ai.nlp'

const recognizer = entityRecognizer.create({
  language: 'zh-CN',
  entityTypes: ['PERSON', 'LOCATION', 'ORGANIZATION', 'TIME']
})

const text = '马云在杭州创立了阿里巴巴集团'
const entities = await recognizer.recognize(text)

entities.forEach(entity => {
  console.log(`${entity.text}: ${entity.type}`)
})
// 输出：
// 马云: PERSON
// 杭州: LOCATION
// 阿里巴巴集团: ORGANIZATION
```

## 🌐 机器翻译

### 文本翻译

```typescript
import { translator } from '@ohos.ai.nlp'

const trans = translator.create({
  from: 'zh-CN',
  to: 'en-US'
})

const text = '你好，世界'
const result = await trans.translate(text)

console.log('翻译结果:', result.text)  // Hello, World
```

### 实时翻译

```typescript
@Entry
@Component
struct TranslatorApp {
  @State sourceText: string = ''
  @State translatedText: string = ''
  @State sourceLang: string = 'zh-CN'
  @State targetLang: string = 'en-US'
  private translator: Translator
  private debounceTimer: number = 0
  
  async aboutToAppear() {
    this.translator = translator.create({
      from: this.sourceLang,
      to: this.targetLang
    })
  }
  
  onTextChange(text: string) {
    this.sourceText = text
    
    // 防抖
    if (this.debounceTimer) {
      clearTimeout(this.debounceTimer)
    }
    
    this.debounceTimer = setTimeout(async () => {
      if (text.trim()) {
        const result = await this.translator.translate(text)
        this.translatedText = result.text
      }
    }, 500)
  }
  
  build() {
    Column({ space: 20 }) {
      Text('实时翻译')
        .fontSize(24)
        .fontWeight(FontWeight.Bold)
      
      // 语言选择
      Row({ space: 10 }) {
        Select([
          { value: '中文', data: 'zh-CN' },
          { value: 'English', data: 'en-US' },
          { value: '日本語', data: 'ja-JP' }
        ])
        .onSelect((index) => {
          // 更新源语言
        })
        
        Text('→')
          .fontSize(20)
        
        Select([
          { value: 'English', data: 'en-US' },
          { value: '中文', data: 'zh-CN' },
          { value: '日本語', data: 'ja-JP' }
        ])
        .onSelect((index) => {
          // 更新目标语言
        })
      }
      
      // 输入框
      TextArea({ placeholder: '输入要翻译的文本' })
        .height(150)
        .onChange((value) => {
          this.onTextChange(value)
        })
      
      Divider()
      
      // 翻译结果
      Column({ space: 10 }) {
        Text('翻译结果')
          .fontSize(14)
          .fontColor(Color.Gray)
        
        Text(this.translatedText || '等待输入...')
          .fontSize(18)
          .padding(15)
          .backgroundColor(0xF5F5F5)
          .width('100%')
          .minHeight(150)
          .borderRadius(8)
      }
    }
    .padding(20)
    .width('100%')
  }
}
```

## 💡 最佳实践

### 1. 批量处理

```typescript
// ✅ 批量分类
const texts = ['文本1', '文本2', '文本3']
const results = await classifier.batchClassify(texts)
```

### 2. 缓存结果

```typescript
const cache = new Map<string, ClassifyResult>()

async function classifyWithCache(text: string) {
  if (cache.has(text)) {
    return cache.get(text)
  }
  
  const result = await classifier.classify(text)
  cache.set(text, result)
  return result
}
```

### 3. 离线模型

```typescript
// 加载离线模型
const classifier = textClassifier.create({
  modelPath: '/data/storage/el2/base/files/nlp_model.ms',
  offline: true
})
```

## 📚 参考资源

- [AI能力开发](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ai-development-intro-0000001820880589-V5)

---

**下一节** → [AI模型集成](06-AI模型集成.md)
