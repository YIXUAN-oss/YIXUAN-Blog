import{_ as s,c as a,d as e,o as l}from"./app-CJnNnfV_.js";const p={};function t(i,n){return l(),a("div",null,[...n[0]||(n[0]=[e(`<h1 id="eureka服务注册" tabindex="-1"><a class="header-anchor" href="#eureka服务注册"><span>Eureka服务注册</span></a></h1><h2 id="一、eureka简介" tabindex="-1"><a class="header-anchor" href="#一、eureka简介"><span>一、Eureka简介</span></a></h2><h3 id="_1-1-什么是eureka" tabindex="-1"><a class="header-anchor" href="#_1-1-什么是eureka"><span>1.1 什么是Eureka？</span></a></h3><p><strong>Eureka</strong> 是 Netflix 开源的服务注册与发现组件，Spring Cloud 将其集成在 spring-cloud-netflix 中。</p><p><strong>核心功能：</strong></p><ul><li>服务注册</li><li>服务发现</li><li>健康检查</li><li>负载均衡</li></ul><h3 id="_1-2-eureka架构" tabindex="-1"><a class="header-anchor" href="#_1-2-eureka架构"><span>1.2 Eureka架构</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">┌──────────────┐     注册      ┌──────────────┐</span>
<span class="line">│ 服务提供者    │ ──────────→  │ Eureka Server│</span>
<span class="line">│ Provider     │               │  注册中心     │</span>
<span class="line">└──────────────┘               └──────┬───────┘</span>
<span class="line">                                      │</span>
<span class="line">                               获取服务列表</span>
<span class="line">                                      │</span>
<span class="line">┌──────────────┐               ┌─────▼────────┐</span>
<span class="line">│ 服务消费者    │ ←───调用────  │ 服务消费者    │</span>
<span class="line">│ Consumer     │               │              │</span>
<span class="line">└──────────────┘               └──────────────┘</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>核心概念：</strong></p><ul><li><strong>Eureka Server</strong>：注册中心，管理所有服务</li><li><strong>Eureka Client</strong>：服务提供者和消费者</li><li><strong>服务注册</strong>：服务启动时注册到 Eureka</li><li><strong>服务发现</strong>：从 Eureka 获取服务列表</li><li><strong>心跳续约</strong>：定时发送心跳保持注册状态</li></ul><hr><h2 id="二、搭建eureka-server" tabindex="-1"><a class="header-anchor" href="#二、搭建eureka-server"><span>二、搭建Eureka Server</span></a></h2><h3 id="_2-1-创建模块" tabindex="-1"><a class="header-anchor" href="#_2-1-创建模块"><span>2.1 创建模块</span></a></h3><p><strong>pom.xml：</strong></p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-eureka-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-配置文件" tabindex="-1"><a class="header-anchor" href="#_2-2-配置文件"><span>2.2 配置文件</span></a></h3><p><strong>application.yml：</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7001</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">eureka</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">instance</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> localhost</span>
<span class="line">  <span class="token key atrule">client</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 是否注册自己</span></span>
<span class="line">    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span></span>
<span class="line">    <span class="token comment"># 是否从Eureka获取服务列表</span></span>
<span class="line">    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span></span>
<span class="line">    <span class="token key atrule">service-url</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//$<span class="token punctuation">{</span>eureka.instance.hostname<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>server.port<span class="token punctuation">}</span>/eureka</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-启动类" tabindex="-1"><a class="header-anchor" href="#_2-3-启动类"><span>2.3 启动类</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@SpringBootApplication</span></span>
<span class="line"><span class="token annotation punctuation">@EnableEurekaServer</span>  <span class="token comment">// 启用 Eureka Server</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EurekaServerApplication</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">EurekaServerApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-访问控制台" tabindex="-1"><a class="header-anchor" href="#_2-4-访问控制台"><span>2.4 访问控制台</span></a></h3><p>启动后访问：http://localhost:7001</p><hr><h2 id="三、服务注册" tabindex="-1"><a class="header-anchor" href="#三、服务注册"><span>三、服务注册</span></a></h2><h3 id="_3-1-添加依赖" tabindex="-1"><a class="header-anchor" href="#_3-1-添加依赖"><span>3.1 添加依赖</span></a></h3><p><strong>用户服务 pom.xml：</strong></p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-eureka-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-配置文件" tabindex="-1"><a class="header-anchor" href="#_3-2-配置文件"><span>3.2 配置文件</span></a></h3><p><strong>application.yml：</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8001</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">application</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> user<span class="token punctuation">-</span>service  <span class="token comment"># 服务名称</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">eureka</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">client</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">service-url</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka</span>
<span class="line">  <span class="token key atrule">instance</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 显示IP地址</span></span>
<span class="line">    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">    <span class="token comment"># 实例ID</span></span>
<span class="line">    <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>spring.application.name<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>server.port<span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-启动类" tabindex="-1"><a class="header-anchor" href="#_3-3-启动类"><span>3.3 启动类</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@SpringBootApplication</span></span>
<span class="line"><span class="token annotation punctuation">@EnableEurekaClient</span>  <span class="token comment">// 启用 Eureka Client</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceApplication</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">UserServiceApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="四、服务发现" tabindex="-1"><a class="header-anchor" href="#四、服务发现"><span>四、服务发现</span></a></h2><h3 id="_4-1-创建订单服务" tabindex="-1"><a class="header-anchor" href="#_4-1-创建订单服务"><span>4.1 创建订单服务</span></a></h3><p><strong>application.yml：</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8002</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">application</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> order<span class="token punctuation">-</span>service</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">eureka</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">client</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">service-url</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-配置resttemplate" tabindex="-1"><a class="header-anchor" href="#_4-2-配置resttemplate"><span>4.2 配置RestTemplate</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Configuration</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestTemplateConfig</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line">    <span class="token annotation punctuation">@Bean</span></span>
<span class="line">    <span class="token annotation punctuation">@LoadBalanced</span>  <span class="token comment">// 负载均衡</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-服务调用" tabindex="-1"><a class="header-anchor" href="#_4-3-服务调用"><span>4.3 服务调用</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@RestController</span></span>
<span class="line"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api/orders&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line">    <span class="token annotation punctuation">@Autowired</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Order</span><span class="token punctuation">&gt;</span></span> <span class="token function">getOrderById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 通过服务名调用</span></span>
<span class="line">        <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token string">&quot;http://user-service/api/users/1&quot;</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">Result</span> userResult <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        order<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        order<span class="token punctuation">.</span><span class="token function">setOrderNo</span><span class="token punctuation">(</span><span class="token string">&quot;ORDER-&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        order<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>userResult<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="五、eureka高可用" tabindex="-1"><a class="header-anchor" href="#五、eureka高可用"><span>五、Eureka高可用</span></a></h2><h3 id="_5-1-多实例配置" tabindex="-1"><a class="header-anchor" href="#_5-1-多实例配置"><span>5.1 多实例配置</span></a></h3><p><strong>Eureka Server 1（application-eureka1.yml）：</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7001</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">eureka</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">instance</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> eureka1</span>
<span class="line">  <span class="token key atrule">client</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">service-url</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka2<span class="token punctuation">:</span>7002/eureka</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Eureka Server 2（application-eureka2.yml）：</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7002</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">eureka</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">instance</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> eureka2</span>
<span class="line">  <span class="token key atrule">client</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">service-url</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka1<span class="token punctuation">:</span>7001/eureka</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>客户端配置：</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">eureka</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">client</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">service-url</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka1<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka2<span class="token punctuation">:</span>7002/eureka</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="六、自我保护机制" tabindex="-1"><a class="header-anchor" href="#六、自我保护机制"><span>六、自我保护机制</span></a></h2><h3 id="_6-1-什么是自我保护" tabindex="-1"><a class="header-anchor" href="#_6-1-什么是自我保护"><span>6.1 什么是自我保护？</span></a></h3><p>当 Eureka Server 在短时间内丢失过多客户端心跳时，会进入自我保护模式，不再剔除服务。</p><p><strong>触发条件：</strong></p><ul><li>15分钟内心跳失败比例 &gt; 85%</li></ul><h3 id="_6-2-关闭自我保护" tabindex="-1"><a class="header-anchor" href="#_6-2-关闭自我保护"><span>6.2 关闭自我保护</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">eureka</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 关闭自我保护（生产环境不推荐）</span></span>
<span class="line">    <span class="token key atrule">enable-self-preservation</span><span class="token punctuation">:</span> <span class="token boolean important">false</span></span>
<span class="line">    <span class="token comment"># 剔除间隔（默认60秒）</span></span>
<span class="line">    <span class="token key atrule">eviction-interval-timer-in-ms</span><span class="token punctuation">:</span> <span class="token number">2000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="七、总结" tabindex="-1"><a class="header-anchor" href="#七、总结"><span>七、总结</span></a></h2><p>✅ <strong>本章学习内容：</strong></p><ul><li>Eureka 架构</li><li>搭建 Eureka Server</li><li>服务注册</li><li>服务发现</li><li>Eureka 高可用</li><li>自我保护机制</li></ul><p>✅ <strong>核心要点：</strong></p><ul><li>Eureka Server 是注册中心</li><li>服务通过服务名调用</li><li>支持高可用集群</li></ul><p><strong>下一章预告：</strong> 我们将学习 Ribbon 负载均衡。</p>`,65)])])}const o=s(p,[["render",t]]),u=JSON.parse('{"path":"/tutorials/java-backend/springcloud/2.Eurekafuwuzhuce.html","title":"Eureka服务注册","lang":"zh-CN","frontmatter":{"title":"Eureka服务注册"},"headers":[{"level":2,"title":"一、Eureka简介","slug":"一、eureka简介","link":"#一、eureka简介","children":[{"level":3,"title":"1.1 什么是Eureka？","slug":"_1-1-什么是eureka","link":"#_1-1-什么是eureka","children":[]},{"level":3,"title":"1.2 Eureka架构","slug":"_1-2-eureka架构","link":"#_1-2-eureka架构","children":[]}]},{"level":2,"title":"二、搭建Eureka Server","slug":"二、搭建eureka-server","link":"#二、搭建eureka-server","children":[{"level":3,"title":"2.1 创建模块","slug":"_2-1-创建模块","link":"#_2-1-创建模块","children":[]},{"level":3,"title":"2.2 配置文件","slug":"_2-2-配置文件","link":"#_2-2-配置文件","children":[]},{"level":3,"title":"2.3 启动类","slug":"_2-3-启动类","link":"#_2-3-启动类","children":[]},{"level":3,"title":"2.4 访问控制台","slug":"_2-4-访问控制台","link":"#_2-4-访问控制台","children":[]}]},{"level":2,"title":"三、服务注册","slug":"三、服务注册","link":"#三、服务注册","children":[{"level":3,"title":"3.1 添加依赖","slug":"_3-1-添加依赖","link":"#_3-1-添加依赖","children":[]},{"level":3,"title":"3.2 配置文件","slug":"_3-2-配置文件","link":"#_3-2-配置文件","children":[]},{"level":3,"title":"3.3 启动类","slug":"_3-3-启动类","link":"#_3-3-启动类","children":[]}]},{"level":2,"title":"四、服务发现","slug":"四、服务发现","link":"#四、服务发现","children":[{"level":3,"title":"4.1 创建订单服务","slug":"_4-1-创建订单服务","link":"#_4-1-创建订单服务","children":[]},{"level":3,"title":"4.2 配置RestTemplate","slug":"_4-2-配置resttemplate","link":"#_4-2-配置resttemplate","children":[]},{"level":3,"title":"4.3 服务调用","slug":"_4-3-服务调用","link":"#_4-3-服务调用","children":[]}]},{"level":2,"title":"五、Eureka高可用","slug":"五、eureka高可用","link":"#五、eureka高可用","children":[{"level":3,"title":"5.1 多实例配置","slug":"_5-1-多实例配置","link":"#_5-1-多实例配置","children":[]}]},{"level":2,"title":"六、自我保护机制","slug":"六、自我保护机制","link":"#六、自我保护机制","children":[{"level":3,"title":"6.1 什么是自我保护？","slug":"_6-1-什么是自我保护","link":"#_6-1-什么是自我保护","children":[]},{"level":3,"title":"6.2 关闭自我保护","slug":"_6-2-关闭自我保护","link":"#_6-2-关闭自我保护","children":[]}]},{"level":2,"title":"七、总结","slug":"七、总结","link":"#七、总结","children":[]}],"git":{"createdTime":1760959407000,"updatedTime":1760959407000,"contributors":[{"name":"YIXUAN","email":"byyi.xuan@outlook.com","commits":1}]},"filePathRelative":"tutorials/java-backend/springcloud/2.Eureka服务注册.md"}');export{o as comp,u as data};
