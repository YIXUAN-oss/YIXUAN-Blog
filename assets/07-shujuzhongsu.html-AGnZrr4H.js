import{_ as t,c as e,d as l,e as s,f as a,b as i,w as c,r as o,o as u}from"./app-DnBTedau.js";const r={};function d(k,n){const p=o("RouteLink");return u(),e("div",null,[n[3]||(n[3]=l(`<h1 id="数据重塑" tabindex="-1"><a class="header-anchor" href="#数据重塑"><span>数据重塑</span></a></h1><blockquote><p>掌握数据透视和重塑技巧</p></blockquote><h2 id="📚-学习目标" tabindex="-1"><a class="header-anchor" href="#📚-学习目标"><span>📚 学习目标</span></a></h2><ul><li>掌握pivot透视表</li><li>学会melt宽转长</li><li>理解stack和unstack</li><li>掌握交叉表</li></ul><h2 id="_1-pivot透视" tabindex="-1"><a class="header-anchor" href="#_1-pivot透视"><span>1. pivot透视</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;date&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;2024-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2024-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2024-02&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2024-02&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;product&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;sales&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 透视</span></span>
<span class="line">pivoted <span class="token operator">=</span> df<span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>pivoted<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-pivot-table" tabindex="-1"><a class="header-anchor" href="#_2-pivot-table"><span>2. pivot_table</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 透视表with聚合</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span></span>
<span class="line">    values<span class="token operator">=</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    index<span class="token operator">=</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    columns<span class="token operator">=</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    aggfunc<span class="token operator">=</span><span class="token string">&#39;sum&#39;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-melt宽转长" tabindex="-1"><a class="header-anchor" href="#_3-melt宽转长"><span>3. melt宽转长</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;B&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 宽转长</span></span>
<span class="line">melted <span class="token operator">=</span> df<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> var_name<span class="token operator">=</span><span class="token string">&#39;variable&#39;</span><span class="token punctuation">,</span> value_name<span class="token operator">=</span><span class="token string">&#39;value&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>melted<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-stack和unstack" tabindex="-1"><a class="header-anchor" href="#_4-stack和unstack"><span>4. stack和unstack</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;B&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;X&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Y&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># stack - 列转行</span></span>
<span class="line">stacked <span class="token operator">=</span> df<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># unstack - 行转列</span></span>
<span class="line">unstacked <span class="token operator">=</span> stacked<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,13)),s("p",null,[n[1]||(n[1]=s("strong",null,"下一节：",-1)),n[2]||(n[2]=a()),i(p,{to:"/tutorials/python-ai/pandas/08-%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.html"},{default:c(()=>[...n[0]||(n[0]=[a("时间序列",-1)])]),_:1})])])}const m=t(r,[["render",d]]),b=JSON.parse('{"path":"/tutorials/python-ai/pandas/07-shujuzhongsu.html","title":"数据重塑","lang":"zh-CN","frontmatter":{"title":"数据重塑"},"headers":[{"level":2,"title":"📚 学习目标","slug":"📚-学习目标","link":"#📚-学习目标","children":[]},{"level":2,"title":"1. pivot透视","slug":"_1-pivot透视","link":"#_1-pivot透视","children":[]},{"level":2,"title":"2. pivot_table","slug":"_2-pivot-table","link":"#_2-pivot-table","children":[]},{"level":2,"title":"3. melt宽转长","slug":"_3-melt宽转长","link":"#_3-melt宽转长","children":[]},{"level":2,"title":"4. stack和unstack","slug":"_4-stack和unstack","link":"#_4-stack和unstack","children":[]}],"git":{"createdTime":1761052725000,"updatedTime":1761052725000,"contributors":[{"name":"YIXUAN","email":"byyi.xuan@outlook.com","commits":1}]},"filePathRelative":"tutorials/python-ai/pandas/07-数据重塑.md"}');export{m as comp,b as data};
