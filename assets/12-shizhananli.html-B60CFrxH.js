import{_ as e,c,d as o,e as l,f as s,b as p,w as t,r as i,o as u}from"./app-I6OnLCmc.js";const k={};function r(d,n){const a=i("RouteLink");return u(),c("div",null,[n[4]||(n[4]=o(`<h1 id="实战案例" tabindex="-1"><a class="header-anchor" href="#实战案例"><span>实战案例</span></a></h1><blockquote><p>通过实战项目掌握Pandas</p></blockquote><h2 id="📚-学习目标" tabindex="-1"><a class="header-anchor" href="#📚-学习目标"><span>📚 学习目标</span></a></h2><ul><li>应用Pandas解决实际问题</li><li>掌握完整数据分析流程</li><li>学会综合运用所学知识</li></ul><h2 id="_1-销售数据分析" tabindex="-1"><a class="header-anchor" href="#_1-销售数据分析"><span>1. 销售数据分析</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 加载数据</span></span>
<span class="line">sales <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;sales.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 数据清洗</span></span>
<span class="line">sales<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>sales<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">sales <span class="token operator">=</span> sales<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">sales <span class="token operator">=</span> sales<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 数据分析</span></span>
<span class="line">monthly_sales <span class="token operator">=</span> sales<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>sales<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>to_period<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;amount&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;quantity&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 计算增长率</span></span>
<span class="line">monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;growth&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 可视化</span></span>
<span class="line">monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Monthly Sales Trend&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-用户行为分析" tabindex="-1"><a class="header-anchor" href="#_2-用户行为分析"><span>2. 用户行为分析</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 加载用户行为数据</span></span>
<span class="line">users <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;user_behavior.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 活跃用户分析</span></span>
<span class="line">daily_active <span class="token operator">=</span> users<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 留存率计算</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">calculate_retention</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> days<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    first_day <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> first_day <span class="token operator">+</span> pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>days<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">retention_7d <span class="token operator">=</span> calculate_retention<span class="token punctuation">(</span>users<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-股票数据分析" tabindex="-1"><a class="header-anchor" href="#_3-股票数据分析"><span>3. 股票数据分析</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 加载股票数据</span></span>
<span class="line">stocks <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;stocks.csv&#39;</span><span class="token punctuation">,</span> parse_dates<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">stocks <span class="token operator">=</span> stocks<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 计算收益率</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;return&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 移动平均</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;MA20&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;MA60&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 波动率</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;volatility&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;return&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">252</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 可视化</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;MA20&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;MA60&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-文本数据处理" tabindex="-1"><a class="header-anchor" href="#_4-文本数据处理"><span>4. 文本数据处理</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 加载评论数据</span></span>
<span class="line">reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;reviews.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 文本清洗</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39;[^a-zA-Z]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 提取关键词</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;word_count&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 情感分类</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">classify_sentiment</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    positive_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;good&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;great&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;excellent&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    negative_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;bad&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;poor&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;terrible&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>word <span class="token keyword">in</span> text<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> word <span class="token keyword">in</span> positive_words<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;positive&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token builtin">any</span><span class="token punctuation">(</span>word <span class="token keyword">in</span> text<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> word <span class="token keyword">in</span> negative_words<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;negative&#39;</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;neutral&#39;</span></span>
<span class="line"></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>classify_sentiment<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 统计分析</span></span>
<span class="line">sentiment_counts <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-综合项目-电商数据分析" tabindex="-1"><a class="header-anchor" href="#_5-综合项目-电商数据分析"><span>5. 综合项目：电商数据分析</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 1. 数据加载</span></span>
<span class="line">orders <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;orders.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line">customers <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;customers.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line">products <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;products.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. 数据清洗</span></span>
<span class="line">orders<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>orders<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">orders <span class="token operator">=</span> orders<span class="token punctuation">[</span>orders<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. 数据合并</span></span>
<span class="line">data <span class="token operator">=</span> orders<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>customers<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">)</span></span>
<span class="line">data <span class="token operator">=</span> data<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>products<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;product_id&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. 特征工程</span></span>
<span class="line">data<span class="token punctuation">[</span><span class="token string">&#39;year_month&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>to_period<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span></span>
<span class="line">data<span class="token punctuation">[</span><span class="token string">&#39;day_of_week&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>dayofweek</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 5. 分析指标</span></span>
<span class="line"><span class="token comment"># 销售趋势</span></span>
<span class="line">sales_trend <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;year_month&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 客户价值分析</span></span>
<span class="line">customer_value <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;order_id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;count&#39;</span><span class="token punctuation">,</span>      <span class="token comment"># 订单数</span></span>
<span class="line">    <span class="token string">&#39;amount&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span><span class="token punctuation">,</span>          <span class="token comment"># 总金额</span></span>
<span class="line">    <span class="token string">&#39;order_date&#39;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>days  <span class="token comment"># 活跃天数</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">customer_value<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;order_count&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;total_amount&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;active_days&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># RFM分析</span></span>
<span class="line">latest_date <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">rfm <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;order_date&#39;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>latest_date <span class="token operator">-</span> x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>days<span class="token punctuation">,</span>  <span class="token comment"># Recency</span></span>
<span class="line">    <span class="token string">&#39;order_id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;count&#39;</span><span class="token punctuation">,</span>                                    <span class="token comment"># Frequency</span></span>
<span class="line">    <span class="token string">&#39;amount&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span>                                         <span class="token comment"># Monetary</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;recency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;frequency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;monetary&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 客户分层</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;r_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>qcut<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;recency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;f_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>qcut<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;frequency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rank<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">&#39;first&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;m_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>qcut<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;monetary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;rfm_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> rfm<span class="token punctuation">[</span><span class="token string">&#39;r_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">+</span> rfm<span class="token punctuation">[</span><span class="token string">&#39;f_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">+</span> rfm<span class="token punctuation">[</span><span class="token string">&#39;m_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 6. 可视化</span></span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"></span>
<span class="line">fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 销售趋势</span></span>
<span class="line">sales_trend<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Sales Trend&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 产品类别分布</span></span>
<span class="line">data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;pie&#39;</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Sales by Category&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 客户价值分布</span></span>
<span class="line">customer_value<span class="token punctuation">[</span><span class="token string">&#39;total_amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>hist<span class="token punctuation">(</span>bins<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;Customer Value Distribution&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># RFM得分分布</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;rfm_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Top 10 RFM Segments&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&#39;ecommerce_analysis.png&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 7. 生成报表</span></span>
<span class="line">report <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;总销售额&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;总订单数&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;客户总数&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;平均客单价&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;order_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;复购率&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>customer_value<span class="token punctuation">[</span><span class="token string">&#39;order_count&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>customer_value<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\\n=== 数据分析报表 ===&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> report<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token format-spec">,.2f</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="💡-总结" tabindex="-1"><a class="header-anchor" href="#💡-总结"><span>💡 总结</span></a></h2><p>通过这些实战案例，你应该掌握了：</p><ol><li><strong>完整的数据分析流程</strong> - 从数据加载到结果输出</li><li><strong>数据清洗技巧</strong> - 处理缺失值、异常值、重复数据</li><li><strong>特征工程</strong> - 提取和构造有用的特征</li><li><strong>数据分析方法</strong> - 分组、聚合、透视等</li><li><strong>可视化技巧</strong> - 使用图表展示分析结果</li><li><strong>业务洞察</strong> - 从数据中发现业务价值</li></ol><h2 id="练习项目" tabindex="-1"><a class="header-anchor" href="#练习项目"><span>练习项目</span></a></h2><ol><li>分析Titanic数据集，预测生存率</li><li>分析房价数据，找出影响因素</li><li>分析电影评分数据，推荐系统</li><li>分析天气数据，预测趋势</li></ol><hr><p><strong>恭喜完成 Pandas 教程！</strong> 🎉</p>`,21)),l("p",null,[n[2]||(n[2]=s("继续学习：",-1)),p(a,{to:"/tutorials/python-ai/matplotlib/"},{default:t(()=>[...n[0]||(n[0]=[s("Matplotlib 数据可视化",-1)])]),_:1}),n[3]||(n[3]=s(" 或 ",-1)),p(a,{to:"/tutorials/python-ai/ml-basics/"},{default:t(()=>[...n[1]||(n[1]=[s("机器学习基础",-1)])]),_:1})])])}const v=e(k,[["render",r]]),b=JSON.parse('{"path":"/tutorials/python-ai/pandas/12-shizhananli.html","title":"实战案例","lang":"zh-CN","frontmatter":{"title":"实战案例"},"headers":[{"level":2,"title":"📚 学习目标","slug":"📚-学习目标","link":"#📚-学习目标","children":[]},{"level":2,"title":"1. 销售数据分析","slug":"_1-销售数据分析","link":"#_1-销售数据分析","children":[]},{"level":2,"title":"2. 用户行为分析","slug":"_2-用户行为分析","link":"#_2-用户行为分析","children":[]},{"level":2,"title":"3. 股票数据分析","slug":"_3-股票数据分析","link":"#_3-股票数据分析","children":[]},{"level":2,"title":"4. 文本数据处理","slug":"_4-文本数据处理","link":"#_4-文本数据处理","children":[]},{"level":2,"title":"5. 综合项目：电商数据分析","slug":"_5-综合项目-电商数据分析","link":"#_5-综合项目-电商数据分析","children":[]},{"level":2,"title":"💡 总结","slug":"💡-总结","link":"#💡-总结","children":[]},{"level":2,"title":"练习项目","slug":"练习项目","link":"#练习项目","children":[]}],"git":{"createdTime":1761052725000,"updatedTime":1761052725000,"contributors":[{"name":"YIXUAN","email":"byyi.xuan@outlook.com","commits":1}]},"filePathRelative":"tutorials/python-ai/pandas/12-实战案例.md"}');export{v as comp,b as data};
