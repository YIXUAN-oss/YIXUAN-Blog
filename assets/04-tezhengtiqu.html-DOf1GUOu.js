import{_ as e,c as t,d as l,e as s,f as a,b as o,w as i,r as c,o as u}from"./app-CJnNnfV_.js";const r={};function d(k,n){const p=c("RouteLink");return u(),t("div",null,[n[3]||(n[3]=l(`<h1 id="特征提取" tabindex="-1"><a class="header-anchor" href="#特征提取"><span>特征提取</span></a></h1><blockquote><p>掌握图像特征提取方法</p></blockquote><h2 id="📚-学习目标" tabindex="-1"><a class="header-anchor" href="#📚-学习目标"><span>📚 学习目标</span></a></h2><ul><li>掌握角点检测</li><li>学会SIFT特征</li><li>了解SURF和ORB</li><li>掌握HOG特征</li></ul><h2 id="_1-harris角点检测" tabindex="-1"><a class="header-anchor" href="#_1-harris角点检测"><span>1. Harris角点检测</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line">gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span></span>
<span class="line">gray <span class="token operator">=</span> np<span class="token punctuation">.</span>float32<span class="token punctuation">(</span>gray<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Harris角点检测</span></span>
<span class="line">dst <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cornerHarris<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0.04</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 标记角点</span></span>
<span class="line">img<span class="token punctuation">[</span>dst <span class="token operator">&gt;</span> <span class="token number">0.01</span> <span class="token operator">*</span> dst<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-sift特征" tabindex="-1"><a class="header-anchor" href="#_2-sift特征"><span>2. SIFT特征</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 创建SIFT检测器</span></span>
<span class="line">sift <span class="token operator">=</span> cv2<span class="token punctuation">.</span>SIFT_create<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 检测关键点和描述符</span></span>
<span class="line">keypoints<span class="token punctuation">,</span> descriptors <span class="token operator">=</span> sift<span class="token punctuation">.</span>detectAndCompute<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 绘制关键点</span></span>
<span class="line">img_kp <span class="token operator">=</span> cv2<span class="token punctuation">.</span>drawKeypoints<span class="token punctuation">(</span>img<span class="token punctuation">,</span> keypoints<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span></span>
<span class="line">                            flags<span class="token operator">=</span>cv2<span class="token punctuation">.</span>DRAW_MATCHES_FLAGS_DRAW_RICH_KEYPOINTS<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">&#39;SIFT Keypoints&#39;</span><span class="token punctuation">,</span> img_kp<span class="token punctuation">)</span></span>
<span class="line">cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-orb特征" tabindex="-1"><a class="header-anchor" href="#_3-orb特征"><span>3. ORB特征</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 创建ORB检测器</span></span>
<span class="line">orb <span class="token operator">=</span> cv2<span class="token punctuation">.</span>ORB_create<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 检测和计算</span></span>
<span class="line">keypoints<span class="token punctuation">,</span> descriptors <span class="token operator">=</span> orb<span class="token punctuation">.</span>detectAndCompute<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 绘制</span></span>
<span class="line">img_kp <span class="token operator">=</span> cv2<span class="token punctuation">.</span>drawKeypoints<span class="token punctuation">(</span>img<span class="token punctuation">,</span> keypoints<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-hog特征" tabindex="-1"><a class="header-anchor" href="#_4-hog特征"><span>4. HOG特征</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> skimage<span class="token punctuation">.</span>feature <span class="token keyword">import</span> hog</span>
<span class="line"><span class="token keyword">from</span> skimage <span class="token keyword">import</span> exposure</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 计算HOG特征</span></span>
<span class="line">fd<span class="token punctuation">,</span> hog_image <span class="token operator">=</span> hog<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> orientations<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> pixels_per_cell<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    cells_per_block<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> visualize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 增强对比度</span></span>
<span class="line">hog_image <span class="token operator">=</span> exposure<span class="token punctuation">.</span>rescale_intensity<span class="token punctuation">(</span>hog_image<span class="token punctuation">,</span> in_range<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,13)),s("p",null,[n[1]||(n[1]=s("strong",null,"下一节：",-1)),n[2]||(n[2]=a()),o(p,{to:"/tutorials/python-ai/cv/05-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB.html"},{default:i(()=>[...n[0]||(n[0]=[a("图像分类",-1)])]),_:1})])])}const v=e(r,[["render",d]]),b=JSON.parse('{"path":"/tutorials/python-ai/cv/04-tezhengtiqu.html","title":"特征提取","lang":"zh-CN","frontmatter":{"title":"特征提取"},"headers":[{"level":2,"title":"📚 学习目标","slug":"📚-学习目标","link":"#📚-学习目标","children":[]},{"level":2,"title":"1. Harris角点检测","slug":"_1-harris角点检测","link":"#_1-harris角点检测","children":[]},{"level":2,"title":"2. SIFT特征","slug":"_2-sift特征","link":"#_2-sift特征","children":[]},{"level":2,"title":"3. ORB特征","slug":"_3-orb特征","link":"#_3-orb特征","children":[]},{"level":2,"title":"4. HOG特征","slug":"_4-hog特征","link":"#_4-hog特征","children":[]}],"git":{"createdTime":1761052725000,"updatedTime":1761052725000,"contributors":[{"name":"YIXUAN","email":"byyi.xuan@outlook.com","commits":1}]},"filePathRelative":"tutorials/python-ai/cv/04-特征提取.md"}');export{v as comp,b as data};
