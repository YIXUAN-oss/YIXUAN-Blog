import{_ as e,c as t,d as l,e as s,f as a,b as i,w as o,r as c,o as u}from"./app-CJnNnfV_.js";const r={};function d(k,n){const p=c("RouteLink");return u(),t("div",null,[n[3]||(n[3]=l(`<h1 id="词向量" tabindex="-1"><a class="header-anchor" href="#词向量"><span>词向量</span></a></h1><blockquote><p>掌握词向量表示和应用</p></blockquote><h2 id="📚-学习目标" tabindex="-1"><a class="header-anchor" href="#📚-学习目标"><span>📚 学习目标</span></a></h2><ul><li>理解词向量概念</li><li>掌握TF-IDF</li><li>学会Word2Vec</li><li>了解GloVe和FastText</li></ul><h2 id="_1-词袋模型" tabindex="-1"><a class="header-anchor" href="#_1-词袋模型"><span>1. 词袋模型</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> CountVectorizer</span>
<span class="line"></span>
<span class="line">corpus <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&#39;我 爱 自然语言处理&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;深度学习 很 有趣&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;自然语言处理 使用 深度学习&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">vectorizer <span class="token operator">=</span> CountVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>corpus<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;词汇表:&quot;</span><span class="token punctuation">,</span> vectorizer<span class="token punctuation">.</span>get_feature_names_out<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;向量:\\n&quot;</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-tf-idf" tabindex="-1"><a class="header-anchor" href="#_2-tf-idf"><span>2. TF-IDF</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer</span>
<span class="line"></span>
<span class="line">tfidf <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X <span class="token operator">=</span> tfidf<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>corpus<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;TF-IDF:\\n&quot;</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看特征权重</span></span>
<span class="line">feature_names <span class="token operator">=</span> tfidf<span class="token punctuation">.</span>get_feature_names_out<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> doc_idx<span class="token punctuation">,</span> doc <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\\n文档 </span><span class="token interpolation"><span class="token punctuation">{</span>doc_idx<span class="token punctuation">}</span></span><span class="token string">:&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> score <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> score <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  </span><span class="token interpolation"><span class="token punctuation">{</span>feature_names<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>score<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-word2vec" tabindex="-1"><a class="header-anchor" href="#_3-word2vec"><span>3. Word2Vec</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> gensim<span class="token punctuation">.</span>models <span class="token keyword">import</span> Word2Vec</span>
<span class="line"><span class="token keyword">import</span> jieba</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 准备数据</span></span>
<span class="line">sentences <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token builtin">list</span><span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span><span class="token string">&quot;我爱自然语言处理&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token builtin">list</span><span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span><span class="token string">&quot;深度学习很有趣&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token builtin">list</span><span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span><span class="token string">&quot;机器学习是人工智能的分支&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练模型</span></span>
<span class="line">model <span class="token operator">=</span> Word2Vec<span class="token punctuation">(</span>sentences<span class="token punctuation">,</span> </span>
<span class="line">                 vector_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>  <span class="token comment"># 词向量维度</span></span>
<span class="line">                 window<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>         <span class="token comment"># 上下文窗口</span></span>
<span class="line">                 min_count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>      <span class="token comment"># 最小词频</span></span>
<span class="line">                 workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>        <span class="token comment"># 线程数</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 获取词向量</span></span>
<span class="line">vector <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">[</span><span class="token string">&#39;自然语言处理&#39;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;词向量:&quot;</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 相似词</span></span>
<span class="line">similar <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">&#39;深度学习&#39;</span><span class="token punctuation">,</span> topn<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;相似词:&quot;</span><span class="token punctuation">,</span> similar<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 词语相似度</span></span>
<span class="line">similarity <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">.</span>similarity<span class="token punctuation">(</span><span class="token string">&#39;深度学习&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;机器学习&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;相似度:&quot;</span><span class="token punctuation">,</span> similarity<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 保存和加载</span></span>
<span class="line">model<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;word2vec.model&#39;</span><span class="token punctuation">)</span></span>
<span class="line">model <span class="token operator">=</span> Word2Vec<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&#39;word2vec.model&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-使用预训练词向量" tabindex="-1"><a class="header-anchor" href="#_4-使用预训练词向量"><span>4. 使用预训练词向量</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> gensim<span class="token punctuation">.</span>models <span class="token keyword">import</span> KeyedVectors</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 加载预训练模型</span></span>
<span class="line"><span class="token comment"># 下载: https://github.com/Embedding/Chinese-Word-Vectors</span></span>
<span class="line">model <span class="token operator">=</span> KeyedVectors<span class="token punctuation">.</span>load_word2vec_format<span class="token punctuation">(</span><span class="token string">&#39;sgns.wiki.word&#39;</span><span class="token punctuation">,</span> binary<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用</span></span>
<span class="line">vector <span class="token operator">=</span> model<span class="token punctuation">[</span><span class="token string">&#39;中国&#39;</span><span class="token punctuation">]</span></span>
<span class="line">similar <span class="token operator">=</span> model<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">&#39;中国&#39;</span><span class="token punctuation">,</span> topn<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-fasttext" tabindex="-1"><a class="header-anchor" href="#_5-fasttext"><span>5. FastText</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> gensim<span class="token punctuation">.</span>models <span class="token keyword">import</span> FastText</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练FastText</span></span>
<span class="line">model <span class="token operator">=</span> FastText<span class="token punctuation">(</span>sentences<span class="token punctuation">,</span> </span>
<span class="line">                 vector_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span></span>
<span class="line">                 window<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">                 min_count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 获取词向量（包括未登录词）</span></span>
<span class="line">vector <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">[</span><span class="token string">&#39;未登录词&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,15)),s("p",null,[n[1]||(n[1]=s("strong",null,"下一节：",-1)),n[2]||(n[2]=a()),i(p,{to:"/tutorials/python-ai/nlp/05-%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB.html"},{default:o(()=>[...n[0]||(n[0]=[a("文本分类",-1)])]),_:1})])])}const v=e(r,[["render",d]]),b=JSON.parse('{"path":"/tutorials/python-ai/nlp/04-cixiangliang.html","title":"词向量","lang":"zh-CN","frontmatter":{"title":"词向量"},"headers":[{"level":2,"title":"📚 学习目标","slug":"📚-学习目标","link":"#📚-学习目标","children":[]},{"level":2,"title":"1. 词袋模型","slug":"_1-词袋模型","link":"#_1-词袋模型","children":[]},{"level":2,"title":"2. TF-IDF","slug":"_2-tf-idf","link":"#_2-tf-idf","children":[]},{"level":2,"title":"3. Word2Vec","slug":"_3-word2vec","link":"#_3-word2vec","children":[]},{"level":2,"title":"4. 使用预训练词向量","slug":"_4-使用预训练词向量","link":"#_4-使用预训练词向量","children":[]},{"level":2,"title":"5. FastText","slug":"_5-fasttext","link":"#_5-fasttext","children":[]}],"git":{"createdTime":1761052725000,"updatedTime":1761052725000,"contributors":[{"name":"YIXUAN","email":"byyi.xuan@outlook.com","commits":1}]},"filePathRelative":"tutorials/python-ai/nlp/04-词向量.md"}');export{v as comp,b as data};
