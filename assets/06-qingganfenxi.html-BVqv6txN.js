import{_ as t,c as e,d as l,e as s,f as a,b as o,w as i,r as c,o as u}from"./app-QnWV-YHu.js";const r={};function k(d,n){const p=c("RouteLink");return u(),e("div",null,[n[3]||(n[3]=l(`<h1 id="情感分析" tabindex="-1"><a class="header-anchor" href="#情感分析"><span>情感分析</span></a></h1><blockquote><p>掌握情感分析技术和应用</p></blockquote><h2 id="📚-学习目标" tabindex="-1"><a class="header-anchor" href="#📚-学习目标"><span>📚 学习目标</span></a></h2><ul><li>理解情感分析</li><li>掌握基于词典的方法</li><li>学会机器学习方法</li><li>了解深度学习方法</li></ul><h2 id="_1-基于词典的方法" tabindex="-1"><a class="header-anchor" href="#_1-基于词典的方法"><span>1. 基于词典的方法</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 使用SnowNLP</span></span>
<span class="line"><span class="token keyword">from</span> snownlp <span class="token keyword">import</span> SnowNLP</span>
<span class="line"></span>
<span class="line">text <span class="token operator">=</span> <span class="token string">&quot;这部电影真的太好看了！&quot;</span></span>
<span class="line">s <span class="token operator">=</span> SnowNLP<span class="token punctuation">(</span>text<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;情感得分: </span><span class="token interpolation"><span class="token punctuation">{</span>s<span class="token punctuation">.</span>sentiments<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># 0-1之间</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 自定义情感词典</span></span>
<span class="line">positive_words <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;好&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;棒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;优秀&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;喜欢&#39;</span><span class="token punctuation">}</span></span>
<span class="line">negative_words <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;差&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;烂&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;讨厌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;失望&#39;</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">sentiment_score</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    words <span class="token operator">=</span> jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>text<span class="token punctuation">)</span></span>
<span class="line">    pos_count <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">for</span> w <span class="token keyword">in</span> words <span class="token keyword">if</span> w <span class="token keyword">in</span> positive_words<span class="token punctuation">)</span></span>
<span class="line">    neg_count <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">for</span> w <span class="token keyword">in</span> words <span class="token keyword">if</span> w <span class="token keyword">in</span> negative_words<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> pos_count <span class="token operator">&gt;</span> neg_count<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;positive&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> neg_count <span class="token operator">&gt;</span> pos_count<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;negative&#39;</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;neutral&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-机器学习方法" tabindex="-1"><a class="header-anchor" href="#_2-机器学习方法"><span>2. 机器学习方法</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练数据</span></span>
<span class="line">train_texts <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&quot;这个产品质量很好&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;服务态度太差了&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;性价比很高&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;完全不值这个价格&quot;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line">train_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 1-正面, 0-负面</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 特征提取</span></span>
<span class="line">vectorizer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X_train <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>train_texts<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练模型</span></span>
<span class="line">clf <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> train_labels<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 预测</span></span>
<span class="line">test_text <span class="token operator">=</span> <span class="token string">&quot;这个手机非常好用&quot;</span></span>
<span class="line">X_test <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token punctuation">[</span>test_text<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line">prob <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;预测: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;正面&#39;</span> <span class="token keyword">if</span> pred<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token string">&#39;负面&#39;</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;概率: 负面=</span><span class="token interpolation"><span class="token punctuation">{</span>prob<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">, 正面=</span><span class="token interpolation"><span class="token punctuation">{</span>prob<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-使用transformers" tabindex="-1"><a class="header-anchor" href="#_3-使用transformers"><span>3. 使用transformers</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> transformers <span class="token keyword">import</span> AutoTokenizer<span class="token punctuation">,</span> AutoModelForSequenceClassification</span>
<span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 加载预训练模型</span></span>
<span class="line">model_name <span class="token operator">=</span> <span class="token string">&quot;uer/roberta-base-finetuned-chinaNews-chinese&quot;</span></span>
<span class="line">tokenizer <span class="token operator">=</span> AutoTokenizer<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>model_name<span class="token punctuation">)</span></span>
<span class="line">model <span class="token operator">=</span> AutoModelForSequenceClassification<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>model_name<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 预测</span></span>
<span class="line">text <span class="token operator">=</span> <span class="token string">&quot;这个产品真的很不错&quot;</span></span>
<span class="line">inputs <span class="token operator">=</span> tokenizer<span class="token punctuation">(</span>text<span class="token punctuation">,</span> return_tensors<span class="token operator">=</span><span class="token string">&quot;pt&quot;</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> truncation<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">outputs <span class="token operator">=</span> model<span class="token punctuation">(</span><span class="token operator">**</span>inputs<span class="token punctuation">)</span></span>
<span class="line">predictions <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>logits<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;情感预测:&quot;</span><span class="token punctuation">,</span> predictions<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-实战-电商评论分析" tabindex="-1"><a class="header-anchor" href="#_4-实战-电商评论分析"><span>4. 实战：电商评论分析</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 加载评论数据</span></span>
<span class="line">reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;reviews.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 批量情感分析</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> SnowNLP<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>sentiments</span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 分类</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;label&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">&#39;positive&#39;</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0.6</span> <span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token string">&#39;negative&#39;</span> <span class="token keyword">if</span> x <span class="token operator">&lt;</span> <span class="token number">0.4</span> <span class="token keyword">else</span> <span class="token string">&#39;neutral&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 统计</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>reviews<span class="token punctuation">[</span><span class="token string">&#39;label&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 可视化</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;label&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Sentiment Distribution&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,13)),s("p",null,[n[1]||(n[1]=s("strong",null,"下一节：",-1)),n[2]||(n[2]=a()),o(p,{to:"/tutorials/python-ai/nlp/07-%E5%91%BD%E5%90%8D%E5%AE%9E%E4%BD%93%E8%AF%86%E5%88%AB.html"},{default:i(()=>[...n[0]||(n[0]=[a("命名实体识别",-1)])]),_:1})])])}const m=t(r,[["render",k]]),b=JSON.parse('{"path":"/tutorials/python-ai/nlp/06-qingganfenxi.html","title":"情感分析","lang":"zh-CN","frontmatter":{"title":"情感分析"},"headers":[{"level":2,"title":"📚 学习目标","slug":"📚-学习目标","link":"#📚-学习目标","children":[]},{"level":2,"title":"1. 基于词典的方法","slug":"_1-基于词典的方法","link":"#_1-基于词典的方法","children":[]},{"level":2,"title":"2. 机器学习方法","slug":"_2-机器学习方法","link":"#_2-机器学习方法","children":[]},{"level":2,"title":"3. 使用transformers","slug":"_3-使用transformers","link":"#_3-使用transformers","children":[]},{"level":2,"title":"4. 实战：电商评论分析","slug":"_4-实战-电商评论分析","link":"#_4-实战-电商评论分析","children":[]}],"git":{"createdTime":1761052725000,"updatedTime":1761052725000,"contributors":[{"name":"YIXUAN","email":"byyi.xuan@outlook.com","commits":1}]},"filePathRelative":"tutorials/python-ai/nlp/06-情感分析.md"}');export{m as comp,b as data};
