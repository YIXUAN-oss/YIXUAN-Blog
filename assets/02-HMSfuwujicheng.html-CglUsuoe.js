import{_ as i,c,d as o,e as s,f as a,b as e,w as u,r as t,o as r}from"./app-B1lgwjy6.js";const k={},d={href:"https://developer.huawei.com/consumer/cn/hms/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/account-login-0000001774120958-V5",target:"_blank",rel:"noopener noreferrer"};function m(h,n){const p=t("ExternalLinkIcon"),l=t("RouteLink");return r(),c("div",null,[n[5]||(n[5]=o(`<h1 id="hms服务集成" tabindex="-1"><a class="header-anchor" href="#hms服务集成"><span>HMS服务集成</span></a></h1><blockquote><p>集成HMS Core服务</p></blockquote><h2 id="🔐-账号服务" tabindex="-1"><a class="header-anchor" href="#🔐-账号服务"><span>🔐 账号服务</span></a></h2><h3 id="华为账号登录" tabindex="-1"><a class="header-anchor" href="#华为账号登录"><span>华为账号登录</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> authentication <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@kit.AccountKit&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">signInWithHuawei</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">authentication</span><span class="token punctuation">.</span><span class="token function">HuaweiIDProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createAuthorizationWithHuaweiIDRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    request<span class="token punctuation">.</span>scopes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;profile&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">authentication</span><span class="token punctuation">.</span><span class="token function">AuthenticationController</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> controller<span class="token punctuation">.</span><span class="token function">executeRequest</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">const</span> authCode <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token operator">?.</span>authorizationCode</span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;授权码:&#39;</span><span class="token punctuation">,</span> authCode<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 使用authCode换取token</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;登录失败:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="📬-推送服务" tabindex="-1"><a class="header-anchor" href="#📬-推送服务"><span>📬 推送服务</span></a></h2><h3 id="push-kit集成" tabindex="-1"><a class="header-anchor" href="#push-kit集成"><span>Push Kit集成</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> pushService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@kit.PushKit&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 获取Push Token</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getPushToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token keyword">await</span> pushService<span class="token punctuation">.</span><span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Push Token:&#39;</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 上传token到服务器</span></span>
<span class="line">    <span class="token keyword">await</span> <span class="token function">uploadTokenToServer</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;获取Token失败:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 接收推送消息</span></span>
<span class="line">pushService<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;pushMessage&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;收到推送:&#39;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 显示通知</span></span>
<span class="line">  <span class="token function">showNotification</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="📊-分析服务" tabindex="-1"><a class="header-anchor" href="#📊-分析服务"><span>📊 分析服务</span></a></h2><h3 id="analytics-kit" tabindex="-1"><a class="header-anchor" href="#analytics-kit"><span>Analytics Kit</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> hiAnalytics <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@kit.AnalyticsKit&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">AnalyticsService</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 初始化</span></span>
<span class="line">  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    hiAnalytics<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 记录事件</span></span>
<span class="line">  <span class="token function">logEvent</span><span class="token punctuation">(</span>eventName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> params<span class="token operator">:</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    hiAnalytics<span class="token punctuation">.</span><span class="token function">onEvent</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      eventId<span class="token operator">:</span> eventName<span class="token punctuation">,</span></span>
<span class="line">      params<span class="token operator">:</span> params</span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 记录页面访问</span></span>
<span class="line">  <span class="token function">logPageView</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    hiAnalytics<span class="token punctuation">.</span><span class="token function">pageStart</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      pageClassOverride<span class="token operator">:</span> pageName</span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 使用</span></span>
<span class="line"><span class="token keyword">const</span> analytics <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnalyticsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">analytics<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">analytics<span class="token punctuation">.</span><span class="token function">logEvent</span><span class="token punctuation">(</span><span class="token string">&#39;button_click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> button_name<span class="token operator">:</span> <span class="token string">&#39;login&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="📚-参考资源" tabindex="-1"><a class="header-anchor" href="#📚-参考资源"><span>📚 参考资源</span></a></h2>`,12)),s("ul",null,[s("li",null,[s("a",d,[n[0]||(n[0]=a("HMS Core服务",-1)),e(p)])]),s("li",null,[s("a",v,[n[1]||(n[1]=a("账号服务",-1)),e(p)])])]),n[6]||(n[6]=s("hr",null,null,-1)),s("p",null,[n[3]||(n[3]=s("strong",null,"下一节",-1)),n[4]||(n[4]=a(" → ",-1)),e(l,{to:"/tutorials/harmonyos-dev/17-harmony-ecology/03-%E7%94%9F%E6%80%81%E6%9C%BA%E4%BC%9A.html"},{default:u(()=>[...n[2]||(n[2]=[a("生态机会",-1)])]),_:1})])])}const g=i(k,[["render",m]]),y=JSON.parse('{"path":"/tutorials/harmonyos-dev/17-harmony-ecology/02-HMSfuwujicheng.html","title":"HMS服务集成","lang":"zh-CN","frontmatter":{"title":"HMS服务集成","date":"2025-01-22T00:00:00.000Z"},"headers":[{"level":2,"title":"🔐 账号服务","slug":"🔐-账号服务","link":"#🔐-账号服务","children":[{"level":3,"title":"华为账号登录","slug":"华为账号登录","link":"#华为账号登录","children":[]}]},{"level":2,"title":"📬 推送服务","slug":"📬-推送服务","link":"#📬-推送服务","children":[{"level":3,"title":"Push Kit集成","slug":"push-kit集成","link":"#push-kit集成","children":[]}]},{"level":2,"title":"📊 分析服务","slug":"📊-分析服务","link":"#📊-分析服务","children":[{"level":3,"title":"Analytics Kit","slug":"analytics-kit","link":"#analytics-kit","children":[]}]},{"level":2,"title":"📚 参考资源","slug":"📚-参考资源","link":"#📚-参考资源","children":[]}],"git":{"createdTime":1761123387000,"updatedTime":1761123387000,"contributors":[{"name":"YIXUAN","email":"byyi.xuan@outlook.com","commits":1}]},"filePathRelative":"tutorials/harmonyos-dev/17-harmony-ecology/02-HMS服务集成.md"}');export{g as comp,y as data};
